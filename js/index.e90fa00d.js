(function(e){function t(t){for(var i,o,r=t[0],l=t[1],c=t[2],u=0,p=[];u<r.length;u++)o=r[u],Object.prototype.hasOwnProperty.call(a,o)&&a[o]&&p.push(a[o][0]),a[o]=0;for(i in l)Object.prototype.hasOwnProperty.call(l,i)&&(e[i]=l[i]);d&&d(t);while(p.length)p.shift()();return n.push.apply(n,c||[]),s()}function s(){for(var e,t=0;t<n.length;t++){for(var s=n[t],i=!0,r=1;r<s.length;r++){var l=s[r];0!==a[l]&&(i=!1)}i&&(n.splice(t--,1),e=o(o.s=s[0]))}return e}var i={},a={index:0},n=[];function o(t){if(i[t])return i[t].exports;var s=i[t]={i:t,l:!1,exports:{}};return e[t].call(s.exports,s,s.exports,o),s.l=!0,s.exports}o.m=e,o.c=i,o.d=function(e,t,s){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(o.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(s,i,function(t){return e[t]}.bind(null,i));return s},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var d=l;n.push([0,"chunk-vendors"]),s()})({0:function(e,t,s){e.exports=s("7ba5")},"0045":function(e,t,s){"use strict";var i=s("7028"),a=s.n(i);a.a},"01b4":function(e,t,s){},"0514":function(e,t,s){},"08c7":function(e,t,s){e.exports=s.p+"img/extra-communautaires.8492302e.png"},"0a67":function(e,t,s){"use strict";var i=s("410f"),a=s.n(i);a.a},"0a93":function(e,t,s){},"0c81":function(e,t,s){},"0c87":function(e,t,s){},"0eac":function(e,t,s){e.exports=s.p+"img/water-null.48ff87a6.png"},"0f88":function(e,t,s){e.exports=s.p+"img/logo-fabrique-numerique.ad82b7e5.png"},"0fea":function(e,t,s){},"0ff0":function(e,t,s){"use strict";var i=s("0a93"),a=s.n(i);a.a},1118:function(e,t,s){"use strict";var i=s("0c87"),a=s.n(i);a.a},1210:function(e,t,s){"use strict";var i=s("7fa8"),a=s.n(i);a.a},1239:function(e,t,s){e.exports=s.p+"img/map-en.454a1e25.jpg"},"12a5":function(e,t,s){"use strict";var i=s("7c9e"),a=s.n(i);a.a},1469:function(e,t,s){"use strict";var i=s("bd68"),a=s.n(i);a.a},1676:function(e,t,s){e.exports=s.p+"img/resorption-bidonvilles-4.0d429297.jpg"},"17d9":function(e,t,s){"use strict";var i=s("9cfe"),a=s.n(i);a.a},"18f7":function(e,t,s){"use strict";var i=s("e17b"),a=s.n(i);a.a},"1a28":function(e,t,s){},"1a64":function(e,t,s){"use strict";var i=s("bafd"),a=s.n(i);a.a},2207:function(e,t,s){"use strict";var i=s("85f4"),a=s.n(i);a.a},"227c":function(e){e.exports=JSON.parse('"0.7.1"')},2283:function(e,t,s){"use strict";var i=s("9f1c"),a=s.n(i);a.a},2361:function(e,t,s){e.exports=s.p+"img/UK.951da937.svg"},2416:function(e,t,s){e.exports=s.p+"img/eu.9857ed8a.png"},2504:function(e){e.exports=JSON.parse('{"contact":"Contactați echipa de proiect","statistics":"Statistici","legal":"Informații legale","userAccessGuide":"Ghid de acces utilizator","userAgreement":"Acordul Utilizatorului"}')},"273c":function(e,t,s){},"27a3":function(e,t,s){},"2a38":function(e,t,s){"use strict";var i=s("8922"),a=s.n(i);a.a},"2b2e":function(e,t,s){},"2b50":function(e,t,s){e.exports=s.p+"img/fr.a7b266bf.png"},"2cb4":function(e,t,s){},"2d21":function(e,t,s){"use strict";var i=s("2cb4"),a=s.n(i);a.a},"2eea":function(e,t,s){e.exports=s.p+"img/after.21f24db8.jpg"},"30a5":function(e,t,s){"use strict";var i=s("9355"),a=s.n(i);a.a},"30c2":function(e,t,s){"use strict";var i=s("3ffc"),a=s.n(i);a.a},"30ce":function(e,t,s){"use strict";var i=s("75df"),a=s.n(i);a.a},3229:function(e,t,s){e.exports=s.p+"img/FR.3c609eda.svg"},"33a8":function(e,t,s){},3415:function(e,t,s){"use strict";var i=s("9cc2"),a=s.n(i);a.a},"373f":function(e,t,s){"use strict";var i=s("33a8"),a=s.n(i);a.a},"379b":function(e,t,s){"use strict";var i=s("aac4"),a=s.n(i);a.a},"37bc":function(e,t,s){e.exports=s.p+"img/Marianne.d37c6b1e.svg"},"3a02":function(e,t,s){"use strict";var i=s("8072"),a=s.n(i);a.a},"3b19":function(e){e.exports=JSON.parse('{"header":{"connect":"Se connecter","contact":"Nous contacter"},"hero":{"title":"Agir pour résorber les bidonvilles","subtitle":"Posez-nous une question ou demandez un accès"},"firstSection":{"features":{"position":"L\'information utile sur les sites en un clin d\'oeil","actions":"L’essentiel des actions accessible à tout moment","exchange":"Des échanges facilités entre les acteurs"},"before":"Avant","after":"Après","context":{"title":"Résorption-bidonvilles,","subtitle":"Une plateforme pour accélérer la résorption des bidonvilles","text":"Outil d’information, de partage et de pilotage, la plateforme offre une solution performante et efficace pour la résorption des bidonvilles. Elle permet de créer une véritable dynamique collaborative, au sein d’un territoire, entre les acteurs engagés vers l’objectif de résorption."},"feedback":{"1":{"text":"C’est super parce que vous avez l’info en ligne, vous n’êtes pas face à un tableau excel avec des codes que vous ne comprenez pas.","author":"Chargée de mission en Préfecture de Seine-Saint-Denis"},"2":{"text":"La plateforme a fiabilisé l’information, parce que le tableau Excel n’était pas partagé. Plus on aura des outils collaboratifs, mieux ça sera.","author":"Responsable hygiène publique à la ville de Poitiers"},"3":{"text":"J’ai pu orienter la famille d’une personne que j’accompagne vers une maison des solidarités à partir de la localisation de leur bidonville.","author":"Travailleur social au sein d\'une association à Toulouse"}}},"firstBanner":{"text":"Acteurs de la résorption des bidonvilles, partagez et faites connaître vos actions","cta":"Demander un accès"},"secondSection":{"title":"La résorption complète des bidonvilles,","subtitle":"un objectif national","data":{"1":{"line1":"Plus de","line2":"300 bidonvilles","line3":"en France métropolitaine"},"2":{"line1":"Plus de","line2":"16 000 personnes","line3":"dont 5 000 mineurs"},"3":{"line1":"Majoritairement","line2":"européens","line3":"Roumains et Bulgares"}},"firstParagraph":"Un bidonville est un terrain, une friche ou un immeuble bâti généralement dépourvu des services de base (eau, électricité, gestion des déchets) et occupé illégalement par plusieurs familles.","secondParagraph":{"bold":"Le gouvernement fixe un objectif clair de résorption des bidonvilles en dépassant l’approche centrée sur les évacuations au profit d’une approche globale","normal":"alliant insertion sociale, respect de l’ordre public et prévention des réinstallations. Dans tous les territoires concernés, des actions multi-partenariales efficaces, humaines et pragmatiques doivent être mises en place.","link":"En savoir plus sur la politique de résorption des bidonvilles"},"video":{"text":"Comprendre la résorption des bidonvilles en 2 minutes"}},"secondBanner":{"text":"Voisin, citoyen, habitant d’un bidonville… Une info ? Une question ? Une alerte ?","cta":"Nous contacter"},"thirdSection":{"title":"Les actions en chiffres","firstParagraph":{"bold":"Plus de 30 actions de résorption des bidonvilles menées en 2019 par 35 opérateurs.","normal":"Ces actions sont financées à 75 % par l’État, à 15 % par les collectivités territoriales et à 10 % par des fonds privés ou européens. \\nLes équipes de professionnels accompagnent les familles sur bidonville, en squat ou dans le logement sur tous les aspects : santé, logement, emploi, éducation, stabilisation et sécurisation du site."},"bilan":{"1":{"text":"8600 bénéficiaires"},"2":{"text":"17 sites résorbés","info":"+10 en 1 an"},"3":{"text":"1 000 personnes relogées"},"4":{"text":"1 350 enfants scolarisés"},"5":{"text":"2 040 bénéficiaires","info":"d\'un accompagnement santé"},"6":{"text":"615 contrats de travail signés"}},"cta":"Télécharger le dernier bilan","secondParagraph":{"title":"Un projet porté par la Délégation interministérielle à l’hébergement et l’accès au logement","body":{"text1":"La plateforme numérique Résorption-bidonvilles, portée et lancée en 2018 par la","link1":"Dihal","text2":"s’inscrit dans un objectif de transformation de l’action publique","text3":"Les développements de la plateforme se poursuivent en lien étroit avec ses usagers.","text4":"Vous souhaitez en savoir plus sur la génèse du projet ? Accédez à sa fiche sur","link2":"le site officiel des start-ups d’Etat"},"items":{"1":{"link":"Entrepreneur d’intérêt général","text":"du Programme d’investissement d’avenir en 2019"},"2":{"link":"Programme “rights, citizenship and equality”","text":"de la commission européenne au premier trimestre 2020"},"3":{"link":"Fonds d’accélération des Start-up d’État 3","text":"de la DINUM en avril 2020"},"4":{"link":"Fonds de transformation de l\'action publique","text":"de la DITP en octobre 2020"},"title":"Le projet a été lauréat de plusieurs appels à projet :"}}},"contactForm":{"email":"Votre email","cta":"Nous contacter"}}')},"3b5a":function(e,t,s){"use strict";var i=s("51a8"),a=s.n(i);a.a},"3b8a":function(e,t,s){e.exports=s.p+"img/logo_beta-gouv-fr.ced9be94.jpg"},"3cf0":function(e,t,s){},"3e3e":function(e){e.exports=JSON.parse('{"contact":"Свържете се с екипа на проекта","statistics":"Статистика","legal":"Правна информация","userAccessGuide":"Ръководство за достъп на потребителя","userAgreement":"Споразумение с потребителя"}')},"3ffc":function(e,t,s){},"410f":function(e,t,s){},4115:function(e,t,s){},"42da":function(e,t,s){},4316:function(e,t,s){"use strict";var i=s("3cf0"),a=s.n(i);a.a},"47b0":function(e,t,s){},"49bc":function(e,t,s){},"4f16":function(e,t,s){"use strict";var i=s("be9a"),a=s.n(i);a.a},"4f37":function(e,t,s){"use strict";var i=s("b64b"),a=s.n(i);a.a},"51a8":function(e,t,s){},5362:function(e){e.exports=JSON.parse('{"title":"Дейци в политиката за закриването на бидонвилите,споделете и разпространете информация за вашата дейност","contactUs":"Свържете се с нас","email":"Вашият имейл","firstname":"Име","lastname":"Фамилия","requestType":"Желаете да...","help":"Помогнете","report":"Подадете сигнал","requestHelp":"Поискате помощ","requestInfo":"Поискате информация","requestAccess":"Поискате достъп до платформата","isActor":"Активен участник ли сте в закриването на бидонвили?","actorExample":"Например: държавна служба, неправителствен оператор, местна власт...","yes":"Да","no":"Не","whichEstablishment":"Коя е вашата организация?","public":"Държавна служба, публична институция или орган","territorialCollectivity":"Местна власт","association":"Сдружение","administration":"Централна администрация","message":"Вашето съобщение","legal":"Декларирам, че личните ми данни са въведени с мое съгласие.","send":"Изпрати","cancel":"Отмени","error":"Вашата заявка съдържа грешки","share":"Споделете тази страница"}')},5449:function(e,t,s){"use strict";var i=s("ff59"),a=s.n(i);a.a},"54a1":function(e,t,s){},5549:function(e,t,s){e.exports=s.p+"img/map-bg.d95207bf.png"},"597c":function(e,t,s){e.exports=s.p+"img/status.d076deee.svg"},"5a39":function(e,t,s){"use strict";var i=s("912c"),a=s.n(i);a.a},"5e31":function(e,t,s){"use strict";var i=s("c368"),a=s.n(i);a.a},"5ff8":function(e){e.exports=JSON.parse('{"contact":"Contact the team","statistics":"Statistics","legal":"Legal information","userAccessGuide":"User access guide","userAgreement":"User agreement"}')},"602b":function(e,t,s){},"60ec":function(e,t,s){},6382:function(e,t,s){},"63fe":function(e,t,s){},"64e1":function(e,t,s){e.exports=s.p+"img/water-no.1646343a.png"},6501:function(e,t,s){"use strict";var i=s("273c"),a=s.n(i);a.a},"65a2":function(e,t,s){"use strict";var i=s("0c81"),a=s.n(i);a.a},6613:function(e,t,s){"use strict";var i=s("a605"),a=s.n(i);a.a},"669e":function(e,t,s){"use strict";var i=s("54a1"),a=s.n(i);a.a},"67e3":function(e,t,s){e.exports=s.p+"img/water-yes.87235d21.png"},"687a":function(e){e.exports=JSON.parse('{"title":"Voisin, citoyen, habitant d’un bidonville… Une info ? Une question ? Une alerte ?","contactUs":"Contactez-nous","email":"Votre email","firstname":"Prénom","lastname":"Nom de famille","requestType":"Vous souhaitez...","help":"Aider","report":"Signaler","requestHelp":"Demander de l\'aide","requestInfo":"Demander des infos","requestAccess":"Demander un accès à la plateforme","isActor":"Êtes-vous acteur de la résorption des bidonvilles?","actorExample":"Par exemple : un service de l’État, un opérateur associatif, une collectivité locale","yes":"Oui","no":"Non","whichEstablishment":"Quelle structure?","public":"Service de l’Etat, établissement ou organisme public","territorialCollectivity":"Collectivité territoriale","association":"Association","administration":"Administration centrale","message":"Votre message","legal":"Je certifie que ces données personnelles ont été saisies avec mon accord","send":"Envoyer","cancel":"Annuler","error":"Votre demande comprend des erreurs:","share":"Partager cette page"}')},"6d7c":function(e,t,s){},"6ead":function(e,t,s){e.exports=s.p+"img/logo-gouvernement.c2eee174.jpg"},"6ecd":function(e,t,s){e.exports=s.p+"img/type.049e9884.svg"},7028:function(e,t,s){},"71ee":function(e,t,s){e.exports=s.p+"img/utensils.fe20af2e.png"},"74c2":function(e,t,s){},"75df":function(e,t,s){},"771a":function(e,t,s){"use strict";var i=s("4115"),a=s.n(i);a.a},"77c2":function(e,t,s){"use strict";var i=s("602b"),a=s.n(i);a.a},"77c5":function(e,t,s){e.exports=s.p+"img/logo-entrepreneur-interet-general.559c3e82.png"},"7b35":function(e,t,s){},"7ba5":function(e,t,s){"use strict";s.r(t);s("ea19"),s("f138"),s("e9cc"),s("2d26"),s("96cf");var i=s("2b0e"),a=s("a925"),n=s("8c4f"),o=s("4ddc"),r=s("ad3d"),l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[s("router-view"),s("NotificationsGroup")],1)},c=[],d=s("2877"),u={},p=Object(d["a"])(u,l,c,!1,null,null,null),m=p.exports,h=s("ecee"),v=s("f2d1"),f=s("c074");h["c"].add(f["E"]),h["c"].add(f["e"]),h["c"].add(f["p"]),h["c"].add(f["P"]),h["c"].add(f["hb"]),h["c"].add(f["ib"]),h["c"].add(f["jb"]),h["c"].add(f["mb"]),h["c"].add(f["c"]),h["c"].add(f["y"]),h["c"].add(f["z"]),h["c"].add(f["R"]),h["c"].add(f["db"]),h["c"].add(f["M"]),h["c"].add(f["n"]),h["c"].add(f["u"]),h["c"].add(f["v"]),h["c"].add(f["S"]),h["c"].add(f["B"]),h["c"].add(f["Z"]),h["c"].add(f["k"]),h["c"].add(f["l"]),h["c"].add(f["m"]),h["c"].add(f["j"]),h["c"].add(f["t"]),h["c"].add(f["gb"]),h["c"].add(f["G"]),h["c"].add(f["O"]),h["c"].add(f["C"]),h["c"].add(f["nb"]),h["c"].add(f["lb"]),h["c"].add(f["A"]),h["c"].add(f["a"]),h["c"].add(f["bb"]),h["c"].add(f["J"]),h["c"].add(f["K"]),h["c"].add(f["cb"]),h["c"].add(f["g"]),h["c"].add(f["w"]),h["c"].add(f["U"]),h["c"].add(f["I"]),h["c"].add(f["kb"]),h["c"].add(f["h"]),h["c"].add(f["H"]),h["c"].add(f["Y"]),h["c"].add(f["V"]),h["c"].add(f["eb"]),h["c"].add(f["fb"]),h["c"].add(f["F"]),h["c"].add(f["N"]),h["c"].add(f["f"]),h["c"].add(f["D"]),h["c"].add(f["s"]),h["c"].add(f["q"]),h["c"].add(f["r"]),h["c"].add(f["b"]),h["c"].add(f["c"]),h["c"].add(f["ab"]),h["c"].add(v["b"]),h["c"].add(v["a"]),h["c"].add(f["X"]),h["c"].add(f["T"]),h["c"].add(f["o"]),h["c"].add(f["Q"]),h["c"].add(f["x"]),h["c"].add(f["L"]),h["c"].add(f["d"]),h["c"].add(f["W"]),h["c"].add(f["i"]);var _=s("3b19"),g=s("687a"),b=s("af21"),y={landingPage:_,contactPage:g,footer:b},C=s("af3d"),w=s("983b"),x=s("5ff8"),k={landingPage:C,contactPage:w,footer:x},P=s("fd3d"),S=s("9ddb"),$=s("2504"),T={landingPage:P,contactPage:S,footer:$},A=s("cda2"),E=s("5362"),O=s("3e3e"),I={landingPage:A,contactPage:E,footer:O},D={fr:y,en:k,ro:T,bg:I},j=s("95bf"),q=s("7bb1"),L=s("4c93"),F=s("6fde"),M=s("2593"),N=s("eaf5"),z=s("3108"),B=s("0158"),R=s.n(B),V=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s(e.isLink?"a":"button",{tag:"component",class:["btn inline-block relative",e.sizeClasses,e.variantClasses,this.disabled&&"opacity-50 cursor-not-allowed"],attrs:{disabled:e.disabled||e.loading,href:e.isLink?e.disabled?null:e.href:null,type:e.isLink?null:e.type},on:{click:e.onClick}},[s("div",{class:["flex","items-center","right"===e.iconPosition?"flex-row-reverse":"flex-row",e.loading&&"invisible"]},[e.icon||e.$slots.icon?s("div",[e._t("icon",[s("Icon",{attrs:{icon:e.icon}})])],2):e._e(),e.$slots.default?s("div",{class:e.iconPositionClasses},[e._t("default")],2):e._e()]),e.loading?s("div",{staticClass:"absolute inset-0 flex justify-center items-center"},[s("Icon",{attrs:{icon:"spinner",spin:""}})],1):e._e()])},U=[],H=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("font-awesome-icon",{attrs:{icon:e.icon,spin:e.spin}})},G=[],W={name:"Icon",props:{icon:{type:String,required:!0},spin:{type:Boolean}}},Y=W,J=Object(d["a"])(Y,H,G,!1,null,null,null),Q=J.exports,Z={name:"Button",props:{variant:{type:String,default:"primary"},type:String,href:String,size:{type:String,default:"md"},icon:String,iconPosition:{type:String,default:"right"},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},computed:{iconPositionClasses(){return this.icon?{left:"ml-2",right:"mr-2"}[this.iconPosition]:""},sizeClasses(){return{sm:"text-sm "+(this.isLink?"":"py-1 px-2"),md:"text-md "+(this.isLink?"":"py-2 px-4"),lg:"text-lg "+(this.isLink?"":"py-2 px-4")}[this.size]},variantClasses(){return{primary:"rounded-sm border-2 border-primary bg-primary text-white hover:bg-primaryDark focus:outline-none",secondary:"rounded-sm border-2 border-secondary bg-secondary text-white hover:bg-secondaryDark focus:outline-none",primaryOutline:"rounded-sm border-2 border-primary text-primary hover:bg-primary hover:text-white focus:outline-none",secondaryOutline:"rounded-sm border-2  border-secondary text-secondary hover:bg-secondary hover:text-white focus:outline-none",primaryText:"text-primary hover:text-primaryDark focus:outline-none",secondaryText:"text-secondary hover:text-secondaryDark focus:outline-none",text:"focus:outline-none",filter:"rounded border border-primary text-primary hover:bg-primary hover:text-white focus:outline-none"}[this.variant]},isLink(){return void 0!==this.href}},methods:{onClick(e){this.$emit("click",e)}},components:{Icon:Q}},K=Z,X=Object(d["a"])(K,V,U,!1,null,null,null),ee=X.exports,te=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("InputWrapper",[s("InputLabel",{attrs:{label:e.label,info:e.info}}),s("ValidationProvider",{attrs:{rules:e.rules,name:e.validationName||e.label,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("div",{staticClass:"relative"},[e.prefixIcon?s("InputIcon",{attrs:{position:"before",icon:e.prefixIcon}}):e._e(),s("input",e._b({class:e.classes,attrs:{id:e.id},on:{input:function(t){return e.$emit("input",t.target.value)}}},"input",e.filteredProps,!1)),e.suffixIcon?s("InputIcon",{attrs:{position:"after",icon:e.suffixIcon}}):e._e()],1),s("InputError",[e._v(e._s(i[0]))])]}}])})],1)},se=[],ie={computed:{filteredProps(){const e={...this.$props};return Object.keys(e).forEach(t=>{void 0===e[t]&&delete e[t]}),e}}},ae=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.label?s("div",{staticClass:"mb-2 text-sm"},[e._v(e._s(e.label))]):e._e(),e.info?s("div",{staticClass:"mb-3 text-xs"},[e._v(e._s(e.info))]):e._e()])},ne=[],oe={props:{label:{type:String},info:{type:String}}},re=oe,le=Object(d["a"])(re,ae,ne,!1,null,null,null),ce=le.exports,de=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mb-6"},[e._t("default")],2)},ue=[],pe={},me=Object(d["a"])(pe,de,ue,!1,null,null,null),he=me.exports,ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"text-error mt-2"},[e._t("default")],2)},fe=[],_e={},ge=Object(d["a"])(_e,ve,fe,!1,null,null,null),be=ge.exports,ye=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["absolute inset-y-0 flex items-center",e.positionClasses]},[e._t("default",[e.icon?s("Icon",{attrs:{icon:e.icon}}):e._e()])],2)},Ce=[],we={props:{icon:{type:String},position:{type:String}},computed:{positionClasses(){return"after"===this.position?"right-0 pr-3 ":"left-0 pl-3 "}}},xe=we,ke=Object(d["a"])(xe,ye,Ce,!1,null,null,null),Pe=ke.exports;function Se(e,t){const{error:s,prefixIcon:i,suffixIcon:a}=t;return{state:["bg-G200 border-b-2 border-black rounded rounded-b-none w-full py-2 ",s&&"border-error",i&&"pl-10",a&&"pr-10"],default:["border border-G200 rounded-md w-full py-2 px-4 outline-none focus:border-primary",s&&"border-error",i&&"pl-10",a&&"pr-10"],town:["border-2 border-G200 py-1 px-4 w-full outline-none focus:border-primary",i&&"pl-8"]}[e]}var $e={name:"TextInput",mixins:[ie],props:{label:{type:String},info:{type:String},placeholder:{type:String},type:{type:String,default:"text"},validationName:{type:String},rules:{type:String},value:{type:String},id:{type:String},variant:{type:String,default:"default"},prefixIcon:{type:String},suffixIcon:{type:String}},computed:{classes(){const e={error:this.error,prefixIcon:this.prefixIcon,suffixIcon:this.suffixIcon};return{state:[...Se("state",e)],default:Se("default",e)}[this.variant]}},components:{InputLabel:ce,InputWrapper:he,InputError:be,InputIcon:Pe}},Te=$e,Ae=Object(d["a"])(Te,te,se,!1,null,null,null),Ee=Ae.exports,Oe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex items-center"},[s("InputLabel",{staticClass:"mr-2",attrs:{label:e.label,info:e.info}}),s("ValidationProvider",{attrs:{rules:e.rules,name:e.validationName||e.label,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("div",{staticClass:"relative"},[e.prefixIcon?s("InputIcon",{attrs:{position:"before",icon:e.prefixIcon}}):e._e(),s("input",e._b({class:e.classes,attrs:{id:e.id},on:{input:function(t){return e.$emit("input",t.target.value)}}},"input",e.filteredProps,!1)),e.suffixIcon?s("InputIcon",{attrs:{position:"after",icon:e.suffixIcon}}):e._e()],1),s("InputError",[e._v(e._s(i[0]))])]}}])})],1)},Ie=[],De={name:"InlineTextInput",mixins:[ie],props:{label:{type:String},info:{type:String},placeholder:{type:String},type:{type:String,default:"text"},validationName:{type:String},rules:{type:String},value:{type:String},id:{type:String},variant:{type:String,default:"default"},prefixIcon:{type:String},suffixIcon:{type:String}},computed:{classes(){const e={error:this.error,prefixIcon:this.prefixIcon,suffixIcon:this.suffixIcon};return{state:[...Se("state",e)],default:Se("default",e),town:Se("town",e)}[this.variant]}},components:{InputLabel:ce,InputError:be,InputIcon:Pe}},je=De,qe=Object(d["a"])(je,Oe,Ie,!1,null,null,null),Le=qe.exports,Fe=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("InputWrapper",[s("InputLabel",{attrs:{label:e.label,info:e.info}}),s("ValidationProvider",{attrs:{rules:e.rules,name:e.validationName||e.label,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("div",{staticClass:"relative"},[e.prefixIcon?s("InputIcon",{attrs:{position:"before",icon:e.prefixIcon}}):e._e(),s("textarea",e._b({class:e.classes,attrs:{id:e.id},on:{input:function(t){return e.$emit("input",t.target.value)}}},"textarea",e.filteredProps,!1)),e._v(" "),e.suffixIcon?s("InputIcon",{attrs:{position:"after",icon:e.suffixIcon}}):e._e()],1),s("InputError",[e._v(e._s(i[0]))])]}}])})],1)},Me=[],Ne={name:"TextArea",mixins:[ie],props:{label:{type:String},info:{type:String},placeholder:{type:String},type:{type:String,default:"text"},value:{type:String},rules:{type:String},validationName:{type:String},id:{type:String},variant:{type:String,default:"default"},prefixIcon:{type:String},suffixIcon:{type:String},rows:{type:String},cols:{type:String}},computed:{classes(){const e={error:this.error,prefixIcon:this.prefixIcon,suffixIcon:this.suffixIcon};return{state:[...Se("state",e)],default:Se("default",e)}[this.variant]}},components:{InputLabel:ce,InputWrapper:he,InputError:be,InputIcon:Pe}},ze=Ne,Be=Object(d["a"])(ze,Fe,Me,!1,null,null,null),Re=Be.exports,Ve=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["checkbox-"+e.variant].concat(e.containerClasses)},["card"===e.variant||"townCard"===e.variant?s("CheckableCard",{attrs:{variant:e.variant,isChecked:e.isChecked}},[s("input",e._b({staticClass:"appearance-none absolute invisible",attrs:{type:"checkbox"},domProps:{checked:e.isChecked},on:{change:e.onChange}},"input",e.filteredProps,!1)),s("div",[e._v(e._s(e.label))])]):s("label",{class:["inline-flex cursor-pointer",e.info?"items-start":"items-center"].concat(e.labelClasses)},[s("input",e._b({class:e.checkboxClasses,attrs:{type:"checkbox"},domProps:{checked:e.isChecked},on:{change:e.onChange}},"input",e.filteredProps,!1)),e._t("default",[s("div",{staticClass:"ml-2"},[s("div",[e._v(e._s(e.label))]),e.info?s("div",{staticClass:"text-xs"},[e._v(e._s(e.info))]):e._e()])],{isChecked:e.isChecked})],2)],1)},Ue=[],He=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",{class:e.checkboxClasses},[e._t("default")],2)},Ge=[],We={props:{isChecked:{type:Boolean},variant:{type:String}},computed:{checkboxClasses(){return{card:["inline-flex cursor-pointer border-2 rounded-md border-primary px-4 py-3 hover:bg-primary hover:text-white",this.isChecked?"bg-primary text-white":"text-primary"],townCard:["inline-flex cursor-pointer px-8 py-1 border border-transparent hover:border-blue600",this.isChecked?"bg-primary text-white":" bg-blue200 text-primary"]}[this.variant]}}},Ye=We,Je=Object(d["a"])(Ye,He,Ge,!1,null,null,null),Qe=Je.exports,Ze={name:"Checkbox",mixins:[ie],components:{CheckableCard:Qe},props:{checkValue:{type:[String,Boolean,Number]},label:{type:String},containerClasses:{type:[Array,String]},labelClasses:{type:[Array,String]},value:{type:Array},info:{type:String},variant:{type:String,default:"default"}},methods:{onChange(e){let t=[...this.value];e.target.checked?t.push(this.checkValue):t=t.filter(e=>e!==this.checkValue),this.$emit("input",t)}},computed:{isChecked(){return this.value&&this.value.includes(this.checkValue)},checkboxClasses(){return{default:"form-checkbox h-5 w-5",invisible:"appearance-none absolute invisible",town:"checkbox-town-input"}[this.variant]}}},Ke=Ze,Xe=(s("edfe"),Object(d["a"])(Ke,Ve,Ue,!1,null,null,null)),et=Xe.exports,tt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["radio-"+e.variant].concat(e.containerClasses)},["card"===e.variant||"townCard"===e.variant?s("CheckableCard",{attrs:{variant:e.variant,isChecked:e.isChecked}},[s("input",e._b({staticClass:"appearance-none absolute invisible",attrs:{type:"radio"},domProps:{checked:e.isChecked},on:{change:e.onChange}},"input",e.filteredProps,!1)),s("div",[e._v(e._s(e.label))])]):s("label",{class:["inline-flex cursor-pointer",e.info?"items-start":"items-center"].concat(e.labelClasses)},[s("input",e._b({class:e.radioClasses,attrs:{type:"radio"},domProps:{checked:e.isChecked},on:{change:e.onChange}},"input",e.filteredProps,!1)),e._t("default",[s("div",{staticClass:"ml-2"},[s("div",[e._v(e._s(e.label))]),e.info?s("div",{staticClass:"text-xs"},[e._v(e._s(e.info))]):e._e()])],{isChecked:e.isChecked})],2)],1)},st=[],it={name:"Radio",mixins:[ie],components:{CheckableCard:Qe},props:{checkValue:{type:[String,Boolean,Number]},label:{type:String},containerClasses:{type:[Array,String]},labelClasses:{type:[Array,String]},value:{type:[String,Boolean,Number]},info:{type:String},variant:{type:String,default:"default"}},methods:{onChange(){this.$emit("input",this.checkValue)}},computed:{isChecked(){return this.value===this.checkValue},radioClasses(){return{default:"form-checkbox h-5 w-5",invisible:"appearance-none absolute invisible",town:"radio-town-input"}[this.variant]}}},at=it,nt=(s("93aa"),Object(d["a"])(at,tt,st,!1,null,null,null)),ot=nt.exports,rt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("InputWrapper",[s("InputLabel",{attrs:{label:e.label,info:e.info}}),s("ValidationProvider",{attrs:{rules:e.rules,name:e.validationName||e.label,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("div",{staticClass:"relative"},[s("InputIcon",{attrs:{position:"before",icon:e.icon}}),s("select",e._b({class:e.classes,attrs:{id:e.id},on:{change:function(t){return e.$emit("input",t.target.value)}}},"select",e.filteredProps,!1),[e._t("default")],2),s("InputIcon",{attrs:{position:"after",icon:"chevron-down"}})],1),s("InputError",[e._v(e._s(i[0]))])]}}],null,!0)})],1)},lt=[],ct={name:"Select",mixins:[ie],props:{label:{type:String},info:{type:String},error:{type:String},value:{type:String},validationName:{type:String},rules:{type:String},id:{type:String},variant:{type:String,default:"default"},icon:{type:String}},computed:{classes(){const e={error:this.error,prefixIcon:this.icon,suffixIcon:!0};return{state:["appearance-none",...Se("state",e)],default:["appearance-none",...Se("default",e)]}[this.variant]}},components:{InputWrapper:he,InputLabel:ce,InputError:be,InputIcon:Pe}},dt=ct,ut=Object(d["a"])(dt,rt,lt,!1,null,null,null),pt=ut.exports,mt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("option",e._b({},"option",e.$props,!1),[e._t("default")],2)},ht=[],vt={name:"SelectOption",props:{}},ft=vt,_t=Object(d["a"])(ft,mt,ht,!1,null,null,null),gt=_t.exports,bt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"text-display-lg mb-8"},[e._v(e._s(e.title))]),e._t("default")],2)},yt=[],Ct={props:{title:{type:String}}},wt=Ct,xt=Object(d["a"])(wt,bt,yt,!1,null,null,null),kt=xt.exports,Pt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mb-12"},[s("div",{staticClass:"font-bold mb-4"},[e._v(e._s(e.title))]),s("div",{staticClass:"text-sm mb-4"},[e._v(e._s(e.info))]),e._t("default")],2)},St=[],$t={props:{title:{type:String},info:{type:String}}},Tt=$t,At=Object(d["a"])(Tt,Pt,St,!1,null,null,null),Et=At.exports,Ot=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",{staticClass:"my-8"},[e._t("default")],2)},It=[],Dt={},jt=Object(d["a"])(Dt,Ot,It,!1,null,null,null),qt=jt.exports,Lt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g(e._b({class:["rounded-md bg-white shadow-xs min-w-48"].concat(e.classes),attrs:{role:"menu","aria-orientation":"vertical","aria-labelledby":"user-menu"}},"div",e.$attrs,!1),e.$listeners),[e._t("default")],2)},Ft=[],Mt={props:{variant:String,default:()=>"default"},computed:{classes(){return{withoutPadding:"py-0",default:"py-1"}[this.variant]}}},Nt=Mt,zt=Object(d["a"])(Nt,Lt,Ft,!1,null,null,null),Bt=zt.exports,Rt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g(e._b({staticClass:"block px-4 py-2 text-md hover:bg-gray-100 cursor-pointer",attrs:{role:"menuitem"}},"div",e.$attrs,!1),e.$listeners),[e._t("default")],2)},Vt=[],Ut={},Ht=Object(d["a"])(Ut,Rt,Vt,!1,null,null,null),Gt=Ht.exports,Wt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"relative"},[s("div",{on:{click:e.toggleMenu}},[e._t("button",null,{isOpen:e.isOpen})],2),s("div",{class:["origin-top-left-10 absolute z-10 left-0 mt-2 rounded-md shadow-lg transform transition ease-in-out duration-200",e.isOpen?"opacity-100":"opacity-0 hidden"]},[e._t("menu",null,{closeMenu:e.closeMenu})],2)])},Yt=[],Jt={data(){return{isOpen:!1}},methods:{checkOutsideClick(e){this.$el.contains(e.target)||this.closeMenu()},openMenu(){this.isOpen=!0},closeMenu(){this.isOpen=!1},toggleMenu(){this.isOpen=!this.isOpen}},mounted(){setTimeout(()=>{document.addEventListener("click",this.checkOutsideClick)},0)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)}},Qt=Jt,Zt=Object(d["a"])(Qt,Wt,Yt,!1,null,null,null),Kt=Zt.exports,Xt=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("notifications",{staticClass:"fixed top-0 z-20 w-64",staticStyle:{width:"410px"},attrs:{group:"notifications",position:"top center"},scopedSlots:e._u([{key:"body",fn:function(t){return[s("div",{class:["text-white p-2 m-2","vue-notification",t.item.type],on:{click:t.close}},[s("div",{staticClass:"notification-icon"}),s("div",{staticClass:"text-white"},[s("div",{staticClass:"text-lg"},[e._v(e._s(t.item.title))]),s("div",{staticClass:"text-sm",domProps:{innerHTML:e._s(t.item.text)}})])])]}}])})},es=[],ts=(s("efa2"),{}),ss=Object(d["a"])(ts,Xt,es,!1,null,"7743ec3e",null),is=ss.exports,as=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["fixed z-40 inset-0 transform transition ease-in-out duration-300",e.isOpen?"opacity-100":"opacity-0 pointer-events-none"]},[s("div",{staticClass:"absolute w-full h-full bg-gray-500 opacity-75"}),s("div",{class:["flex items-center justify-center min-h-screen ",e.containerClasses]},[s("div",{ref:"dialog",staticClass:"opacity-100 z-50 shadow-xl overflow-hidden ",attrs:{role:"dialog","aria-modal":"true","aria-labelledby":"modal-headline"}},[s("div",{staticClass:"bg-white"},[e._t("header",[s("div",{staticClass:"pt-10 px-10 pb-4 "},[s("div",{staticClass:"flex justify-between border-b border-G400"},[s("div",{staticClass:"text-display-md text-primary"},[e._t("title")],2),s("Button",{attrs:{variant:"primaryText",icon:"times",size:"lg"},on:{click:e.closeModal}})],1)])]),s("div",{staticClass:"px-10 pt-6 pb-10"},[e._t("body")],2),e.$slots.footer?s("div",{staticClass:"px-4 pb-8 sm:px-6 flex justify-end"},[e._t("footer")],2):e._e()],2)])])])},ns=[],os={props:{closeModal:{type:Function},isOpen:{type:Boolean},closeClickOutside:{type:Boolean,default:!1},containerClasses:{type:Array}},methods:{checkOutsideClick(e){this.isOpen&&this.closeModal&&!this.$refs.dialog.contains(e.target)&&this.closeModal()}},mounted(){this.closeClickOutside&&document.addEventListener("click",this.checkOutsideClick)},destroyed(){this.closeClickOutside&&document.removeEventListener("click",this.checkOutsideClick)}},rs=os,ls=Object(d["a"])(rs,as,ns,!1,null,null,null),cs=ls.exports,ds=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bg-G200 py-8 px-8 border-l-4 border-primary"},[s("div",{staticClass:"text-display-md mb-4"},[e._v(e._s(e.title))]),s("div",[e._t("default")],2)])},us=[],ps={props:{title:{type:String}}},ms=ps,hs=Object(d["a"])(ms,ds,us,!1,null,null,null),vs=hs.exports,fs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.isOpen?s("div",{ref:"backdrop",staticClass:"fixed inset-0 bg-gray-500 opacity-75 z-backdrop",on:{click:e.clickBackdrop}}):e._e(),s("div",{class:["fixed z-sidePanel top-0 bottom-0 right-0 overflow-y-auto full-height transform transition ease-in-out duration-500",e.isOpen?"translate-x-0":"translate-x-full"]},[s("div",{class:["min-h-screen w-128 bg-white"]},[e._t("default")],2)])])},_s=[],gs={props:{closePanel:{type:Function},isOpen:{type:Boolean},closeClickOutside:{type:Boolean,default:!1}},methods:{clickBackdrop(){this.isOpen&&this.closeClickOutside&&this.closePanel()}}},bs=gs,ys=(s("d694"),Object(d["a"])(bs,fs,_s,!1,null,null,null)),Cs=ys.exports,ws=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("InputWrapper",[s("InputLabel",{attrs:{label:e.label,info:e.info}}),s("ValidationProvider",{ref:"provider",attrs:{rules:e.rules,name:e.validationName||e.label,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("AutocompleteVue",{attrs:{search:e.search,"default-value":e.defaultValue,placeholder:e.placeholder,"aria-label":e.placeholder,getResultValue:e.getResultValue,debounceTime:e.debounceTime},on:{submit:e.onItemSelect},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.rootProps,a=t.inputProps,n=t.inputListeners,o=t.resultListProps,r=t.resultListListeners,l=t.results,c=t.resultProps;return[s("div",e._b({},"div",i,!1),[s("div",{staticClass:"relative"},[e.prefixIcon?s("InputIcon",{staticClass:"text-primary pl-6",attrs:{position:"before",icon:e.prefixIcon}}):e._e(),"checkbox"===a.type?s("input",e._g(e._b({directives:[{name:"model",rawName:"v-model",value:e.searchInput,expression:"searchInput"}],ref:"searchInput",staticClass:"pl-12",class:e.classes,attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.searchInput)?e._i(e.searchInput,null)>-1:e.searchInput},on:{focus:e.handleFocus,blur:e.handleBlur,change:function(t){var s=e.searchInput,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&(e.searchInput=s.concat([n])):o>-1&&(e.searchInput=s.slice(0,o).concat(s.slice(o+1)))}else e.searchInput=a}}},"input",a,!1),n)):"radio"===a.type?s("input",e._g(e._b({directives:[{name:"model",rawName:"v-model",value:e.searchInput,expression:"searchInput"}],ref:"searchInput",staticClass:"pl-12",class:e.classes,attrs:{type:"radio"},domProps:{checked:e._q(e.searchInput,null)},on:{focus:e.handleFocus,blur:e.handleBlur,change:function(t){e.searchInput=null}}},"input",a,!1),n)):s("input",e._g(e._b({directives:[{name:"model",rawName:"v-model",value:e.searchInput,expression:"searchInput"}],ref:"searchInput",staticClass:"pl-12",class:e.classes,attrs:{type:a.type},domProps:{value:e.searchInput},on:{focus:e.handleFocus,blur:e.handleBlur,input:function(t){t.target.composing||(e.searchInput=t.target.value)}}},"input",a,!1),n)),s("InputIcon",{staticClass:"pr-6",attrs:{position:"after"}},[e.loading?s("Spinner"):e._e(),s("div",{staticClass:"cursor-pointer ",on:{click:e.removeItem}},[!e.loading&&e.value&&e.getResultValue(e.value)===e.searchInput?s("Icon",{staticClass:"text-primary text-display-sm",attrs:{icon:"times"}}):e._e()],1)],1)],1),s("transition",{attrs:{name:"fade"}},[e.focused&&e.searchInput?s("div",{class:["origin-top-left-10 absolute z-10 left-0 mt-2 w-full rounded-md shadow-lg"]},[e._t("default",[l.length?s("Menu",e._g(e._b({},"Menu",o,!1),r),e._l(l,(function(t,i){return s("MenuItem",e._b({key:c[i].id,class:["cursor-pointer",c[i]["aria-selected"]&&"bg-gray-100"]},"MenuItem",c[i],!1),[s("div",[e._v(" "+e._s(e.getResultValue(t))+" ")])])})),1):s("Menu",[s("MenuItem",[e._v(" Aucun résultats ")])],1)],{results:l,resultListProps:o,resultListListeners:r,resultProps:c,getResultValue:e.getResultValue})],2):e._e()]),s("div",[e._t("extra",null,{removeItem:e.removeItem})],2)],1)]}}],null,!0)}),s("InputError",[e._v(e._s(i[0]))])]}}])})],1)},xs=[],ks={components:{InputLabel:ce,InputWrapper:he,InputError:be,InputIcon:Pe},props:{loading:{type:Boolean},label:{type:String},info:{type:String},validationName:{type:String},rules:{type:String},id:{type:String},inputClasses:{type:Array,default:()=>[]},search:{type:Function,required:!0},defaultValue:{type:String,required:!1,default:""},placeholder:{type:String},getResultValue:{type:Function,default:e=>e},debounceTime:{type:Number,default:0},variant:{type:String,default:"default"},prefixIcon:{type:String}},computed:{classes(){const e={error:this.error,prefixIcon:this.prefixIcon},t={state:[...Se("state",e)],default:Se("default",e)}[this.variant];return[...this.inputClasses,...t]}},data(){return{show:!0,focused:!1,value:"",searchInput:this.defaultValue||"",results:[]}},methods:{removeItem(){this.value="",this.searchInput="",this.$emit("submit",null),this.$refs.provider.syncValue(null),this.$refs.provider.validate()},onItemSelect(e){this.value=e,e&&(this.searchInput=this.getResultValue(e)),this.$emit("submit",e),this.$refs.provider.syncValue(e),this.$refs.provider.validate(),this.$refs.searchInput.blur()},handleFocus(){this.focused=!0},handleBlur(){this.value?this.searchInput=this.getResultValue(this.value):this.onItemSelect(null),this.focused=!1}}},Ps=ks,Ss=Object(d["a"])(Ps,ws,xs,!1,null,null,null),$s=Ss.exports,Ts=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Icon",e._g(e._b({attrs:{icon:"spinner",spin:""}},"Icon",e.$attrs,!1),e.$listeners))},As=[],Es={},Os=Object(d["a"])(Es,Ts,As,!1,null,null,null),Is=Os.exports,Ds=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ValidationProvider",{attrs:{rules:e.rules,name:e.validationName||e.title,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("CheckableGroupWrapper",{attrs:{title:e.title,info:e.info,id:e.id}},[s("div",{class:"flex flex-col relative"},[e.error?s("div",{staticClass:"absolute h-full bg-error leftBorder"}):e._e(),s("div",{class:["flex","vertical"===e.direction?"flex-col checkableGroup--verticalLayout":"flex-row flex-wrap checkableGroup--horizontalLayout"]},[e._t("default")],2)]),s("InputError",[e._v(e._s(i[0]))])],1)]}}],null,!0)})},js=[],qs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e.title?s("InputGroup",{attrs:{title:e.title,info:e.info,id:e.id}},[e._t("default")],2):s("InputWrapper",{attrs:{id:e.id}},[e._t("default")],2)],1)},Ls=[],Fs={components:{InputWrapper:he,InputGroup:Et},props:{title:{type:String},info:{type:String},id:{type:String}}},Ms=Fs,Ns=Object(d["a"])(Ms,qs,Ls,!1,null,null,null),zs=Ns.exports,Bs={props:{title:{type:String},info:{type:String},error:{type:String},direction:{type:String,default:"vertical"},validationName:{type:String},rules:{type:String},id:{type:String}},components:{CheckableGroupWrapper:zs,InputError:be}},Rs=Bs,Vs=(s("c1ab"),s("8324"),Object(d["a"])(Rs,Ds,js,!1,null,"55b46938",null)),Us=Vs.exports,Hs=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("InputWrapper",[s("InputLabel",{attrs:{label:e.label,info:e.info}}),s("ValidationProvider",{ref:"provider",attrs:{rules:e.rules,name:e.validationName||e.label,vid:e.id},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("div",{staticClass:"relative"},[s("InputIcon",{staticClass:"z-10 text-G400",attrs:{position:"before",icon:"calendar"}}),s(e.dynamicComponent,e._g(e._b({tag:"component",attrs:{"input-class":e.inputClasses,language:e.dateLanguage,"monday-first":!0}},"component",e.$attrs,!1),e.$listeners))],1),s("InputError",[e._v(e._s(i[0]))])]}}])})],1)},Gs=[],Ws=s("2430"),Ys=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mb-1 text-xs"},[e._t("default")],2)},Js=[],Qs={},Zs=Object(d["a"])(Qs,Ys,Js,!1,null,null,null),Ks=Zs.exports,Xs={props:{label:{type:String},info:{type:String},id:{type:String},validationName:{type:String},variant:{type:String,default:"default"},rules:{type:String}},components:{InputLabel:ce,InputWrapper:he,InputError:be,InputInfo:Ks,InputIcon:Pe},data(){return{dateLanguage:Ws["fr"],dynamicComponent:null}},mounted(){Promise.resolve().then(s.bind(null,"fa33")).then(e=>{this.dynamicComponent=e.default})},computed:{inputClasses(){const e={error:this.error,prefixIcon:"town"===this.variant};return{state:[...Se("state",e)],default:Se("default",e),town:Se("town",e)}[this.variant]}}},ei=Xs,ti=Object(d["a"])(ei,Hs,Gs,!1,null,null,null),si=ti.exports,ii=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:[e.color,"inline-flex text-sm px-4 py-1 flex-row items-center"]},[e._t("default"),e.onDelete?s("span",{staticClass:"ml-2 cursor-pointer",on:{click:e.onDelete}},[s("Icon",{attrs:{icon:"times"}})],1):e._e()],2)},ai=[],ni={props:{onDelete:{type:Function},color:{type:String,default:"bg-G200"}}},oi=ni,ri=Object(d["a"])(oi,ii,ai,!1,null,null,null),li=ri.exports,ci=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-row items-center"},[s("Button",{staticClass:"hover:bg-G200 rounded-full px-4 py-1 mx-2 focus:outline-none ",attrs:{icon:"chevron-left",iconPosition:"left",variant:"custom",size:"custom"},on:{click:e.onPrevious}},[e._v("Précédent")]),e.currentPage>1?s("div",{staticClass:"h-8 w-8 hover:bg-G200 flex justify-center items-center rounded-full cursor-pointer",on:{click:function(){return e.onChangePage(1)}}},[e._v(" 1 ")]):e._e(),s("div",{class:["h-8 w-8 bg-primary text-white flex justify-center items-center rounded-full",1===e.currentPage?"":"ml-4",e.currentPage===e.nbPages?"":"mr-4"]},[e._v(" "+e._s(e.currentPage)+" ")]),e.currentPage!==e.nbPages?s("div",{staticClass:"h-8 w-8 hover:bg-G200 flex justify-center items-center rounded-full cursor-pointer",on:{click:function(){return e.onChangePage(e.nbPages)}}},[e._v(" "+e._s(e.nbPages)+" ")]):e._e(),s("Button",{staticClass:"hover:bg-G200  rounded-full px-4 py-1 mx-2  focus:outline-none",attrs:{icon:"chevron-right",iconPosition:"right",variant:"custom",size:"custom"},on:{click:e.onNext}},[e._v("Suivant")])],1)},di=[],ui={props:{currentPage:{type:Number},nbPages:{type:Number},onChangePage:{type:Function}},methods:{onPrevious(){this.onChangePage(Math.max(1,this.currentPage-1))},onNext(){this.onChangePage(Math.min(this.currentPage+1,this.nbPages))}}},pi=ui,mi=Object(d["a"])(pi,ci,di,!1,null,null,null),hi=mi.exports,vi=function(e){e.component("Button",ee),e.component("TextInput",Ee),e.component("InlineTextInput",Le),e.component("TextArea",Re),e.component("Icon",Q),e.component("Menu",Bt),e.component("MenuItem",Gt),e.component("Checkbox",et),e.component("Radio",ot),e.component("Select",pt),e.component("SelectOption",gt),e.component("FormGroup",kt),e.component("Dropdown",Kt),e.component("Modal",cs),e.component("SidePanel",Cs),e.component("CheckableGroup",Us),e.component("InputGroup",Et),e.component("FormParagraph",qt),e.component("Callout",vs),e.component("Spinner",Is),e.component("AutocompleteV2",$s),e.component("DatepickerV2",si),e.component("Tag",li),e.component("Pagination",hi),e.use(R.a),e.component("NotificationsGroup",is),e.component("ValidationProvider",q["b"]),e.component("ValidationObserver",q["a"]),e.component("AutocompleteVue",j["a"]),Object(q["d"])({en:M,fr:F,bg:z,ro:N}),Object.keys(L).forEach(e=>{Object(q["c"])(e,{...L[e]})}),Object(q["d"])("fr")};const fi={debug:!1,enableLinkTracking:!0,requireConsent:!1,trackInitialView:!0,trackerFileName:"piwik"};function _i(e){const t=new Promise((t,s)=>{const i=document.createElement("script");i.async=!0,i.defer=!0,i.src=e;const a=document.head||document.getElementsByTagName("head")[0];a.appendChild(i),i.onload=t,i.onerror=s});return t.catch(e=>{const t=`[vue-matomo] An error occurred trying to load ${e.target.src}. `;console.error(t)}),t}function gi(e,t){const{host:s,siteId:i,trackerFileName:a,trackerUrl:n}=t,o=n||`${s}/${a}.php`,r=window.Piwik.getTracker(o,i);e.prototype.$piwik=r,e.prototype.$matomo=r,t.requireConsent&&r.requireConsent(),t.trackInitialView&&r.trackPageView(),t.enableLinkTracking&&r.enableLinkTracking(),t.router&&t.router.afterEach(e=>{const s=window.location;let{protocol:i}=s;":"!==i.slice(-1)&&(i+=":");const a="hash"===t.router.mode?"/#":"",n=`${i}//${s.host}${a}${e.fullPath}`;e.meta.analyticsIgnore||(t.debug&&console.debug("[vue-matomo] Tracking "+n),r.setCustomUrl(n),r.trackPageView())})}function bi(e,t={}){const s={...fi,...t},{host:i,trackerFileName:a}=s,n=`${i}/${a}.js`;_i(n).then(()=>gi(e,s))}var yi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("PublicLayout",{attrs:{displayLanguagePicker:!0}},[i("PublicContainer",[i("div",{staticClass:"pt-4"},[i("div",{staticClass:"max-w-screen-lg mx-auto pb-20"},[i("LandingPageHero",{staticClass:"mt-20"}),i("LandingPageFirstSection")],1)])]),i("LandingPageBanner",{attrs:{cta:e.$t("landingPage.firstBanner.cta")}},[e._v(" "+e._s(e.$t("landingPage.firstBanner.text"))+" ")]),i("CreditWrapper",{attrs:{credit:"© Diego Inglez de Souza"}},[i("img",{staticClass:"h-128 w-full object-cover object-center",attrs:{src:s("dce0")}})]),i("PublicContainer",[i("div",{staticClass:"max-w-screen-lg mx-auto py-20"},[i("LandingPageSecondSection")],1)]),i("LandingPageBanner",{attrs:{cta:e.$t("landingPage.secondBanner.cta")}},[e._v(" "+e._s(e.$t("landingPage.secondBanner.text"))+" ")]),i("CreditWrapper",{attrs:{credit:"© Ville de Strasbourg"}},[i("img",{staticClass:"h-128 w-full object-cover object-top",attrs:{src:s("8503")}})]),i("PublicContainer",[i("div",{staticClass:"max-w-screen-lg mx-auto py-20"},[i("LandingPageThirdSection"),i("div",{staticClass:"text-center mt-40"},[i("h2",{staticClass:"text-display-lg text-secondary"},[e._v(" "+e._s(e.$t("landingPage.hero.subtitle"))+" ")]),i("LandingPageContactForm",{staticClass:"mx-auto"})],1)],1)]),i("CreditWrapper",{attrs:{credit:"© Ville de Strasbourg"}},[i("div",{staticClass:"grid grid-cols-3 w-full gap-0"},[i("img",{staticClass:"h-64 w-full object-cover object-top",attrs:{src:s("da0f")}}),i("img",{staticClass:"h-64 w-full object-cover object-top",attrs:{src:s("1676")}}),i("img",{staticClass:"h-64 w-full object-cover object-top",attrs:{src:s("8b2f")}})])])],1)},Ci=[],wi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("NavBar",{attrs:{stickyHeader:e.stickyHeader,displayLanguagePicker:e.displayLanguagePicker}}),e._t("default"),s("PublicFooter")],2)},xi=[],ki=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{class:!e.sticky&&"hidden"},[s("NavBarSticky",{attrs:{menuDisplayed:e.menuDisplayed,toggleMenu:e.toggleMenu}})],1),s("div",{class:e.sticky&&"hidden"},[s("PublicContainer",[s("header",{staticClass:"py-4 flex flex-row justify-between items-center",attrs:{role:"navigation"}},[s("NavBarLogo"),s("div",{staticClass:"hidden md:flex flex-row"},[s("div",[s("router-link",{attrs:{to:"/connexion"}},[s("Button",{attrs:{variant:"primary"}},[e._v(e._s(e.$t("landingPage.header.connect")))])],1)],1),e.displayLanguagePicker?s("LanguagePicker",{staticClass:"ml-2"}):e._e()],1),s("NavBarMobileButton",{staticClass:"md:hidden",attrs:{onClick:e.toggleMenu}})],1)])],1),e.menuDisplayed?s("NavBarMobileMenu",{staticClass:"fixed top-0 right-0 mt-16 z-10",attrs:{closeMenu:e.closeMenu,displayLanguagePicker:e.displayLanguagePicker}}):e._e()],1)},Pi=[],Si=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("router-link",{attrs:{to:"/landing"}},[i("div",{staticClass:"flex flex-row align-items"},[i("img",{staticClass:"marianne",attrs:{src:s("37bc"),alt:"france"}}),i("div",{staticClass:"ml-2 text-display-xs md:text-display-sm text-black"},[e._v(" Résorption-bidonvilles ")])])])],1)},$i=[],Ti=(s("4316"),{}),Ai=Object(d["a"])(Ti,Si,$i,!1,null,"07ee7c4c",null),Ei=Ai.exports,Oi=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"fixed z-10 top-0 left-0 w-full bg-white shadow"},[s("PublicContainer",[s("header",{staticClass:"py-4 flex flex-row justify-between items-center",attrs:{role:"navigation"}},[s("NavBarLogo"),s("div",{staticClass:"hidden md:block"},[s("router-link",{staticClass:"mr-2",attrs:{to:"/contact"}},[s("Button",{attrs:{variant:"secondary"}},[e._v(e._s(e.$t("landingPage.header.contact")))])],1),s("router-link",{attrs:{to:"/connexion"}},[s("Button",{attrs:{variant:"primary"}},[e._v(e._s(e.$t("landingPage.header.connect")))])],1)],1),s("NavBarMobileButton",{staticClass:"md:hidden",attrs:{onClick:e.toggleMenu}})],1)])],1)},Ii=[],Di=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("button",{staticClass:"focus:outline-none",on:{click:e.onClick}},[s("svg",{staticClass:"block h-6 w-6",attrs:{stroke:"currentColor",fill:"none",viewBox:"0 0 24 24"}},[s("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"}})])])},ji=[],qi={props:{onClick:{type:Function,required:!0}}},Li=qi,Fi=Object(d["a"])(Li,Di,ji,!1,null,null,null),Mi=Fi.exports,Ni=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container px-4 mx-auto"},[e._t("default")],2)},zi=[],Bi={},Ri=Object(d["a"])(Bi,Ni,zi,!1,null,null,null),Vi=Ri.exports,Ui={props:{menuDisplayed:{type:Boolean,required:!0},toggleMenu:{type:Function,required:!0}},components:{NavBarLogo:Ei,Button:ee,NavBarMobileButton:Mi,PublicContainer:Vi}},Hi=Ui,Gi=Object(d["a"])(Hi,Oi,Ii,!1,null,null,null),Wi=Gi.exports,Yi=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Dropdown",{scopedSlots:e._u([{key:"button",fn:function(){return[i("Button",{attrs:{variant:"primaryOutline",icon:"chevron-down"}},["fr"===e.$i18n.locale?i("img",{staticClass:"inline-block h-6",attrs:{src:s("3229")}}):e._e(),"en"===e.$i18n.locale?i("img",{staticClass:"inline-block h-6",attrs:{src:s("2361")}}):e._e(),"ro"===e.$i18n.locale?i("img",{staticClass:"inline-block h-6",attrs:{src:s("9d64")}}):e._e(),"bg"===e.$i18n.locale?i("img",{staticClass:"inline-block h-6",attrs:{src:s("ac65")}}):e._e(),e._v(" "+e._s(" ")+" "),i("span",{staticClass:"uppercase"},[e._v(e._s(e.$i18n.locale))])])]},proxy:!0},{key:"menu",fn:function(t){var a=t.closeMenu;return[i("Menu",{on:{click:a}},[i("MenuItem",{on:{click:function(t){return e.pickLang("fr")}}},[i("img",{staticClass:"inline-block h-6",attrs:{src:s("3229")}}),e._v(" FR ")]),i("MenuItem",{on:{click:function(t){return e.pickLang("en")}}},[i("img",{staticClass:"inline-block h-6",attrs:{src:s("2361")}}),e._v(" EN ")]),i("MenuItem",{on:{click:function(t){return e.pickLang("ro")}}},[i("img",{staticClass:"inline-block h-6",attrs:{src:s("9d64")}}),e._v(" RO ")]),i("MenuItem",{on:{click:function(t){return e.pickLang("bg")}}},[i("img",{staticClass:"inline-block h-6",attrs:{src:s("ac65")}}),e._v(" BG ")])],1)]}}])})},Ji=[],Qi={methods:{pickLang(e){this.$i18n.locale=e,Object(q["d"])(e)}}},Zi=Qi,Ki=Object(d["a"])(Zi,Yi,Ji,!1,null,null,null),Xi=Ki.exports,ea=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"origin-top-right right-0 mt-2 w-48 rounded-md shadow-lg"},[s("Menu",[s("MenuItem",[s("router-link",{attrs:{to:"/connexion"}},[e._v(" "+e._s(e.$t("landingPage.header.connect"))+" ")])],1),s("MenuItem",[s("router-link",{attrs:{to:"/contact"}},[e._v(" "+e._s(e.$t("landingPage.header.contact"))+" ")])],1),s("MenuItem",[s("LanguagePicker")],1)],1)],1)},ta=[],sa={props:{closeMenu:{required:!0,type:Function},displayLanguagePicker:{type:Boolean}},components:{LanguagePicker:Xi,Menu:Bt,MenuItem:Gt},mounted(){setTimeout(()=>{document.addEventListener("click",this.checkOutsideClick)},0)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{checkOutsideClick(e){this.$el.contains(e.target)||this.closeMenu()}}},ia=sa,aa=Object(d["a"])(ia,ea,ta,!1,null,null,null),na=aa.exports,oa={props:{stickyHeader:{type:Boolean},displayLanguagePicker:{type:Boolean,default:!1}},components:{NavBarLogo:Ei,NavBarSticky:Wi,Button:ee,NavBarMobileMenu:na,NavBarMobileButton:Mi,PublicContainer:Vi,LanguagePicker:Xi},data(){return{scrollTop:0,menuDisplayed:!1}},methods:{handleScroll(){const e=this.$el.offsetHeight;this.scrollTop=window.scrollY-e},openMenu(){this.menuDisplayed=!0},closeMenu(){this.menuDisplayed=!1},toggleMenu(){this.menuDisplayed=!this.menuDisplayed}},computed:{sticky(){return this.scrollTop>200&&this.stickyHeader}},mounted(){window.addEventListener("scroll",this.handleScroll)},destroyed(){window.removeEventListener("scroll",this.handleScroll)}},ra=oa,la=Object(d["a"])(ra,ki,Pi,!1,null,null,null),ca=la.exports,da=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("footer",{staticClass:"bg-black text-white py-8",attrs:{role:"contentinfo"}},[s("PublicContainer",[s("div",{staticClass:"max-w-screen-lg mx-auto"},[s("div",{staticClass:"md:flex flex-row justify-between"},[s("ul",[s("li",[s("font-awesome-icon",{attrs:{icon:"envelope"}})],1),s("li",[s("h4",[e._v(e._s(e.$t("footer.contact")))])]),s("li",[s("h4",[s("a",{staticClass:"underline",attrs:{href:"mailto:contact@resorption-bidonvilles.beta.gouv.fr"}},[e._v("contact@resorption-bidonvilles.beta.gouv.fr")])])])]),s("ul",[s("li",[s("router-link",{attrs:{to:"/statistiques-publiques"}},[e._v(e._s(e.$t("footer.statistics")))])],1),s("li",[s("router-link",{attrs:{to:"/mentions-legales"}},[e._v(e._s(e.$t("footer.legal")))])],1)])])])])],1)},ua=[],pa={components:{PublicContainer:Vi}},ma=pa,ha=Object(d["a"])(ma,da,ua,!1,null,null,null),va=ha.exports,fa={props:{stickyHeader:{type:Boolean,default:!0},displayLanguagePicker:{type:Boolean,default:!1}},components:{NavBar:ca,PublicFooter:va}},_a=fa,ga=Object(d["a"])(_a,wi,xi,!1,null,null,null),ba=ga.exports,ya=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"text-center"},[s("h1",{staticClass:"text-display-xl font"},[e._v(e._s(e.$t("landingPage.hero.title")))]),s("h2",{staticClass:"text-display-lg text-secondary mt-2"},[e._v(" "+e._s(e.$t("landingPage.hero.subtitle"))+" ")]),s("LandingPageContactForm",{staticClass:"mx-auto"})],1)},Ca=[],wa=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("form",{staticClass:"flex flex-row justify-center mt-4 w-full max-w-md",on:{submit:function(t){return t.preventDefault(),e.onSubmit(t)}}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],staticClass:"hidden md:block border-2 border-G200 rounded-md flex-1 py-2 px-4 outline-none focus:border-G400",attrs:{placeholder:e.$t("landingPage.contactForm.email")},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),s("Button",{staticClass:"ml-1",attrs:{type:"submit",variant:"secondary"}},[e._v(e._s(e.$t("landingPage.contactForm.cta")))])],1)},xa=[],ka={data(){return{email:""}},methods:{onSubmit(){this.$router.push("/contact"+(this.email?"?email="+encodeURIComponent(this.email):""))}}},Pa=ka,Sa=Object(d["a"])(Pa,wa,xa,!1,null,null,null),$a=Sa.exports,Ta={components:{LandingPageContactForm:$a}},Aa=Ta,Ea=Object(d["a"])(Aa,ya,Ca,!1,null,null,null),Oa=Ea.exports,Ia=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("img",{staticClass:"full-width mx-auto",attrs:{src:s("8973")}}),i("div",{staticClass:"max-w-screen-sm mx-auto mt-8"},[i("LandingPageResponsiveEmbed",[i("iframe",{attrs:{src:"https://www.youtube.com/embed/AAD0QoOzIHM?modestbranding=1&autohide=1&showinfo=0",frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowfullscreen:""}})])],1),i("div",[i("div",{staticClass:"mt-24"},[i("div",{staticClass:"max-w-screen-sm mx-auto"},[i("div",{staticClass:"text-display-lg font-normal"},[e._v(" "+e._s(e.$t("landingPage.firstSection.context.title"))+" ")]),i("div",{staticClass:"text-display-lg"},[e._v(" "+e._s(e.$t("landingPage.firstSection.context.subtitle"))+" ")]),i("div",{staticClass:"mt-4"},[e._v(" "+e._s(e.$t("landingPage.firstSection.context.text"))+" ")])])]),i("div",{staticClass:"md:grid md:grid-cols-3 gap-16 mt-16"},[i("LandingPageFeatureBlock",{attrs:{icon:"map-marked-alt"}},[e._v(e._s(e.$t("landingPage.firstSection.features.position")))]),i("LandingPageFeatureBlock",{staticClass:"my-8 md:my-0",attrs:{icon:"chart-line"}},[e._v(e._s(e.$t("landingPage.firstSection.features.actions")))]),i("LandingPageFeatureBlock",{attrs:{icon:"comments"}},[e._v(e._s(e.$t("landingPage.firstSection.features.exchange")))])],1),i("div",{staticClass:"md:flex md:flex-row mt-16"},[i("LandingPageContextImage",{attrs:{label:e.$t("landingPage.firstSection.before")}},["fr"===e.$i18n.locale?i("img",{attrs:{src:s("dd94")}}):e._e(),"en"===e.$i18n.locale?i("img",{attrs:{src:s("ab52")}}):e._e(),"bg"===e.$i18n.locale?i("img",{attrs:{src:s("85ae")}}):e._e(),"ro"===e.$i18n.locale?i("img",{attrs:{src:s("b750")}}):e._e()]),i("div",{staticClass:"hidden md:block border-solid border-r-2 border-gray-200 m-20"}),i("LandingPageContextImage",{attrs:{label:e.$t("landingPage.firstSection.after")}},["fr"===e.$i18n.locale?i("img",{attrs:{src:s("cbe6")}}):e._e(),"en"===e.$i18n.locale?i("img",{attrs:{src:s("bb00")}}):e._e(),"bg"===e.$i18n.locale?i("img",{attrs:{src:s("2eea")}}):e._e(),"ro"===e.$i18n.locale?i("img",{attrs:{src:s("c8c7")}}):e._e()])],1),i("LandingPageUserFeedback",{staticClass:"mt-32"})],1)])},Da=[],ja=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("font-awesome-icon",{attrs:{icon:e.icon,size:"3x"}}),s("h3",{staticClass:"text-display-lg font-normal mt-2"},[e._t("default")],2)],1)},qa=[],La={name:"LandingPageFeatureBlock",props:{icon:{type:String,required:!0}}},Fa=La,Ma=Object(d["a"])(Fa,ja,qa,!1,null,null,null),Na=Ma.exports,za=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"text-secondary text-display-md"},[e._v(e._s(e.label))]),e._t("default")],2)},Ba=[],Ra={props:{label:{type:String,required:!0}}},Va=Ra,Ua=Object(d["a"])(Va,za,Ba,!1,null,null,null),Ha=Ua.exports,Ga=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"max-w-screen-sm mx-auto relative mt-16"},[s("LandingPageUserFeedbackSection",{attrs:{active:1===e.active,text:e.$t("landingPage.firstSection.feedback.1.text"),author:e.$t("landingPage.firstSection.feedback.1.author")}}),s("LandingPageUserFeedbackSection",{attrs:{active:2===e.active,text:e.$t("landingPage.firstSection.feedback.2.text"),author:e.$t("landingPage.firstSection.feedback.2.author")}}),s("LandingPageUserFeedbackSection",{attrs:{active:3===e.active,text:e.$t("landingPage.firstSection.feedback.3.text"),author:e.$t("landingPage.firstSection.feedback.3.author")}})],1),s("div",{staticClass:"mt-2 text-center"},[s("LandingPageUserFeedbackBullet",{attrs:{onClick:function(){return e.setSection(1)},active:1===e.active}}),s("LandingPageUserFeedbackBullet",{attrs:{onClick:function(){return e.setSection(2)},active:2===e.active}}),s("LandingPageUserFeedbackBullet",{attrs:{onClick:function(){return e.setSection(3)},active:3===e.active}})],1)])},Wa=[],Ya=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("input",{class:["appearance-none h-3 w-3 mx-1 cursor-pointer rounded-full border border-black outline-none",e.active&&"bg-black border-transparent"],attrs:{type:"radio"},domProps:{checked:e.active},on:{click:e.onClick}})},Ja=[],Qa={props:{active:{type:Boolean},onClick:{type:Function}}},Za=Qa,Ka=Object(d["a"])(Za,Ya,Ja,!1,null,null,null),Xa=Ka.exports,en=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:e.active?"transition duration-500 block opacity-100 visible":"invisible opacity-0 absolute"},[s("div",{staticClass:"relative text-xl feedbackText"},[e._v(e._s(e.text))]),s("div",{staticClass:"text-lg font-light"},[e._v(e._s(e.author))])])},tn=[],sn={props:{text:{type:String},author:{type:String},active:{type:Boolean}}},an=sn,nn=(s("1210"),Object(d["a"])(an,en,tn,!1,null,"a695c1c4",null)),on=nn.exports,rn={data(){return{active:1,interval:null}},methods:{setNextSection(){1===this.active?this.active=2:2===this.active?this.active=3:3===this.active&&(this.active=1)},setSection(e){this.active=e,clearInterval(this.interval),this.interval=setInterval(this.setNextSection,8e3)}},mounted(){this.interval=setInterval(this.setNextSection,8e3)},beforeDestroy(){clearInterval(this.interval)},components:{LandingPageUserFeedbackBullet:Xa,LandingPageUserFeedbackSection:on}},ln=rn,cn=Object(d["a"])(ln,Ga,Wa,!1,null,null,null),dn=cn.exports,un=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"wrapper",style:e.paddingStyle},[e._t("default")],2)},pn=[],mn={props:{videoRatio:{type:String,default:"56.25%"}},computed:{paddingStyle(){return"padding-bottom: "+this.videoRatio}}},hn=mn,vn=(s("379b"),Object(d["a"])(hn,un,pn,!1,null,null,null)),fn=vn.exports,_n={components:{LandingPageContextImage:Ha,LandingPageFeatureBlock:Na,LandingPageUserFeedback:dn,LandingPageResponsiveEmbed:fn}},gn=_n,bn=Object(d["a"])(gn,Ia,Da,!1,null,null,null),yn=bn.exports,Cn=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("div",{staticClass:"md:grid md:grid-cols-3 md:gap-16"},[i("LandingPageDataBlock",{attrs:{line1:e.$t("landingPage.secondSection.data.1.line1"),line2:e.$t("landingPage.secondSection.data.1.line2"),line3:e.$t("landingPage.secondSection.data.1.line3")}}),i("LandingPageDataBlock",{staticClass:"my-4 md:my-0",attrs:{line1:e.$t("landingPage.secondSection.data.2.line1"),line2:e.$t("landingPage.secondSection.data.2.line2"),line3:e.$t("landingPage.secondSection.data.2.line3")}}),i("LandingPageDataBlock",{attrs:{line1:e.$t("landingPage.secondSection.data.3.line1"),line2:e.$t("landingPage.secondSection.data.3.line2"),line3:e.$t("landingPage.secondSection.data.3.line3")}})],1),i("div",{staticClass:"max-w-screen-sm mx-auto "},[i("h2",{staticClass:"mt-16"},[i("span",{staticClass:"text-display-lg font-normal"},[e._v(e._s(e.$t("landingPage.secondSection.title")))]),i("span",{staticClass:"text-display-lg block"},[e._v(e._s(e.$t("landingPage.secondSection.subtitle")))])]),i("div",{staticClass:"mt-8"},[e._v(" "+e._s(e.$t("landingPage.secondSection.firstParagraph"))+" ")]),i("div",{staticClass:"mt-8"},[i("span",{staticClass:"font-bold"},[e._v(e._s(e.$t("landingPage.secondSection.secondParagraph.bold")))]),e._v(" "+e._s(e.$t("landingPage.secondSection.secondParagraph.normal"))+" ")]),i("div",[i("a",{staticClass:"link",attrs:{href:"https://www.ecologie.gouv.fr/resorption-des-campements-illicites-et-des-bidonvilles"}},[e._v(e._s(e.$t("landingPage.secondSection.secondParagraph.link")))])]),"fr"===e.$i18n.locale?i("img",{staticClass:"mt-20 w-full",attrs:{src:s("d67e")}}):e._e(),"en"===e.$i18n.locale?i("img",{staticClass:"mt-20 w-full",attrs:{src:s("1239")}}):e._e(),"bg"===e.$i18n.locale?i("img",{staticClass:"mt-20 w-full",attrs:{src:s("5549")}}):e._e(),"ro"===e.$i18n.locale?i("img",{staticClass:"mt-20 w-full",attrs:{src:s("cfd5")}}):e._e()]),i("div",{staticClass:"mt-20 md:flex md:flex-row items-center"},[i("div",{staticClass:"block md:hidden mb-4 text-display-lg"},[e._v(" "+e._s(e.$t("landingPage.secondSection.video.text"))+" ")]),i("div",{staticClass:"md:w-1/2 md:mr-16 bg-gray-500"},[i("LandingPageResponsiveEmbed",[i("iframe",{attrs:{src:"https://www.dailymotion.com/embed/video/x7mf87e",allowfullscreen:"",allow:"autoplay; fullscreen"}})])],1),i("div",{staticClass:"hidden md:blockw-1/2 text-display-lg"},[e._v(" "+e._s(e.$t("landingPage.secondSection.video.text"))+" ")])])])},wn=[],xn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"text-md"},[e._v(e._s(e.line1))]),s("div",{staticClass:"text-display-xl leading-none"},[e._v(e._s(e.line2))]),s("div",{staticClass:"text-md"},[e._v(e._s(e.line3))])])},kn=[],Pn={name:"LandingPageDataBlock",props:{line1:{type:String,required:!0},line2:{type:String,required:!0},line3:{type:String,required:!0}}},Sn=Pn,$n=Object(d["a"])(Sn,xn,kn,!1,null,null,null),Tn=$n.exports,An={components:{LandingPageDataBlock:Tn,LandingPageResponsiveEmbed:fn}},En=An,On=Object(d["a"])(En,Cn,wn,!1,null,null,null),In=On.exports,Dn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"max-w-screen-sm mx-auto"},[s("h2",{staticClass:"text-display-lg"},[e._v(" "+e._s(e.$t("landingPage.thirdSection.title"))+" ")]),s("div",{staticClass:" mt-8"},[s("span",{staticClass:"font-bold"},[e._v(e._s(e.$t("landingPage.thirdSection.firstParagraph.bold")))]),e._v(" "+e._s(e.$t("landingPage.thirdSection.firstParagraph.normal"))+" ")]),e._m(0),s("div",{staticClass:"grid grid-cols-1 md:grid-cols-2 gap-y-8 md:gap-x-16"},[s("LandingPageBilanBlock",{attrs:{icon:"users",text:e.$t("landingPage.thirdSection.bilan.1.text")}}),s("LandingPageBilanBlock",{attrs:{icon:"hand-holding-medical",text:e.$t("landingPage.thirdSection.bilan.3.text")}}),s("LandingPageBilanBlock",{attrs:{icon:"map-marker-alt",text:e.$t("landingPage.thirdSection.bilan.4.text")}}),s("LandingPageBilanBlock",{attrs:{icon:"file-signature",text:e.$t("landingPage.thirdSection.bilan.6.text")}}),s("LandingPageBilanBlock",{attrs:{icon:"book",text:e.$t("landingPage.thirdSection.bilan.5.text"),info:e.$t("landingPage.thirdSection.bilan.5.info")}})],1),s("div",{staticClass:"text-center mt-8"},[s("a",{attrs:{href:"https://www.gouvernement.fr/sites/default/files/contenu/piece-jointe/2019/09/bilan_campements_2018_vecran.pdf"}},[s("Button",{attrs:{variant:"secondary"}},[e._v(" "+e._s(e.$t("landingPage.thirdSection.cta"))+" ")])],1)])]),s("div",{staticClass:"mt-32"},[s("div",{staticClass:"max-w-screen-sm mx-auto"},[s("h2",{staticClass:"text-display-lg"},[e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.title"))+" ")]),s("div",{staticClass:"mt-4"},[e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.body.text1"))+" "),s("a",{staticClass:"link",attrs:{href:"https://www.ecologie.gouv.fr/resorption-des-campements-illicites-et-des-bidonvilles"}},[e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.body.link1")))]),e._v(", "+e._s(e.$t("landingPage.thirdSection.secondParagraph.body.text2"))+". "),s("span",{staticClass:"font-bold"},[e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.body.text3"))+" ")]),e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.body.text4"))+" "),s("a",{staticClass:"link",attrs:{href:"https://beta.gouv.fr/startups/resorption-bidonvilles.html"}},[e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.body.link2"))+".")])]),s("div",{staticClass:"mt-8"},[s("div",[e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.items.title"))+" ")]),s("ul",{staticClass:"list-disc ml-8"},[s("li",[s("a",{staticClass:"link",attrs:{href:"https://entrepreneur-interet-general.etalab.gouv.fr/defis/2019/resorption-bidonvilles.html"}},[e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.items.1.link")))]),e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.items.1.text"))+" ")]),s("li",[s("a",{staticClass:"link",attrs:{href:"https://ec.europa.eu/info/funding-tenders/opportunities/portal/screen/how-to-participate/org-details/999999999/project/881989/program/31076817/details"}},[e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.items.2.link")))]),e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.items.2.text"))+" ")]),s("li",[s("a",{staticClass:"link",attrs:{href:"https://beta.gouv.fr/approche/fast/03-fast.html"}},[e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.items.3.link")))]),e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.items.3.text"))+" ")]),s("li",[s("a",{staticClass:"link",attrs:{href:"https://www.modernisation.gouv.fr/action-publique-2022/fonds-pour-la-transformation-de-laction-publique/ftap-112-millions-deuros-pour-les-19-projets-laureats"}},[e._v(e._s(e.$t("landingPage.thirdSection.secondParagraph.items.4.link")))]),e._v(" "+e._s(e.$t("landingPage.thirdSection.secondParagraph.items.4.text"))+" ")])])]),e._m(1),e._m(2)])])])},jn=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-row items-center my-8"},[s("div",{staticClass:"bg-gray-500 h-px flex-1"}),s("div",{staticClass:"inline-block bg-black text-white text-display-md px-4"},[e._v(" 2019 ")]),s("div",{staticClass:"bg-gray-500 h-px flex-1"})])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex flex-row flex-wrap items-center justify-between mt-8"},[i("a",{attrs:{href:"https://solidarites-sante.gouv.fr/"}},[i("img",{staticClass:"h-24 m-2",attrs:{src:s("6ead")}})]),i("a",{attrs:{href:"https://ec.europa.eu/info/index_en"}},[i("img",{staticClass:"h-24 my-2",attrs:{src:s("e61f")}})])])},function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"flex flex-row flex-wrap items-center justify-between mt-8"},[i("a",{attrs:{href:"https://beta.gouv.fr/approche/incubateurs/mtes.html"}},[i("img",{staticClass:"h-24 m-2",attrs:{src:s("0f88")}})]),i("a",{attrs:{href:"https://beta.gouv.fr/"}},[i("img",{staticClass:"h-20 m-2",attrs:{src:s("3b8a")}})]),i("a",{attrs:{href:"https://entrepreneur-interet-general.etalab.gouv.fr/defis/2019/resorption-bidonvilles.html"}},[i("img",{staticClass:"h-16 m-2",attrs:{src:s("77c5")}})])])}],qn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex flex-row"},[s("div",[s("font-awesome-icon",{staticClass:"text-secondary",attrs:{icon:e.icon,size:"2x"}})],1),s("div",{staticClass:"ml-2"},[s("span",{staticClass:"font-bold text-display-md"},[e._v(e._s(e.text))]),s("span",[e._v(e._s(e.info))])])])},Ln=[],Fn={name:"LandingPageBilanBlock",props:{icon:{required:!0},text:{type:String,required:!0},info:{type:String}}},Mn=Fn,Nn=Object(d["a"])(Mn,qn,Ln,!1,null,null,null),zn=Nn.exports,Bn={components:{LandingPageBilanBlock:zn,Button:ee}},Rn=Bn,Vn=Object(d["a"])(Rn,Dn,jn,!1,null,null,null),Un=Vn.exports,Hn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"bg-corail text-white full-width text-center py-8"},[s("PublicContainer",[s("div",{staticClass:"max-w-screen-md mx-auto"},[s("h2",{staticClass:"text-display-lg text-white "},[e._t("default")],2),s("div",{staticClass:"pt-4"},[s("router-link",{attrs:{to:"/contact"}},[s("Button",{attrs:{variant:"primary"}},[e._v(e._s(e.cta))])],1)],1)])])],1)},Gn=[],Wn={components:{Button:ee,PublicContainer:Vi},props:{cta:{type:String,required:!0}}},Yn=Wn,Jn=Object(d["a"])(Yn,Hn,Gn,!1,null,null,null),Qn=Jn.exports,Zn=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"relative"},[e._t("default"),s("div",{staticClass:"absolute bottom-0 right-0 mr-4 text-white"},[e._v(" "+e._s(e.credit)+" ")])],2)},Kn=[],Xn={props:{credit:{type:String}}},eo=Xn,to=Object(d["a"])(eo,Zn,Kn,!1,null,null,null),so=to.exports,io={components:{CreditWrapper:so,PublicContainer:Vi,PublicLayout:ba,LandingPageHero:Oa,LandingPageFirstSection:yn,LandingPageSecondSection:In,LandingPageThirdSection:Un,LandingPageBanner:Qn,LandingPageContactForm:$a}},ao=io,no=Object(d["a"])(ao,yi,Ci,!1,null,null,null),oo=no.exports,ro=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("Form",e._b({on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1)])},lo=[],co=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",{attrs:{role:"navigation"}},[s("div",{staticClass:"topbar"},[s("div",{staticClass:"topbar-container"},[s("router-link",{staticClass:"topbar-home",attrs:{to:"/landing"}},[s("img",{staticClass:"topbar-marianne",attrs:{src:"/img/logo-marianne.svg",alt:"france"}}),s("span",{staticClass:"topbar-domain"},[e._v("resorption-bidonvilles.")]),s("img",{staticClass:"topbar-betagouv",attrs:{src:"/img/betagouvfr.svg",alt:"beta.gouv.fr"}})]),s("span",{ref:"menu",staticClass:"topbar-menu",on:{click:e.showSidebar}},[e._v("Menu")]),s("ul",{staticClass:"nav__links"},e._l(e.items,(function(t){return s("li",{key:t.target,staticClass:"nav__item"},[t.items?s("div",{staticClass:"dropdown"},[e._v(e._s(t.label)+" "),s("div",{staticClass:"dropdown-content"},e._l(t.items,(function(t){return s("router-link",{key:t.target,class:Object.assign(t.classes||{},t.group?{active:e.isCurrentRouteAMemberOf(t.group)}:{}),attrs:{to:t.target}},[e._v(e._s(t.label))])})),1)]):s("router-link",{class:Object.assign(t.classes||{},t.group?{active:e.isCurrentRouteAMemberOf(t.group)}:{}),attrs:{to:t.target}},[e._v(e._s(t.label))])],1)})),0)],1)]),s("div",{ref:"sidebar",staticClass:"sidebar",class:{opened:e.isSidebarOpened}},[s("div",{staticClass:"sidebar-cross",on:{click:e.hideSidebar}},[s("img",{attrs:{src:"/img/cross.svg",alt:"Fermer"}})]),s("ul",{staticClass:"nav__links"},e._l(e.items,(function(t){return s("li",{key:t.target,staticClass:"nav__item"},[t.items?s("div",{staticClass:"dropdown"},[e._v(e._s(t.label)+" "),s("div",{staticClass:"dropdown-content"},e._l(t.items,(function(t){return s("router-link",{key:t.target,class:Object.assign(t.classes||{},t.group?{active:e.isCurrentRouteAMemberOf(t.group)}:{}),attrs:{to:t.target}},[e._v(e._s(t.label))])})),1)]):s("router-link",{class:Object.assign(t.classes||{},t.group?{active:e.isCurrentRouteAMemberOf(t.group)}:{}),attrs:{to:t.target}},[e._v(e._s(t.label))])],1)})),0)])])},uo=[];let po=null;function mo(e){null===po||po.closed?po=window.open(e,"_blank"):(po.location=e,po.location.reload(),po.focus())}var ho=s("227c");const vo={MISSING_TOKEN:1,EXPIRED_OR_INVALID_TOKEN:2};function fo(e,t){let s=null;try{s=this.responseText?JSON.parse(this.responseText):this.responseText}catch(a){return void t({user_message:"Une erreur inconnue est survenue",developer_message:"Failed to parsed the server's response"})}if(!0!==s.success||void 0===s.response)if(this.status/200<1||this.status/200>=1.5){const e=s&&s.error||s||{};switch(e.code){case vo.MISSING_TOKEN:case vo.EXPIRED_OR_INVALID_TOKEN:Fo(i["default"].prototype.$piwik),Cy.push("/");break;default:t(e.user_message?e:{user_message:"Une erreur inconnue est survenue",developer_message:"The server responded with an error status but did not provide error details"})}}else e(s);else e(s.response)}function _o(e){e()}function go(e,t,s,i={}){const a=new XMLHttpRequest,n=new Promise((n,o)=>{if(a.open(e,"https://api.resorption-bidonvilles.beta.gouv.fr"+t),Object.keys(i).forEach(e=>{a.setRequestHeader(e,i[e])}),!Object.prototype.hasOwnProperty.call(i,"x-access-token")){const e=zo();null!==e&&a.setRequestHeader("x-access-token",e)}a.setRequestHeader("x-app-version",ho),a.onload=fo.bind(a,n,o),a.onerror=_o.bind(a,o),a.ontimeout=_o.bind(a,o),void 0!==s?(Object.prototype.hasOwnProperty.call(i,"Content-Type")||a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(s))):a.send()});return n.abort=()=>{a.abort()},n}function bo(e,t,s){return go("GET",e,t,s)}function yo(e,t,s){return go("POST",e,t,s)}function Co(e,t,s){return go("DELETE",e,t,s)}function wo(e,t,s){return go("PATCH",e,t,s)}function xo(e,t,s){return go("PUT",e,t,s)}function ko(e){return mo(`${e}${-1===e.indexOf("?")?"?":"&"}accessToken=${encodeURIComponent(zo())}`)}let Po=null;function So(){return null!==Po}function $o(){return bo("/config").then(e=>(Lo(),Po=e,e))}function To(){Po=null}function Ao(){return Po}function Eo(e,t){if(null===Po)return;const s=e.split(".");let i=Po;while(s.length>1){if(void 0===i)return;i=i[s.shift()]}i[s[0]]=t}function Oo(e){if(null===Po||null===Po.user)return null;const[t,s]=e.split(".");if(!Object.prototype.hasOwnProperty.call(Po.user.permissions,t)||!Object.prototype.hasOwnProperty.call(Po.user.permissions[t],s))return null;const i=Po.user.permissions[t][s];return!0!==i.allowed?null:i}function Io(e){const[t,s,i]=e.split("."),a=Oo(`${t}.${s}`);return null!==a&&(void 0===i||!0===a[i])}function Do(e){return yo("/changelog",{version:e})}function jo(){return null!==Po&&Po.user.charte_engagement_a_jour}function qo(e,t){return yo("/signin",{email:e,password:t}).then(e=>(localStorage.setItem("token",e.token),e))}function Lo(){return bo("/refreshToken").then(e=>{localStorage.setItem("token",e.token)})}function Fo(e){To(),localStorage.removeItem("token"),e&&(e.resetUserId(),e.setCustomVariable(1,"superuser",null),e.setCustomVariable(2,"structure",null),e.setCustomVariable(3,"niveau_geo",null),e.setCustomVariable(4,"geo_nom",null))}function Mo(){return null!==localStorage.getItem("token")}function No(){return!0===localStorage.getItem("logged_once")}function zo(){return localStorage.getItem("token")}function Bo(e){return yo("/users",e)}function Ro(){return bo("/me")}function Vo(e){return yo("/me",e)}function Uo(){return bo("/users")}function Ho(e){return bo("/users/"+e)}function Go(e,t){return yo(`/users/${e}/sendActivationLink`,t)}function Wo(e){return yo(`/users/${e}/denyAccess`)}function Yo(e){return bo(`/activation-tokens/${encodeURIComponent(e)}/check`)}function Jo(e){return bo(`/password-tokens/${encodeURIComponent(e)}/check`)}function Qo(e,t){return yo(`/users/${e}/activate`,t)}function Zo(e,t){return yo(`/users/${e}/newPassword`,t)}function Ko(e,t){return yo(`/users/${e}/upgrade`,t)}function Xo(e){return Co("/users/"+e)}function er(e){return yo("/users/new-password",{email:e})}function tr(){return bo("/directory")}function sr(e){return bo("/organizations/search?query="+encodeURIComponent(e))}function ir(e,t){return xo(`/users/${e}/charte_engagement`,{version_de_charte:t})}var ar={anonymous:[{label:"Connexion",target:"/connexion"},{label:"Demander un accès",target:"/contact"},{label:"Aide",items:[{label:"Nous contacter",target:"/feedback"},{label:"Mentions légales",target:"/mentions-legales"},{label:"CGUs",target:"/conditions-d-utilisation"}]}],loading:[{label:"Aide",items:[{label:"Nous contacter",target:"/feedback"},{label:"Mentions légales",target:"/mentions-legales"},{label:"CGUs",target:"/conditions-d-utilisation"}]},{label:"Déconnexion",target:"/deconnexion"}],loaded:[{label:"Covid-19",target:"/covid-19",classes:{"router-link--covid":!0}},{label:"Sites",items:[{label:"Liste des sites",target:"/liste-des-sites",group:"townList"},{label:"Déclarer un site",target:"/nouveau-site",group:"townCreation"}]},{label:"Dispositifs",items:[{label:"Liste des dispositifs",target:"/liste-des-dispositifs"},{label:"Déclarer un dispositif",target:"/nouveau-dispositif"}]},{label:"Annuaire",target:"/annuaire",group:"directory"},{label:"Administration",items:[{label:"Liste des utilisateurs",target:"/liste-des-utilisateurs",group:"users"},{label:"Créer un utilisateur",target:"/nouvel-utilisateur",group:"userCreation"},{label:"Statistiques",target:"/statistiques",group:"stats"},{label:"Historique des activités",target:"/historique-des-activites",group:"admin"}]},{label:"Mon compte",items:[{label:"Gérer mon compte",target:"/mon-compte",group:"me"},{label:"Déconnexion",target:"/deconnexion"}]},{label:"Aide",items:[{label:"Nous contacter",target:"/feedback"},{label:"Mentions légales",target:"/mentions-legales"},{label:"CGUs",target:"/conditions-d-utilisation"}]}]},nr={data(){return{isSidebarOpened:!1}},computed:{items(){return!0!==Mo()?ar.anonymous:!0!==So()||!0!==jo()?ar.loading:this.filterItems(ar.loaded)}},methods:{filterItems(e){return e.map(e=>e.items?Object.assign(e,{items:e.items.filter(e=>this.isItemAllowed(e))}):e).filter(e=>e.items?e.items.length>0:this.isItemAllowed(e))},isItemAllowed(e){const t=this.$router.resolve({path:e.target}).route.meta.permissions;return!t||t.every(e=>Io(e))},isCurrentRouteAMemberOf(e){return this.$route.matched.some(t=>t.meta.group===e)},showSidebar(){this.isSidebarOpened=!0},hideSidebar(){this.isSidebarOpened=!1},checkClickOutsideSidebar(e){this.$refs.sidebar.contains(e.target)||e.target===this.$refs.menu||this.hideSidebar()}},mounted(){document.addEventListener("click",this.checkClickOutsideSidebar)},destroyed(){document.removeEventListener("click",this.checkClickOutsideSidebar)}},or=nr,rr=or,lr=(s("17d9"),Object(d["a"])(rr,co,uo,!1,null,"b24b83de",null)),cr=lr.exports,dr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form",attrs:{id:"top"}},[s("header",{staticClass:"form-header"},[s("div",{staticClass:"container"},[s("h1",{staticClass:"form-title"},[e._v(e._s(e.title||"Formulaire"))])])]),s("div",{staticClass:"container"},[s("div",{staticClass:"form-body"},[s("div",{staticClass:"container"},[e.description?s("SlideNote",{attrs:{title:e.descriptionTitle,content:e.description}}):e._e(),e._l(e.fullSections,(function(t){return s("section",{staticClass:"formSection"},[s("header",{staticClass:"formSection-header"},[t.title?s("h1",{staticClass:"formSection-title"},[s("span",{staticClass:"formSection-icon"},[s("font-awesome-icon",{attrs:{icon:t.icon||"flag"}})],1),e._v(" "+e._s(t.title)+" ")]):e._e(),t.description?s("p",{staticClass:"formSection-description",domProps:{innerHTML:e._s(t.description)}}):e._e()]),s("div",[s("span",{staticStyle:{display:"none"}},[e._v(e._s(e.refreshId))]),e._l(t.inputs,(function(t,i){return e.isInputVisible(t)?s("Input",e._b({key:i,attrs:{id:i,errors:e.errors&&e.errors.fields&&e.errors.fields[i]||void 0,disabled:e.isInputDisabled(t),alertMessage:e.getInputAlert(t)},on:{change:e.onDataChange},model:{value:e.data[i],callback:function(t){e.$set(e.data,i,t)},expression:"data[inputId]"}},"Input",t,!1)):e._e()}))],2)])})),e.errors&&e.errors.main?s("div",{staticClass:"notification error"},[s("span",[e._v(e._s(e.wording.error+" : "+e.errors.main))]),e.numberOfFilteredErrors>0?s("p",[e._v("Les champs en erreur sont : "),s("ul",e._l(e.filteredErrors,(function(t,i){return s("li",[s("a",{on:{click:function(t){e.$router.replace("#top",(function(){return e.$router.replace("#"+i)}))}}},[e._v(e._s((e.getInputById(i)||{}).label||"inconnu"))])])})),0)]):e._e()]):e._e(),s("section",{staticClass:"form-stepNav"},[e.submitPrefix?s("p",{domProps:{innerHTML:e._s(e.submitPrefix)}}):e._e(),s("button",{staticClass:"form-stepButton button",attrs:{"data-cy-button":"submit",disabled:e.pending},on:{click:e.submit}},[e.pending?s("img",{attrs:{src:"/img/spinner_light.svg",width:"20"}}):s("span",[e._v(e._s(e.wording.submit))])])])],2)])])])},ur=[],pr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"form__group inputContainer",class:{error:e.errors.length>0},attrs:{id:e.id}},[s("label",{staticClass:"input-label"},[e._v(e._s(e.label)),e.mandatory?s("sup",{staticClass:"input-mandatory"},[e._v(" (*)")]):e._e()]),e.alertMessage?s("p",{staticClass:"notification warning"},[e._v(e._s(e.alertMessage))]):s("div",[e.description?s("p",{staticClass:"input-description",domProps:{innerHTML:e._s(e.description)}}):e._e(),e.errors.length>0?s("div",{staticClass:"notification error"},e._l(e.errors,(function(t){return s("ul",[s("li",[e._v(e._s(t))])])})),0):e._e(),"text"===e.type?s("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--text",attrs:{"data-cy-field":e.id,type:"text",id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled},domProps:{value:e.data},on:{input:function(t){t.target.composing||(e.data=t.target.value)}}},"input",e.props,!1)):e._e(),"hidden"===e.type?s("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--hidden",attrs:{"data-cy-field":e.id,type:"hidden",id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled},domProps:{value:e.data},on:{input:function(t){t.target.composing||(e.data=t.target.value)}}},"input",e.props,!1)):e._e(),"checkbox"===(e.showPassword?"text":"password")&&"password"===e.type?s("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--password",attrs:{"data-cy-field":e.id,id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled,type:"checkbox"},domProps:{checked:Array.isArray(e.data)?e._i(e.data,null)>-1:e.data},on:{change:function(t){var s=e.data,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&(e.data=s.concat([n])):o>-1&&(e.data=s.slice(0,o).concat(s.slice(o+1)))}else e.data=a}}},"input",e.props,!1)):"radio"===(e.showPassword?"text":"password")&&"password"===e.type?s("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--password",attrs:{"data-cy-field":e.id,id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled,type:"radio"},domProps:{checked:e._q(e.data,null)},on:{change:function(t){e.data=null}}},"input",e.props,!1)):"password"===e.type?s("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--password",attrs:{"data-cy-field":e.id,id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled,type:e.showPassword?"text":"password"},domProps:{value:e.data},on:{input:function(t){t.target.composing||(e.data=t.target.value)}}},"input",e.props,!1)):e._e(),"password"===e.type?s("span",{staticClass:"input--password-toggler",on:{click:function(t){e.showPassword=!e.showPassword}}},[s("font-awesome-icon",{attrs:{icon:e.showPassword?"eye":"eye-slash"}})],1):e._e(),"textarea"===e.type?s("textarea",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--textarea",attrs:{"data-cy-field":e.id,id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled},domProps:{value:e.data},on:{input:function(t){t.target.composing||(e.data=t.target.value)}}},"textarea",e.props,!1)):e._e(),"number"===e.type?s("input",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--number",attrs:{"data-cy-field":e.id,type:"number",id:"input-"+e.id,disabled:e.disabled,readonly:e.disabled},domProps:{value:e.data},on:{input:function(t){t.target.composing||(e.data=t.target.value)}}},"input",e.props,!1)):e._e(),"select"===e.type||"selectMultiple"===e.type?s("select",e._b({directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--select",attrs:{"data-cy-field":e.id,id:"input-"+e.id,multiple:"selectMultiple"===e.type,disabled:e.disabled},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.data=t.target.multiple?s:s[0]}}},"select",e.props,!1),[e._l(Object.keys(e.options),(function(t){return e.optionsAreGrouped?s("optgroup",{attrs:{label:e.options[t].label}},e._l(e.options[t].options,(function(t){return s("option",{domProps:{value:t.value}},[e._v(e._s(t.label))])})),0):e._e()})),e._l(e.options,(function(t){return e.optionsAreGrouped?e._e():s("option",{domProps:{value:t.value}},[e._v(e._s(t.label))])}))],2):e._e(),"radio"===e.type?s("ul",{staticClass:"input input--radio",attrs:{id:"input-"+e.id}},e._l(e.options,(function(t,i){return s("li",{staticClass:"input--radio-option"},[s("label",{attrs:{for:"input"+e._uid+"-"+i}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--radio",attrs:{type:"radio","data-cy-field":e.id,"data-cy-label":t.label,id:"input"+e._uid+"-"+i,name:"input"+e._uid,disabled:e.disabled},domProps:{value:t.value,checked:e._q(e.data,t.value)},on:{change:function(s){e.data=t.value}}}),e._v(" "+e._s(t.label)+" ")])])})),0):e._e(),"checkbox"===e.type?s("ul",{staticClass:"input--checkbox",attrs:{id:"input-"+e.id}},e._l(e.options,(function(t,i){return s("li",{staticClass:"input--checkbox-option"},[s("label",{attrs:{for:"input"+e._uid+"-"+i}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--checkbox",attrs:{type:"checkbox","data-cy-field":e.id,"data-cy-label":t.label,id:"input"+e._uid+"-"+i,name:"input"+e._uid,disabled:e.disabled},domProps:{value:t.value,checked:Array.isArray(e.data)?e._i(e.data,t.value)>-1:e.data},on:{change:function(s){var i=e.data,a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=t.value,r=e._i(i,o);a.checked?r<0&&(e.data=i.concat([o])):r>-1&&(e.data=i.slice(0,r).concat(i.slice(r+1)))}else e.data=n}}}),e._v(" "+e._s(t.label)+" ")])])})),0):e._e(),"date"===e.type?s("Datepicker",e._b({attrs:{"data-cy-field":e.id,"input-class":"input input--date",disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Datepicker",e.props,!1)):e._e(),"autocompleter"===e.type?s("Autocompleter",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Autocompleter",e.props,!1)):e._e(),"address"===e.type?s("Address",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Address",e.props,!1)):e._e(),"location"===e.type?s("Location",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Location",e.props,!1)):e._e(),"addressWithLocation"===e.type?s("AddressWithLocation",e._b({attrs:{"data-cy-field":e.id,disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"AddressWithLocation",e.props,!1)):e._e(),"townList"===e.type?s("TownList",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"TownList",e.props,!1)):e._e(),"planFunding"===e.type?s("PlanFunding",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"PlanFunding",e.props,!1)):e._e(),"collectivity"===e.type?s("Collectivity",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Collectivity",e.props,!1)):e._e(),"organization"===e.type?s("Organization",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Organization",e.props,!1)):e._e(),"etp"===e.type?s("Etp",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Etp",e.props,!1)):e._e(),"audience"===e.type?s("Audience",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Audience",e.props,!1)):e._e(),"planHousing"===e.type?s("PlanHousing",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"PlanHousing",e.props,!1)):e._e()],1)])},mr=[],hr=s("fa33"),vr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"autocompleter"},[s("div",{ref:"measure",staticClass:"autocompleter-measure"},[e._v(e._s(e.currentLabel))]),s("div",{staticClass:"autocompleter-textfield"},[s("div",{ref:"prefixIcon",staticClass:"autocompleter-prefixIcon"},[s("img",{attrs:{src:"/img/search.svg"}})]),s("input",{directives:[{name:"model",rawName:"v-model",value:e.currentLabel,expression:"currentLabel"}],ref:"input",attrs:{type:"text",disabled:e.disabled,readonly:e.disabled,placeholder:e.placeholder},domProps:{value:e.currentLabel},on:{keydown:e.onNavigation,keyup:e.onType,focus:function(t){e.focused=!0},blur:function(t){e.focused=!1},input:function(t){t.target.composing||(e.currentLabel=t.target.value)}}}),s("div",{ref:"spinner",staticClass:"autocompleter-spinner",style:{visibility:e.suggestionRequest.pending?"visible":"hidden"}},[s("img",{attrs:{src:"/img/spinner_dark.svg"}})]),e.currentLabel&&!e.disabled?s("span",{ref:"suffixIcon",staticClass:"autocompleter-clearIcon",on:{click:e.clearLabel}}):e._e(),null!==e.suggestions?s("div",{ref:"suggestionContainer",staticClass:"autocompleter-suggestionContainer",class:{"autocompleter-suggestionContainer--float":e.float,"autocompleter-suggestionContainer--withoutCategories":!e.showCategory}},e._l(e.nonEmptyCategories,(function(t){return e.nonEmptyCategories.length>0?s("div",{staticClass:"autocompleter-suggestionCategoryContainer"},[e.showCategory?s("div",{staticClass:"autocompleter-suggestionCategory"},[e._v(e._s(t))]):e._e(),s("ul",{staticClass:"autocompleter-suggestionCategoryItems"},e._l(e.unselectedSuggestions[t],(function(t){return s("li",{staticClass:"autocompleter-suggestionCategoryItem",class:{"autocompleter-suggestionCategoryItem--empty":t.isExtra,active:t.id===e.idOfHighlightedItem},on:{click:function(s){return e.selectItem(t)}}},[e._v(e._s(t.label))])})),0)]):e._e()})),0):e._e(),null===e.suggestions&&e.suggestionRequest.error&&e.float?s("div",{staticClass:"autocompleter-suggestionContainer autocompleter-suggestionContainer--float autocompleter-suggestionContainer--withoutCategories"},[s("div",{staticClass:"autocompleter-suggestionCategoryContainer"},[s("ul",{staticClass:"autocompleter-suggestionCategoryItems"},[s("li",{staticClass:"autocompleter-suggestionCategoryItem autocompleter-suggestionCategoryItem--error"},[s("img",{attrs:{src:"/img/warning.svg"}}),e._v(" "+e._s(e.suggestionRequest.error))])])])]):e._e()]),e.suggestionRequest.error&&!e.float?s("p",{staticClass:"autocompleter-error"},[s("img",{attrs:{src:"/img/warning.svg"}}),s("span",[e._v(e._s(e.suggestionRequest.error))])]):e._e(),e.allowMultiple&&e.selectedItems.length>0?s("div",{staticClass:"autocompleter-selectionContainer"},[s("p",[e._v(e._s(e.wording.selectedItems)+" :")]),s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[e._v(e._s(e.wording.label))]),s("th",[e._v("Actions")])])]),s("tbody",e._l(e.selectedItems,(function(t){return s("tr",[s("td",[e._v(e._s(t.label))]),s("td",[e.disabled?e._e():s("img",{staticClass:"autocompleter-removeItemIcon",attrs:{src:"/img/remove.svg"},on:{click:function(s){return e.unselectItem(t)}}})])])})),0)])]):e._e()])},fr=[];const _r=200;var gr={props:{autocompleter:{type:Function,required:!0},showCategory:{type:Boolean,required:!1,default:!1},allowMultiple:{type:Boolean,required:!1,default:!1},float:{type:Boolean,required:!1,default:!0},wording:{type:Object,required:!1,default(){return{selectedItems:"Éléments sélectionnés",label:"Label"}}},createNew:{type:Function,required:!1,default:null},value:{type:Array,required:!1,default(){return[]}},disabled:{type:Boolean,required:!1,default:!1},placeholder:{type:String,required:!1}},data(){let e="";return this.allowMultiple||1!==this.value.length||([{label:e}]=this.value),{selectedItems:this.value,currentLabel:e,previousLabel:e,focused:!1,suggestions:null,suggestionRequest:{timeout:null,promise:null,pending:!1,error:null},indexOfHighligtedItem:null}},computed:{selectedIds(){return this.selectedItems.map(({id:e})=>e)},nonEmptyCategories(){return Object.keys(this.unselectedSuggestions).sort()},unselectedSuggestions(){if(null===this.suggestions)return{};let e=!0;const t=this.suggestions.reduce((t,s)=>(this.allowMultiple&&-1!==this.selectedIds.indexOf(s.id)||(t[s.category]||(t[s.category]=[]),t[s.category].push(s),e=!1),t),{});return null!==this.createNew?t._=[{id:"new",label:`Créer "${this.currentLabel}"`,category:"",data:{},isExtra:!0}]:e&&(t._=[{id:"empty",label:"Aucun résultat",category:"",data:{},isExtra:!0}]),t},unselectedSuggestionsFlat(){return this.nonEmptyCategories.reduce((e,t)=>[...e,...this.unselectedSuggestions[t]],[])},isSuggestionListEmpty(){const e=this.unselectedSuggestionsFlat;return!(e.length>1)&&(0===e.length||!0===e[0].isExtra&&"empty"===e[0].id)},idOfHighlightedItem(){return null===this.indexOfHighligtedItem||this.indexOfHighligtedItem<0||this.indexOfHighligtedItem>=this.unselectedSuggestionsFlat.length?null:this.unselectedSuggestionsFlat[this.indexOfHighligtedItem].id}},watch:{value(){this.selectedItems=this.value},disabled(){this.reset()}},mounted(){document.addEventListener("click",this.checkOutsideClick)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{onType(){this.positionSpinner(),this.currentLabel!==this.previousLabel&&(this.previousLabel=this.currentLabel,this.resetSuggestions(),this.scheduleSuggestionRequest())},onNavigation(e){this.isSuggestionListEmpty?this.indexOfHighligtedItem=null:38===e.keyCode?this.indexOfHighligtedItem-1<0?this.indexOfHighligtedItem=null:this.indexOfHighligtedItem-=1:40===e.keyCode?this.unselectedSuggestionsFlat.length>0&&(null===this.indexOfHighligtedItem?this.indexOfHighligtedItem=0:this.indexOfHighligtedItem=Math.min(this.unselectedSuggestionsFlat.length-1,this.indexOfHighligtedItem+1)):13===e.keyCode?null!==this.indexOfHighligtedItem&&(this.selectItem(this.unselectedSuggestionsFlat[this.indexOfHighligtedItem]),this.$refs.input.focus()):this.indexOfHighligtedItem=null},scheduleSuggestionRequest(){this.cancelSuggestionRequest(),this.suggestionRequest.timeout=setTimeout(this.requestSuggestions,_r)},cancelSuggestionRequest(){null!==this.suggestionRequest.promise&&this.suggestionRequest.promise.abort(),this.resetSuggestionPromise(),null!==this.suggestionRequest.timeout&&(clearTimeout(this.suggestionRequest.timeout),this.suggestionRequest.timeout=null)},resetSuggestionPromise(){this.suggestionRequest.promise=null,this.suggestionRequest.pending=!1,this.suggestionRequest.error=null},requestSuggestions(){this.canLabelTriggerARequest(this.currentLabel)&&(null!==this.suggestionRequest.promise&&this.cancelSuggestionRequest(),this.suggestionRequest.pending=!0,this.suggestionRequest.promise=this.autocompleter(this.currentLabel),this.suggestionRequest.promise.then(this.setSuggestions).catch(this.handleSuggestionFailure))},setSuggestions(e){this.resetSuggestionPromise(),this.focused&&(this.suggestions=e,this.isSuggestionListEmpty||(this.indexOfHighligtedItem=0))},handleSuggestionFailure(e){let t="erreur inconnue";e&&e.user_message&&(t=e.user_message),this.resetSuggestionPromise(),this.suggestionRequest.error="Une erreur est survenue : "+t},canLabelTriggerARequest(e){return""!==e},clearLabel(){this.cancelSuggestionRequest(),this.setLabel(""),!1===this.allowMultiple&&(this.selectedItems=[],this.$emit("input",this.selectedItems))},reset(){this.cancelSuggestionRequest(),this.$refs.input.blur(),this.allowMultiple||1!==this.selectedItems.length?this.setLabel(""):this.setLabel(this.selectedItems[0].label)},resetSuggestions(){this.suggestions=null},setLabel(e){this.currentLabel=e,this.previousLabel=e,this.resetSuggestions()},checkOutsideClick(e){const t=["prefixIcon","input","suffixIcon","suggestionContainer"];t.some(t=>this.$refs[t]&&this.$refs[t].contains(e.target))||this.reset()},selectItem(e){if(!0!==e.isExtra){if(!1===this.allowMultiple)this.selectedItems=[e],this.reset();else{if(this.selectedItems.some(({id:t})=>e.id===t))return;this.selectedItems.push(e)}this.$emit("input",this.selectedItems)}else{if("empty"===e.id)return;"new"===e.id&&(this.createNew(this.currentLabel),this.resetSuggestions())}},unselectItem(e){const t=this.selectedItems.findIndex(({id:t})=>e.id===t);-1!==t&&(this.selectedItems.splice(t,1),this.$emit("input",this.selectedItems))},positionSpinner(){this.$refs.spinner.style.marginLeft=0;const e=this.$refs.input.clientWidth;this.$refs.spinner.offsetLeft,this.$refs.spinner.offsetWidth,this.$refs.spinner.style.marginLeft=Math.min(this.$refs.measure.clientWidth,e)+"px"}}},br=gr,yr=br,Cr=(s("4f16"),Object(d["a"])(yr,vr,fr,!1,null,null,null)),wr=Cr.exports,xr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Autocompleter",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Autocompleter",e.options,!1))},kr=[];function Pr(e){return`${e.geometry.coordinates[0]}-${e.geometry.coordinates[1]}`}function Sr(e){const t=[];return e.filter(e=>{const s=Pr(e);return-1===t.indexOf(s)&&(t.push(s),!0)})}function $r(e,t){if(200===this.status)try{const{features:t}=JSON.parse(this.responseText);e(Sr(t).filter(e=>e.properties&&e.properties.citycode).map(e=>({addressType:e.properties.type,citycode:e.properties.citycode,city:e.properties.city,coordinates:e.geometry.coordinates,id:e.properties.id,label:`${e.properties.label}, ${e.properties.context}`,category:"address",data:{citycode:e.properties.citycode,city:e.properties.city,label:`${e.properties.label}, ${e.properties.context}`,coordinates:e.geometry.coordinates}})))}catch(s){t()}else t()}function Tr(e,t=5){const s=new XMLHttpRequest,i=new Promise((i,a)=>{const n=["q="+encodeURIComponent(e)],o=parseInt(t,10);Number.isNaN(o)||n.push("limit="+o),s.open("GET","https://api-adresse.data.gouv.fr/search/?"+n.join("&")),s.onload=$r.bind(s,i,a),s.onerror=a,s.ontimeout=a,s.send()});return i.abort=()=>{s.abort()},i}function Ar(e){const t=bo("/locations/search?q="+encodeURIComponent(e)),s=t.then(e=>e.map(e=>({label:5===e.code.length?`(${e.code.slice(0,2)}) ${e.name}`:e.name,code:e.code,type:e.label,locationType:e.type,departement:e.departement})));return s.abort=t.abort,s}function Er(){return bo("/departements")}var Or={components:{Autocompleter:wr},props:{value:{type:Object,required:!1,default(){return null}},disabled:{type:Boolean,required:!1,default:!1},specificProps:{type:Object,required:!1,default(){return{}}}},data(){return{data:null!==this.value?[this.value]:[],options:{...this.specificProps,autocompleter:Tr}}},watch:{value(){this.data=null!==this.value?[this.value]:[]},data(){this.$emit("input",this.data.length>0?this.data[0]:null)}}},Ir=Or,Dr=Ir,jr=(s("f909"),Object(d["a"])(Dr,xr,kr,!1,null,null,null)),qr=jr.exports,Lr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"location"},[s("div",{ref:"map",staticClass:"location-map"}),e.showTutorial?s("div",{staticClass:"location-tutorial"},[s("div",{staticClass:"location-tutorialWrapper"},[s("h1",{staticClass:"location-tutorialTitle"},[e._v(e._s(e.tutorialWording.title))]),s("br"),s("p",{staticClass:"location-tutorialDescription"},[e._v(e._s(e.tutorialWording.description))]),e.showCloseTutorial?s("p",{staticClass:"location-tutorialButton"},[s("button",{staticClass:"button",on:{click:e.closeTutorial}},[e._v("J'ai compris")])]):e._e()])]):e._e()])},Fr=[],Mr=s("e11e"),Nr=s.n(Mr);s("e5e0");const zr=6,Br={coordinates:[46.7755829,2.0497727],zoom:zr};var Rr={props:{value:{type:Object,required:!1,default(){return Br}},tutorial:{type:String,required:!1,default:"auto"},autoHideMarker:{type:Boolean,required:!1,default:!1},wording:{type:Object,required:!1,default(){return{tutorialTitle:"Sélectionner une position géographique",tutorialDescription:"Positionnez le marqueur en vous déplaçant sur la carte, puis en cliquant sur la localisation désirée."}}},disabled:{type:Boolean,required:!1,default:!1}},data(){return{map:null,marker:null,clickTimeout:null,showTutorial:this.shouldShowTutorial(this.tutorial),tutorialHasBeenClosed:!1}},computed:{view(){const{lat:e,lng:t}=this.marker.getLatLng();return{coordinates:[e,t],zoom:this.map.getZoom()||zr}},tutorialWording(){return!0===this.disabled?{title:"",description:""}:{title:this.wording.tutorialTitle,description:this.wording.tutorialDescription}},showCloseTutorial(){return!this.disabled&&"auto"===this.tutorial}},watch:{value(){this.syncMap(this.value,!1)},tutorial(){this.showTutorial=this.shouldShowTutorial(this.tutorial)},showTutorial(){this.syncMarker()},autoHideMarker(){this.syncMarker()},disabled(){!0===this.disabled?this.showTutorial=!0:this.showTutorial=this.shouldShowTutorial(this.tutorial)}},mounted(){this.$nextTick(this.initialize)},methods:{initialize(){this.map=Nr.a.map(this.$refs.map),this.setTileLayers(),this.createMarker(),this.syncMap(this.value,!1)},setTileLayers(){const e={Satellite:Nr.a.tileLayer.provider("Esri.WorldImagery"),Dessin:Nr.a.tileLayer.provider("OpenStreetMap.Mapnik")};e.Dessin.addTo(this.map),Nr.a.control.layers(e).addTo(this.map)},createMarker(){this.marker=Nr.a.marker(this.value.coordinates,{draggable:!0}),this.map.addEventListener("click",e=>{clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout(this.handleClick.bind(this,e),200)}),this.map.addEventListener("dblclick",()=>{clearTimeout(this.clickTimeout),this.clickTimeout=null}),this.marker.addEventListener("dragend",()=>{this.syncMap(this.view,!0)}),this.shouldShowMarker()&&this.marker.addTo(this.map)},syncMap(e,t=!1){this.marker.setLatLng(e.coordinates),this.map.setView(e.coordinates,e.zoom),!0===t&&this.$emit("input",e),clearTimeout(this.clickTimeout),this.clickTimeout=null},handleClick({latlng:{lat:e,lng:t}}){this.marker.setLatLng([e,t]),this.syncMap(this.view,!0),this.clickTimeout=null},closeTutorial(){this.showTutorial=!1,this.tutorialHasBeenClosed=!0},shouldShowMarker(){return!1===this.autoHideMarker||!0!==this.showTutorial},syncMarker(){null!==this.marker&&(this.shouldShowMarker()?this.marker.addTo(this.map):this.marker.remove())},shouldShowTutorial(e){return"no"!==e&&("yes"===e||!this.tutorialHasBeenClosed)}}},Vr=Rr,Ur=Vr,Hr=(s("8950"),Object(d["a"])(Ur,Lr,Fr,!1,null,null,null)),Gr=Hr.exports,Wr=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Address",e._b({attrs:{disabled:e.disabled},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}},"Address",e.addressOptions,!1)),s("Location",e._b({ref:"location",attrs:{disabled:e.disabled},model:{value:e.location,callback:function(t){e.location=t},expression:"location"}},"Location",e.locationOptions,!1))],1)},Yr=[],Jr={components:{Address:qr,Location:Gr},props:{value:{type:Object,required:!1,default(){return null}},specificProps:{type:Object,required:!1,default(){return{address:{},location:{}}}},disabled:{type:Boolean,required:!1,default:!1}},data(){return{address:null!==this.value?this.value.address:void 0,location:null!==this.value?this.value.location:void 0}},computed:{addressOptions(){return{...this.specificProps.address}},locationOptions(){return{...this.specificProps.location,tutorial:this.address?"auto":"yes",autoHideMarker:!this.address,wording:this.address?{tutorialTitle:"Adresse détectée",tutorialDescription:"Vous pouvez déplacer le marqueur en cliquant à l'endroit souhaité sur la carte"}:{tutorialTitle:"Saisir une adresse",tutorialDescription:"Veuillez saisir une adresse dans le champ de texte ci-dessus avant d'accéder à la carte"}}},data(){return this.address?{address:this.address,location:this.location}:null}},watch:{value(){this.address=null!==this.value?this.value.address:void 0,this.location=null!==this.value?this.value.location:void 0},address(){if(this.address){const[e,t]=this.address.coordinates;this.location={coordinates:[t,e],zoom:15}}this.$emit("input",this.data)},location(){this.$emit("input",this.data)}}},Qr=Jr,Zr=Qr,Kr=(s("c789"),Object(d["a"])(Zr,Wr,Yr,!1,null,null,null)),Xr=Kr.exports,el=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",["loading"===e.status||null===e.status?s("div",[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),e._v(" Chargement de la liste des sites en cours... ")]):e._e(),"error"===e.status?s("div",{staticClass:"error"},[s("img",{staticClass:"spinner",attrs:{src:"/img/warning.svg",width:"20"}}),e._v(" Le chargement de la liste des sites a échoué : "+e._s(e.loadingError)+" ")]):e._e(),"loaded"===e.status?s("div",[s("p",{staticClass:"selectionInfo"},[e._v("Nombre total de sites sélectionnés : "+e._s(e.selectedTowns.length))]),s("div",{staticClass:"switch"},[s("button",{class:{active:"open"===e.statusOfVisibleTowns},on:{click:function(t){return e.showTowns("open")}}},[e._v("Sites existants")]),s("button",{class:{active:"closed"===e.statusOfVisibleTowns},on:{click:function(t){return e.showTowns("closed")}}},[e._v("Sites fermés")])]),s("CollectivityInput",{staticClass:"townList-search",model:{value:e.location,callback:function(t){e.location=t},expression:"location"}}),s("Table",{attrs:{columns:e.columns,content:e.pageContent,emptyLabel:"Aucun site"},on:{click:e.toggleTown},scopedSlots:e._u([{key:"checkbox",fn:function(t){return[s("input",{attrs:{type:"checkbox",disabled:e.disabled},domProps:{checked:e.selectedTowns.some((function(e){return e===t.row.id}))},on:{change:function(s){return e.toggleTown(t.row)}}})]}},{key:"city",fn:function(t){return[e._v(e._s(t.row.city.name))]}},{key:"address",fn:function(t){return[e._v(e._s(t.row.usename))]}},{key:"fieldType",fn:function(t){return[s("span",{staticClass:"fieldType"},[s("i",{style:"background-color: "+e.fieldTypes[t.row.fieldType.id].color}),e._v(" "),s("span",[e._v(e._s(t.row.fieldType.label))])])]}},{key:"people",fn:function(t){return[null===t.row.populationTotal?s("span",{staticClass:"secondary"},[e._v("NC")]):s("span",[e._v(e._s(t.row.populationTotal))])]}}],null,!1,2250559664)})],1):e._e()])},tl=[];function sl(e={},t=[]){const s=[];return Object.keys(e).forEach(t=>{s.push(`${t}=${encodeURIComponent(e[t])}`)}),t.length>0&&s.push("order="+t.map(e=>encodeURIComponent(e)).join(",")),bo("/towns"+(s.length>0?"?"+s.join("&"):""))}function il(e){return bo("/towns/"+e)}function al(e){const t={...e};return e.address&&(t.coordinates=e.address.location.coordinates.join(","),t.citycode=e.address.address.data.citycode,t.address=e.address.address.label),yo("/towns",t)}function nl(e,t){return yo("/towns/"+e,t)}function ol(e,t){return yo(`/towns/${e}/close`,t)}function rl(e){return Co("/towns/"+e)}function ll(e,t){return yo(`/towns/${e}/comments`,t)}function cl(e,t){return yo(`/towns/${e}/covidComments`,t)}function dl(e,t,s){return yo(`/towns/${e}/comments/${t}`,s)}function ul(e,t,s){return Co(`/towns/${e}/comments/${t}`,{message:s})}var pl=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"rb-table"},[s("aside",{staticClass:"rb-table-aside"},[e._t("aside",[s("p")]),s("div",{staticClass:"rb-pagination"},[s("span",{staticClass:"link",class:{"link--disabled":0===e.currentPage},on:{click:e.previousPage}},[s("font-awesome-icon",{attrs:{icon:"caret-square-left"}}),e._v(" Précédent")],1),s("span",{staticClass:"pagination-pages"},[e._v(e._s(e.indexOfFirstRowInCurrentPage)+" - "+e._s(e.indexOfLastRowInCurrentPage)+" sur "+e._s(e.filteredContent.length))]),s("span",{staticClass:"link",class:{"link--disabled":e.currentPage===e.indexOfLastPage},on:{click:e.nextPage}},[e._v("Suivant "),s("font-awesome-icon",{attrs:{icon:"caret-square-right"}})],1)])],2),s("table",{staticClass:"table"},[s("thead",[s("tr",e._l(e.parsedColumns,(function(t){var i;return s("th",{class:(i={"table-col--filterable":t.isFilterable,"table-col--active":[t.id].length>0},i["table-col--"+t.id]=!0,i)},[t.isFilterable?s("TableFilter",{attrs:{visible:e.currentFilter===t.id},on:{"outside-click":e.hideFilter,clean:e.hideFilter},model:{value:e.parsedFilters[t.id],callback:function(s){e.$set(e.parsedFilters,t.id,s)},expression:"parsedFilters[column.id]"}}):e._e(),t.isFilterable?s("span",{on:{click:function(s){return e.toggleFilter(t.id)}}},[e._v(e._s(t.label)+" "),e.checkedFilters[t.id].length>0?s("span",{staticClass:"badge"},[e._v(e._s(e.checkedFilters[t.id].length))]):e._e(),s("font-awesome-icon",{attrs:{icon:"sort-down",size:"2x"}})],1):s("span",[e._v(e._s(t.label))])],1)})),0)]),s("tbody",[0===e.filteredContent.length?s("tr",{staticClass:"table-row--empty"},[s("td",{attrs:{colspan:e.parsedColumns.length}},[e._v(e._s(e.emptyLabel))])]):e._e(),e._l(e.currentPageContent,(function(t,i){return s("tr",{class:i%2===0?"table-row--odd":"",on:{click:function(s){return e.click(s,t)}}},e._l(e.parsedColumns,(function(i){return s("td",{class:"table-col--"+i.id},[e._t(i.id,[s("span",{domProps:{innerHTML:e._s(t[i.id])}})],{row:t})],2)})),0)}))],2)]),s("aside",{staticClass:"rb-table-aside"},[e._t("aside",[s("p")]),s("div",{staticClass:"rb-pagination"},[s("span",{staticClass:"link",class:{"link--disabled":0===e.currentPage},on:{click:e.previousPage}},[s("font-awesome-icon",{attrs:{icon:"caret-square-left"}}),e._v(" Précédent")],1),s("span",{staticClass:"pagination-pages"},[e._v(e._s(e.indexOfFirstRowInCurrentPage)+" - "+e._s(e.indexOfLastRowInCurrentPage)+" sur "+e._s(e.filteredContent.length))]),s("span",{staticClass:"link",class:{"link--disabled":e.currentPage===e.indexOfLastPage},on:{click:e.nextPage}},[e._v("Suivant "),s("font-awesome-icon",{attrs:{icon:"caret-square-right"}})],1)])],2)])},ml=[],hl=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{ref:"container",staticClass:"tableFilter",style:{display:!0===e.visible?"block":"none"}},[s("ul",e._l(e.items,(function(t,i){return s("li",[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"item.checked"}],attrs:{type:"checkbox",id:"tableFilter-"+e.id+"-"+i},domProps:{checked:Array.isArray(t.checked)?e._i(t.checked,null)>-1:t.checked},on:{change:function(s){var i=t.checked,a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=null,r=e._i(i,o);a.checked?r<0&&e.$set(t,"checked",i.concat([o])):r>-1&&e.$set(t,"checked",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(t,"checked",n)}}}),s("label",{attrs:{for:"tableFilter-"+e.id+"-"+i}},[e._t("default",[e._v(e._s(t.label))],{item:t})],2)])})),0),s("footer",[s("span",{staticClass:"link link--secondary",on:{click:e.clean}},[e._v("Effacer")])])])},vl=[],fl={props:{value:{required:!0,type:Array},visible:{required:!1,type:Boolean,default:!1}},data(){return{items:this.value,timeout:null,id:null}},watch:{value(){this.items=this.value},items(){this.$emit("input",this.items)},visible(){!0===this.visible?this.timeout=setTimeout(()=>document.addEventListener("click",this.checkOutsideClick),500):(clearTimeout(this.timeout),document.removeEventListener("click",this.checkOutsideClick))}},mounted(){this.id=this._uid},methods:{clean(){for(let e=0;e<this.items.length;e+=1)this.items[e].checked=!1;this.$emit("clean")},checkOutsideClick(e){this.$refs.container&&this.$refs.container.contains(e.target)||this.$emit("outside-click",e)}}},_l=fl,gl=_l,bl=(s("cb23"),Object(d["a"])(gl,hl,vl,!1,null,"cdbe4124",null)),yl=bl.exports;const Cl=10;var wl={components:{TableFilter:yl},props:{columns:{type:Array,required:!0},content:{type:Array,required:!1,default(){return[]}},emptyLabel:{type:String,required:!1,default:"Aucune donnée disponible pour les filtres sélectionnés"},itemsPerPage:{type:Number,required:!1,default:Cl}},data(){return{parsedFilters:this.parseFilters(),currentFilter:null,currentPage:0}},computed:{parsedColumns(){return this.columns.map(e=>({...e,isFilterable:void 0!==e.filters}))},checkedFilters(){return Object.keys(this.parsedFilters).reduce((e,t)=>({...e,[t]:this.parsedFilters[t].filter(({checked:e})=>!0===e)}),{})},filteredContent(){return this.currentPage=0,this.content.filter(e=>this.columns.every(({id:t,filterFn:s})=>0===this.checkedFilters[t].length||s(e,this.checkedFilters[t])))},currentPageContent(){return this.filteredContent.slice(this.currentPage*this.itemsPerPage,this.currentPage*this.itemsPerPage+this.itemsPerPage)},indexOfLastPage(){return Math.max(0,Math.ceil(this.filteredContent.length/this.itemsPerPage)-1)},indexOfFirstRowInCurrentPage(){return this.filteredContent.length>0?this.currentPage*this.itemsPerPage+1:0},indexOfLastRowInCurrentPage(){return Math.min(this.indexOfFirstRowInCurrentPage+this.itemsPerPage-1,this.filteredContent.length)}},watch:{columns(){this.parsedFilters=this.parseFilters(),this.currentPage=0},content(){this.parsedFilters=this.parseFilters(),this.currentFilter=null,this.currentPage=0}},methods:{click(e,t){this.$emit("click",t,e)},parseFilters(){return this.columns.reduce((e,t)=>void 0===t.filters?{...e,[t.id]:[]}:{...e,[t.id]:t.filters.map(e=>void 0!==e.checked?e:{...e,checked:!1})},{})},toggleFilter(e){this.currentFilter===e?this.currentFilter=null:this.currentFilter=e},hideFilter(){this.currentFilter=null},previousPage(){this.currentPage=Math.max(0,this.currentPage-1)},nextPage(){this.currentPage=Math.min(this.indexOfLastPage,this.currentPage+1)}}},xl=wl,kl=xl,Pl=Object(d["a"])(kl,pl,ml,!1,null,null,null),Sl=Pl.exports,$l=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Autocompleter",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Autocompleter",e.options,!1))},Tl=[],Al={components:{Autocompleter:wr},props:{value:{type:Object,required:!1,default(){return null}},disabled:{type:Boolean,required:!1,default:!1},specificProps:{type:Object,required:!1,default(){return{}}}},data(){return{data:null!==this.value?[this.value]:[],options:{...this.specificProps,showCategory:!0,autocompleter:(...e)=>{const t=Ar(...e),s=t.then(e=>e.map(({label:e,code:t,type:s,locationType:i})=>({id:t,label:e,category:s,data:{code:t,type:i}})));return s.abort=t.abort,s}}}},watch:{value(){this.data=null!==this.value?[this.value]:[]},data(){this.$emit("input",this.data.length>0?this.data[0]:null)}}},El=Al,Ol=El,Il=(s("373f"),Object(d["a"])(Ol,$l,Tl,!1,null,null,null)),Dl=Il.exports,jl={components:{Table:Sl,CollectivityInput:Dl},props:{value:{type:Array,required:!1,default(){return[]}},disabled:{type:Boolean,required:!1,default:!1},filter:{type:Function,required:!1,default:null}},data(){const{field_types:e,user:t}=Ao(),s=Oo("shantytown.list"),i={id:"nation"===t.organization.location.type?null:t.organization.location[t.organization.location.type].code,label:"nation"===t.organization.location.type?"France":t.organization.location[t.organization.location.type].name,category:t.organization.location.type,data:{code:"nation"===t.organization.location.type?null:t.organization.location[t.organization.location.type].code,type:t.organization.location.type}},a="nation"===s.geographic_level;let n,o;return!0!==a||"nation"===t.organization.location.type?(o={...i},n=null):(o={id:null,label:"France",category:"Pays",data:{code:null,type:"nation"}},n={...i}),{location:n,defaultLocation:o,columns:[{id:"checkbox",label:""},{id:"city",label:"Commune"},{id:"address",label:"Adresse"},{id:"fieldType",label:"Type de site"},{id:"people",label:"Nombre de personnes"}],fieldTypes:e.reduce((e,t)=>({...e,[t.id]:t}),{}),status:null,loadingError:null,towns:[],selectedTowns:this.value,statusOfVisibleTowns:"open"}},computed:{currentLocation(){return this.location||this.defaultLocation},pageContent(){return this.towns.filter(({closedAt:e})=>"open"===this.statusOfVisibleTowns?null===e:null!==e).filter(e=>{if("nation"===this.currentLocation.data.type)return!0;const t=e[this.currentLocation.data.type];return t&&""+t.code===""+this.currentLocation.data.code})}},watch:{value(){this.selectedTowns=this.value},selectedTowns(){this.$emit("input",this.selectedTowns)}},mounted(){this.load()},methods:{load(){"loaded"!==this.status&&"loading"!==this.status&&(this.status="loading",this.loadingError=null,sl({},["city.asc","population.desc"]).then(e=>{this.status="loaded",this.towns=e}).catch(({user_message:e})=>{this.status="error",this.loadingError=e}))},showTowns(e){this.statusOfVisibleTowns=e},toggleTown({id:e},t){if(t&&t.target&&"checkbox"===t.target.type)return;if(this.disabled)return;const s=this.selectedTowns.findIndex(t=>t===e);-1!==s?this.selectedTowns.splice(s,1):this.selectedTowns.push(e)}}},ql=jl,Ll=ql,Fl=(s("3b5a"),Object(d["a"])(Ll,el,tl,!1,null,null,null)),Ml=Fl.exports,Nl=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"planFunding"},[s("header",{staticClass:"planFunding-header"},[s("font-awesome-icon",{staticClass:"planFunding-yearSwitch",class:{"planFunding-yearSwitch--disabled":this.focusedYear===this.minYear},attrs:{icon:"caret-square-left"},on:{click:e.showPreviousYear}}),s("span",[e._v(e._s(e.focusedYear)+" ")]),s("font-awesome-icon",{staticClass:"planFunding-yearSwitch",class:{"planFunding-yearSwitch--disabled":this.focusedYear===this.maxYear},attrs:{icon:"caret-square-right"},on:{click:e.showNextYear}})],1),s("table",{staticClass:"table"},[e._m(0),s("tbody",[e._l(e.currentFundings,(function(t,i){return s("PlanFundingRow",{key:i,attrs:{index:i,inputMode:e.inputMode,relatedYear:e.focusedYear,disabled:e.disabled},on:{onremove:function(t){return e.removeRow(i)},input:e.onRowChange},model:{value:t.data,callback:function(s){e.$set(t,"data",s)},expression:"funding.data"}})})),"default"===e.inputMode?s("tr",[s("td",{staticClass:"planFunding-addRow",class:{"planFunding-addRow--disabled":e.disabled},attrs:{colspan:"5"},on:{click:e.addRow}},[e._v("Ajouter une ligne de financement")])]):e._e()],2)])])},zl=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"planFunding-type"},[e._v("Type de financements")]),s("th",{staticClass:"planFunding-amount"},[e._v("Montants"),s("br"),e._v("Prévus")]),s("th",{staticClass:"planFunding-details"},[e._v("Précision")]),s("th",{staticClass:"planFunding-details"},[e._v("Dépenses"),s("br"),e._v("exécutées")]),s("th")])])}],Bl=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("tr",{staticClass:"planFundingRow",class:{"planFundingRow--disabled":e.disabled}},[s("td",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.type,expression:"type"}],attrs:{disabled:e.disabled||"closing"===e.inputMode||!e.allowEdition},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.type=t.target.multiple?s:s[0]}}},e._l(e.financeTypes,(function(t){return s("option",{domProps:{value:t.uid}},[e._v(e._s(t.name))])})),0)]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.amount,expression:"amount"}],attrs:{type:"text",readonly:e.disabled||"closing"===e.inputMode||!e.allowEdition,disabled:e.disabled||"closing"===e.inputMode||!e.allowEdition},domProps:{value:e.amount},on:{input:function(t){t.target.composing||(e.amount=t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.details,expression:"details"}],attrs:{type:"text",readonly:e.disabled||"closing"===e.inputMode||!e.allowEdition,disabled:e.disabled||"closing"===e.inputMode||!e.allowEdition},domProps:{value:e.details},on:{input:function(t){t.target.composing||(e.details=t.target.value)}}})]),e.showRealAmount?s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.realAmount,expression:"realAmount"}],attrs:{type:"text",readonly:e.disabled||!e.allowEdition,disabled:e.disabled||!e.allowEdition},domProps:{value:e.realAmount},on:{input:function(t){t.target.composing||(e.realAmount=t.target.value)}}})]):s("td",[0===e.index?s("span",[e._v("À remplir entre janvier et mars de l'année prochaine")]):e._e()]),s("td",[s("img",{attrs:{src:"/img/remove.svg"},on:{click:e.remove}})])])},Rl=[],Vl={props:{value:{type:Object,required:!1,default(){return{type:null,amount:0,realAmount:null,details:""}}},disabled:{type:Boolean,required:!1,default:!1},index:{type:Number,required:!0},relatedYear:{type:Number,required:!0},inputMode:{type:String,required:!1,default:"default"}},data(){const e="default"!==this.inputMode||!this.isCurrentYear(),t=!Number.isFinite(this.value.realAmount);return{financeTypes:Ao().finance_types||[],showRealAmount:e,allowEdition:t,type:this.value.type,amount:this.value.amount,realAmount:e?this.value.realAmount:null,details:this.value.details}},watch:{value(){this.showRealAmount="default"!==this.inputMode||!this.isCurrentYear(),this.allowEdition=!Number.isFinite(this.value.realAmount),this.type=this.value.type,this.amount=this.value.amount,this.realAmount=this.showRealAmount?this.value.realAmount:null,this.details=this.value.details},type(){this.emitInput()},amount(){this.emitInput()},realAmount(){this.emitInput()},details(){this.emitInput()}},methods:{isCurrentYear(){return(new Date).getFullYear()===this.relatedYear},emitInput(){this.$emit("input",{type:this.type,amount:this.amount,realAmount:this.realAmount,details:this.details})},remove(){this.$emit("onremove")}}},Ul=Vl,Hl=Ul,Gl=(s("5449"),Object(d["a"])(Hl,Bl,Rl,!1,null,null,null)),Wl=Gl.exports,Yl={components:{PlanFundingRow:Wl},props:{value:{type:Array,required:!1,default(){return[]}},disabled:{type:Boolean,required:!1,default:!1},minYear:{type:Number,required:!1,default:null},inputMode:{type:String,required:!1,default:"default"}},data(){return{maxYear:(new Date).getFullYear(),focusedYear:(new Date).getFullYear(),fundings:this.value.map(({year:e,data:t})=>({year:e,data:t.map(e=>({data:e}))}))}},computed:{allowRealAmount(){return"closing"===this.inputMode||this.focusedYear<(new Date).getFullYear()},currentFundings(){const e=this.getCurrentFundings();return void 0===e?[]:e.data}},watch:{value(){this.fundings=this.value.map(({year:e,data:t})=>({year:e,data:t.map(e=>({data:e}))}))}},methods:{getCurrentFundings(){return this.fundings.find(({year:e})=>e===this.focusedYear)},addRow(){if(this.disabled)return;let e=this.getCurrentFundings();void 0===e&&(e={year:this.focusedYear,data:[]},this.fundings.push(e)),e.data.push({data:{type:null,amount:0,realAmount:null,details:""}}),this.emitInput()},removeRow(e){if(this.disabled)return;const t=this.getCurrentFundings();void 0!==t&&(t.data.splice(e,1),this.emitInput())},onRowChange(){this.emitInput()},emitInput(){this.$emit("input",this.fundings.map(({year:e,data:t})=>({year:e,data:t.map(({data:e})=>e)})))},showNextYear(){this.focusedYear=Math.min(this.maxYear,this.focusedYear+1)},showPreviousYear(){null===this.minYear?this.focusedYear-=1:this.focusedYear=Math.max(this.minYear,this.focusedYear-1)}}},Jl=Yl,Ql=Jl,Zl=(s("30c2"),Object(d["a"])(Ql,Nl,zl,!1,null,null,null)),Kl=Zl.exports,Xl=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"rb-table"},[s("table",{staticClass:"table"},[e._m(0),s("tbody",[s("tr",[s("th",[e._v("SIAO")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.siao.families,expression:"data.siao.families"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.siao.families},on:{input:function(t){t.target.composing||e.$set(e.data.siao,"families",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.siao.people,expression:"data.siao.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.siao.people},on:{input:function(t){t.target.composing||e.$set(e.data.siao,"people",t.target.value)}}})])]),s("tr",[s("th",[e._v("Logement social")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.logement_social.families,expression:"data.logement_social.families"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.logement_social.families},on:{input:function(t){t.target.composing||e.$set(e.data.logement_social,"families",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.logement_social.people,expression:"data.logement_social.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.logement_social.people},on:{input:function(t){t.target.composing||e.$set(e.data.logement_social,"people",t.target.value)}}})])]),s("tr",[s("th",[e._v("DALO")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.dalo.families,expression:"data.dalo.families"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.dalo.families},on:{input:function(t){t.target.composing||e.$set(e.data.dalo,"families",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.dalo.people,expression:"data.dalo.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.dalo.people},on:{input:function(t){t.target.composing||e.$set(e.data.dalo,"people",t.target.value)}}})])])])]),s("table",{staticClass:"table"},[e._m(1),s("tbody",[s("tr",[s("th",[e._v("Logement accompagné / adapté")]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.accompagnes.families,expression:"data.accompagnes.families"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.accompagnes.families},on:{input:function(t){t.target.composing||e.$set(e.data.accompagnes,"families",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.accompagnes.people,expression:"data.accompagnes.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.accompagnes.people},on:{input:function(t){t.target.composing||e.$set(e.data.accompagnes,"people",t.target.value)}}})])]),s("tr",[e._m(2),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.non_accompagnes.families,expression:"data.non_accompagnes.families"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.non_accompagnes.families},on:{input:function(t){t.target.composing||e.$set(e.data.non_accompagnes,"families",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.non_accompagnes.people,expression:"data.non_accompagnes.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.non_accompagnes.people},on:{input:function(t){t.target.composing||e.$set(e.data.non_accompagnes,"people",t.target.value)}}})])]),s("tr",[e._m(3),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.heberges.families,expression:"data.heberges.families"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.heberges.families},on:{input:function(t){t.target.composing||e.$set(e.data.heberges,"families",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.heberges.people,expression:"data.heberges.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.heberges.people},on:{input:function(t){t.target.composing||e.$set(e.data.heberges,"people",t.target.value)}}})])])])])])},ec=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",[e._v("Demandes de logement")]),s("th",[e._v("Ménages")]),s("th",[e._v("Personnes")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",[e._v("Accès à un logement ou hébergement")]),s("th",[e._v("Ménages")]),s("th",[e._v("Personnes")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",[e._v(" Logement sans accompagnement "),s("br"),s("span",[e._v("(social ou privé)")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",[e._v(" Hébergement "),s("span",[e._v("(hors mise à l'abri ou hébergement d'urgence)")])])}],tc={props:{value:{type:Object,required:!1,default(){return{siao:{people:"",families:""},logement_social:{people:"",families:""},dalo:{people:"",families:""},accompagnes:{people:"",families:""},non_accompagnes:{people:"",families:""},heberges:{people:"",families:""}}}},disabled:{type:Boolean,required:!1,default:!1}},data(){return{data:this.value}},watch:{data:{handler(){this.emitInput()},deep:!0}},mounted(){this.emitInput()},methods:{emitInput(){this.$emit("input",this.data)}}},sc=tc,ic=(s("e1d3"),Object(d["a"])(sc,Xl,ec,!1,null,"0c9f54ed",null)),ac=ic.exports,nc=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Autocompleter",e._b({attrs:{disabled:e.disabled},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Autocompleter",e.options,!1))},oc=[],rc={components:{Autocompleter:wr},props:{value:{type:Object,required:!1,default(){return null}},disabled:{type:Boolean,required:!1,default:!1},specificProps:{type:Object,required:!1,default(){return{}}}},data(){return{data:null!==this.value?[this.value]:[],options:{...this.specificProps,showCategory:!0,autocompleter:(...e)=>{const t=sr(...e),s=t.then(e=>e.map(e=>({id:e.id,label:e.label,category:e.type.label,data:e})));return s.abort=t.abort,s}}}},watch:{value(){this.data=null!==this.value?[this.value]:[]},data(){this.$emit("input",this.data.length>0?this.data[0]:null)}}},lc=rc,cc=lc,dc=Object(d["a"])(cc,nc,oc,!1,null,null,null),uc=dc.exports,pc=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[e._l(e.rows,(function(t,i){return e.rows.length>0?s("p",{staticClass:"etp-row dataSection-line"},[s("select",{directives:[{name:"model",rawName:"v-model",value:t.type,expression:"row.type"}],staticClass:"etp-type",attrs:{disabled:e.disabled},on:{change:function(s){var i=Array.prototype.filter.call(s.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(t,"type",s.target.multiple?i:i[0])}}},e._l(e.types,(function(t){return s("option",{domProps:{value:t.uid}},[e._v(e._s(t.name))])})),0),s("input",{directives:[{name:"model",rawName:"v-model",value:t.total,expression:"row.total"}],staticClass:"etp-total",attrs:{type:"number",disabled:e.disabled,step:"0.1"},domProps:{value:t.total},on:{input:function(s){s.target.composing||e.$set(t,"total",s.target.value)}}}),e._v(" ETP "),s("font-awesome-icon",{staticClass:"etp-removeButton",attrs:{icon:"trash-alt"},on:{click:function(t){return e.removeRow(i)}}})],1):e._e()})),0===e.rows.length?s("p",[e._v("Aucun ETP enregistré pour le moment")]):e._e(),s("p",{staticClass:"etp-addButton",on:{click:e.addRow}},[s("font-awesome-icon",{attrs:{icon:"plus-circle"}}),s("span",[e._v("Ajouter")])],1)],2)},mc=[],hc={props:{value:{type:Array,required:!1,default(){return[]}},disabled:{type:Boolean,required:!1,default:!1}},data(){const{etp_types:e}=Ao();return{rows:this.value,types:e}},computed:{parsedRows(){return this.rows.map(e=>({type:e.type?e.type:null,total:parseFloat(e.total)}))}},watch:{parsedRows(){this.emitInput()}},methods:{addRow(){this.disabled||(this.rows.push({type:void 0,total:0}),this.emitInput())},removeRow(e){this.disabled||e>=this.rows.length||(this.rows.splice(e,1),this.emitInput())},emitInput(){this.$emit("input",this.parsedRows)}}},vc=hc,fc=vc,_c=(s("d416"),Object(d["a"])(fc,pc,mc,!1,null,null,null)),gc=_c.exports,bc=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"rb-table"},[s("table",{staticClass:"table"},[e._m(0),s("tbody",[e.outOnly?e._e():s("tr",[e.inOnly?e._e():s("td",[s("strong",[e._v("Entrées")]),e._v(" dans le dispositif")]),e.inOnly?s("td",[e._v("Publics intégrés au dispositif")]):e._e(),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.in.households,expression:"data.in.households"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.in.households},on:{input:function(t){t.target.composing||e.$set(e.data.in,"households",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.in.people,expression:"data.in.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.in.people},on:{input:function(t){t.target.composing||e.$set(e.data.in,"people",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.in.women,expression:"data.in.women"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.in.women},on:{input:function(t){t.target.composing||e.$set(e.data.in,"women",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.in.minors,expression:"data.in.minors"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.in.minors},on:{input:function(t){t.target.composing||e.$set(e.data.in,"minors",t.target.value)}}})])]),e.inOnly?e._e():s("tr",[e._m(1),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_positive.households,expression:"data.out_positive.households"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_positive.households},on:{input:function(t){t.target.composing||e.$set(e.data.out_positive,"households",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_positive.people,expression:"data.out_positive.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_positive.people},on:{input:function(t){t.target.composing||e.$set(e.data.out_positive,"people",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_positive.women,expression:"data.out_positive.women"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_positive.women},on:{input:function(t){t.target.composing||e.$set(e.data.out_positive,"women",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_positive.minors,expression:"data.out_positive.minors"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_positive.minors},on:{input:function(t){t.target.composing||e.$set(e.data.out_positive,"minors",t.target.value)}}})])]),e.inOnly?e._e():s("tr",[e._m(2),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_abandoned.households,expression:"data.out_abandoned.households"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_abandoned.households},on:{input:function(t){t.target.composing||e.$set(e.data.out_abandoned,"households",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_abandoned.people,expression:"data.out_abandoned.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_abandoned.people},on:{input:function(t){t.target.composing||e.$set(e.data.out_abandoned,"people",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_abandoned.women,expression:"data.out_abandoned.women"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_abandoned.women},on:{input:function(t){t.target.composing||e.$set(e.data.out_abandoned,"women",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_abandoned.minors,expression:"data.out_abandoned.minors"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_abandoned.minors},on:{input:function(t){t.target.composing||e.$set(e.data.out_abandoned,"minors",t.target.value)}}})])]),e.inOnly?e._e():s("tr",[e._m(3),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_excluded.households,expression:"data.out_excluded.households"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_excluded.households},on:{input:function(t){t.target.composing||e.$set(e.data.out_excluded,"households",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_excluded.people,expression:"data.out_excluded.people"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_excluded.people},on:{input:function(t){t.target.composing||e.$set(e.data.out_excluded,"people",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_excluded.women,expression:"data.out_excluded.women"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_excluded.women},on:{input:function(t){t.target.composing||e.$set(e.data.out_excluded,"women",t.target.value)}}})]),s("td",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data.out_excluded.minors,expression:"data.out_excluded.minors"}],attrs:{type:"number",disabled:e.disabled},domProps:{value:e.data.out_excluded.minors},on:{input:function(t){t.target.composing||e.$set(e.data.out_excluded,"minors",t.target.value)}}})])])])])])},yc=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"table-col"}),s("th",{staticClass:"table-col"},[e._v("Ménages")]),s("th",{staticClass:"table-col"},[e._v("Personnes")]),s("th",{staticClass:"table-col"},[e._v("dont femmes"),s("br"),e._v("(facultatif)")]),s("th",{staticClass:"table-col"},[e._v("dont mineurs"),s("br"),e._v("(facultatif)")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Sorties positivement")]),s("br"),e._v("fin accompagnement social et/ou"),s("br"),e._v("prise en charge dans un autre dispositif")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Exclusion")]),e._v(" du dispositif")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Abandon / départ volontaire")])])}],Cc={props:{value:{type:Object,required:!1,default(){return{in:{households:0,people:0,women:0,minors:0},out_positive:{households:0,people:0,women:0,minors:0},out_abandoned:{households:0,people:0,women:0,minors:0},out_excluded:{households:0,people:0,women:0,minors:0}}}},inOnly:{type:Boolean,required:!1,default:!1},outOnly:{type:Boolean,required:!1,default:!1},disabled:{type:Boolean,required:!1,default:!1}},data(){return{data:this.value}},watch:{"data.in.households"(){this.emitInput()},"data.in.people"(){this.emitInput()},"data.in.women"(){this.emitInput()},"data.in.minors"(){this.emitInput()},"data.out_positive.households"(){this.emitInput()},"data.out_positive.people"(){this.emitInput()},"data.out_positive.women"(){this.emitInput()},"data.out_positive.minors"(){this.emitInput()},"data.out_abandoned.households"(){this.emitInput()},"data.out_abandoned.people"(){this.emitInput()},"data.out_abandoned.women"(){this.emitInput()},"data.out_abandoned.minors"(){this.emitInput()},"data.out_excluded.households"(){this.emitInput()},"data.out_excluded.people"(){this.emitInput()},"data.out_excluded.women"(){this.emitInput()},"data.out_excluded.minors"(){this.emitInput()}},mounted(){this.emitInput()},methods:{emitInput(){this.$emit("input",this.data)}}},wc=Cc,xc=wc,kc=(s("2283"),Object(d["a"])(xc,bc,yc,!1,null,null,null)),Pc=kc.exports;const Sc=["selectMultiple","checkbox","autocompleter","townList","planFunding","etp"];var $c={components:{Datepicker:hr["default"],Autocompleter:wr,Address:qr,Location:Gr,AddressWithLocation:Xr,TownList:Ml,PlanFunding:Kl,Collectivity:Dl,Organization:uc,Etp:gc,Audience:Pc,PlanHousing:ac},props:{id:{type:String,required:!0},mandatory:{type:Boolean,required:!0},type:{type:String,required:!1,default:"text"},label:{type:String,required:!0},description:{type:String,required:!1},options:{type:Array,required:!1,default(){return[]}},specificProps:{type:Object,required:!1,default(){return{}}},value:{required:!1,default(){if(-1!==Sc.indexOf(this.type))return[]}},disabled:{type:Boolean,required:!1,default:!1},errors:{type:Array,required:!1,default(){return[]}},alertMessage:{type:String,required:!1,default:null}},data(){return{data:this.value,showPassword:!1}},computed:{props(){let e={};return"date"===this.type&&(e={language:Ws["fr"],mondayFirst:!0,fullMonthName:!0,format:"dd MMMM yyyy",calendarButton:!0,calendarButtonIconContent:"",clearButton:!0}),Object.assign(e,this.specificProps)},optionsAreGrouped(){return this.options&&Object.prototype.hasOwnProperty.call(this.options[0],"options")}},mounted(){this.$nextTick(()=>{this.$emit("input",this.data)})},watch:{value(){this.data=this.value},data(){this.$emit("input",this.data),this.$emit("change")},options(){Array.isArray(this.data)?this.data=this.data.filter(e=>-1!==this.options.indexOf(e)):-1===this.options.indexOf(this.data)&&(this.data=void 0)}}},Tc=$c,Ac=Tc,Ec=(s("8aa6"),Object(d["a"])(Ac,pr,mr,!1,null,null,null)),Oc=Ec.exports,Ic=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{slideNote:!0,"slideNote--visible":e.visible}},[s("header",{staticClass:"slideNote-header"},[s("h1",{staticClass:"slideNote-title"},[s("font-awesome-icon",{attrs:{icon:e.iconName}}),e._v(" "+e._s(e.title))],1),s("span",{staticClass:"slideNote-toggle",on:{click:e.toggle}},[s("font-awesome-icon",{attrs:{icon:e.caret,size:"2x"}})],1)]),s("div",{ref:"body",staticClass:"slideNote-body"},[e._t("content",[s("p",{ref:"content",staticClass:"slideNote-content",domProps:{innerHTML:e._s(e.content)}})])],2)])},Dc=[],jc={props:{title:{required:!0,type:String},content:{required:!1,type:String},opened:{required:!1,type:Boolean,default:!0},icon:{required:!1,type:String,default:"info-circle"}},data(){return{iconName:this.icon,maxHeight:null,visible:!1!==this.opened}},computed:{caret(){return"caret-"+(!0===this.visible?"up":"down")}},mounted(){this.maxHeight=this.$refs.body.offsetHeight,this.refreshHeight()},methods:{toggle(){this.visible=!this.visible,this.refreshHeight()},refreshHeight(){!0===this.visible?this.$refs.body.style.maxHeight=this.maxHeight+"px":this.$refs.body.style.maxHeight="0"}}},qc=jc,Lc=qc,Fc=(s("2d21"),Object(d["a"])(Lc,Ic,Dc,!1,null,"569f8548",null)),Mc=Fc.exports;const Nc=6e3;function zc(e){return i["default"].notify(Object.prototype.hasOwnProperty.call(e,"duration")?e:{...e,duration:Nc})}var Bc={components:{Input:Oc,SlideNote:Mc},props:{title:{type:String,required:!1},descriptionTitle:{type:String,required:!1},description:{type:String,required:!1},steps:{type:Array,required:!0},value:{type:Object,required:!1,default(){return{}}}},data(){return{refreshId:0,currentStepIndex:0,data:this.value,pending:!1,errors:null,responses:[]}},computed:{breadcrumbItems(){return this.steps.reduce((e,t,s)=>[...e,{...t,classNames:{"form-breadcrumbItem":!0,"form-breadcrumbItem--current":s===this.currentStepIndex,"form-breadcrumbItem--done":s<this.currentStepIndex},isSeparator:!1,stepIndex:s},{classNames:{"form-breadcrumbSeparator":!0},isSeparator:!0}],[]).slice(0,-1)},currentStep(){return this.steps[this.currentStepIndex]||null},sections(){return this.currentStep?this.currentStep.sections:[]},fullSections(){return this.sections.filter(({inputs:e})=>Object.values(e).some(e=>this.isInputVisible(e)))},inputs(){return this.currentStep.sections.reduce((e,t)=>({...e,...t.inputs}),{})},wording(){return{submit:"Étape suivante",error:"Certaines données saisies sont incorrectes",success:null,...this.currentStep.wording||{}}},filteredData(){const e=Object.keys(this.inputs);return e.filter(e=>this.isInputActive(this.inputs[e])).reduce((e,t)=>({...e,[t]:this.data[t]}),{})},filteredErrors(){return this.errors?Object.keys(this.errors.fields||{}).filter(e=>void 0!==this.inputs[e]).reduce((e,t)=>({...e,[t]:this.errors.fields[t]}),{}):null},numberOfFilteredErrors(){return this.filteredErrors?Object.keys(this.filteredErrors).length:0},submitPrefix(){return this.currentStep&&this.currentStep.submitPrefix}},watch:{value(){this.data=this.value},data(){this.onDataChange()}},methods:{submit(){this.currentStep.submit?!0!==this.pending&&(this.pending=!0,this.errors=null,this.currentStep.submit(this.filteredData,this.responses).then(e=>{null!==this.wording.success&&zc({group:"notifications",type:"success",title:"Succès",text:this.wording.success}),this.$emit("stepcomplete",this.currentStepIndex,e),this.goToNextStep(e),this.pending=!1,this.errors=null}).catch(e=>{this.pending=!1,this.errors={main:e&&e.user_message||"erreur inconnue",fields:e&&e.fields||{}}})):this.goToNextStep(null)},goToNextStep(e){this.responses.push(e),this.currentStepIndex>=this.steps.length-1?this.$emit("complete",e,this.responses):this.currentStepIndex+=1},getInputById(e){return null===this.currentStep?null:this.inputs[e]||null},onDataChange(){this.refreshId+=1,this.$emit("input",this.data)},isInputActive(e){return!e.condition||e.condition(this.data)},isInputVisible(e){return this.isInputActive(e)||e.inactiveMessage},isInputDisabled(e){return!0===this.pending||!0===e.disabled||e.inactiveMessage&&!this.isInputActive(e)},getInputAlert(e){return e.inactiveMessage&&!this.isInputActive(e)?e.inactiveMessage:null}}},Rc=Bc,Vc=Rc,Uc=(s("f6ce"),Object(d["a"])(Vc,dr,ur,!1,null,null,null)),Hc=Uc.exports,Gc={components:{NavBar:cr,Form:Hc},data(){return{formData:{},formDefinition:{title:"Connexion à la plateforme",steps:[{sections:[{inputs:{email:{type:"text",label:"Votre courriel",mandatory:!0},password:{type:"password",label:"Votre mot de passe",mandatory:!0}}}],wording:{submit:"Me connecter",succes:"Vous êtes désormais connecté",error:"La tentative de connexion a échoué"},submitPrefix:'<a href="/app.html#/nouveau-mot-de-passe">J\'ai perdu mon mot de passe</a>',submit:({email:e,password:t})=>qo(e,t)}]}}},methods:{onComplete(){window.localStorage.setItem("logged_once",!0),this.$router.push({path:"/"})}}},Wc=Gc,Yc=Wc,Jc=(s("f276"),Object(d["a"])(Yc,ro,lo,!1,null,null,null)),Qc=Jc.exports,Zc=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("PublicLayout",{staticClass:"contact",attrs:{stickyHeader:!1,displayLanguagePicker:!0}},[s("div",{staticClass:"bg-corail full-width text-center py-8"},[s("div",{staticClass:"max-w-3xl mx-auto"},[s("h1",{staticClass:"text-display-lg  text-white "},[e._v(" "+e._s(e.$t("contactPage.title"))+" ")])])]),s("PublicContainer",{staticClass:"py-16"},[s("div",{staticClass:"max-w-xl mx-auto"},[s("h2",{staticClass:"text-display-lg mb-4"},[e._v(" "+e._s(e.$t("contactPage.contactUs"))+" ")]),s("ValidationObserver",{ref:"form",scopedSlots:e._u([{key:"default",fn:function(t){var i=t.handleSubmit,a=t.errors;return[s("form",{staticClass:"max-w-xl mt-12",on:{submit:function(t){return t.preventDefault(),i(e.submitForm)}}},[s("InputGroup",[s("TextInput",{attrs:{label:e.$t("contactPage.email"),id:"email",validationName:"Email",rules:"required|email"},model:{value:e.commonFields.email,callback:function(t){e.$set(e.commonFields,"email",t)},expression:"commonFields.email"}}),s("TextInput",{attrs:{label:e.$t("contactPage.firstname"),id:"first_name",name:"Prénom",rules:"required"},model:{value:e.commonFields.first_name,callback:function(t){e.$set(e.commonFields,"first_name",t)},expression:"commonFields.first_name"}}),s("TextInput",{attrs:{label:e.$t("contactPage.lastname"),id:"last_name",name:"Nom de famille",rules:"required"},model:{value:e.commonFields.last_name,callback:function(t){e.$set(e.commonFields,"last_name",t)},expression:"commonFields.last_name"}})],1),s("CheckableGroup",{attrs:{title:e.$t("contactPage.requestType"),name:e.$t("contactPage.requestType"),id:"request_type",direction:"row"}},[s("Checkbox",{attrs:{checkValue:"help",label:e.$t("contactPage.help"),variant:"card"},model:{value:e.commonFields.request_type,callback:function(t){e.$set(e.commonFields,"request_type",t)},expression:"commonFields.request_type"}}),s("Checkbox",{attrs:{checkValue:"report",label:e.$t("contactPage.report"),variant:"card"},model:{value:e.commonFields.request_type,callback:function(t){e.$set(e.commonFields,"request_type",t)},expression:"commonFields.request_type"}}),s("Checkbox",{attrs:{checkValue:"help-request",label:e.$t("contactPage.requestHelp"),variant:"card"},model:{value:e.commonFields.request_type,callback:function(t){e.$set(e.commonFields,"request_type",t)},expression:"commonFields.request_type"}}),s("Checkbox",{attrs:{checkValue:"info-request",label:e.$t("contactPage.requestInfo"),variant:"card"},model:{value:e.commonFields.request_type,callback:function(t){e.$set(e.commonFields,"request_type",t)},expression:"commonFields.request_type"}}),s("Checkbox",{attrs:{checkValue:"access-request",label:e.$t("contactPage.requestAccess"),variant:"card"},model:{value:e.commonFields.request_type,callback:function(t){e.$set(e.commonFields,"request_type",t)},expression:"commonFields.request_type"}})],1),e.isRequestAccess?s("CheckableGroup",{attrs:{title:e.$t("contactPage.isActor"),info:e.$t("contactPage.actorExample"),rules:"required",id:"access_request",direction:"row"}},[s("Radio",{attrs:{checkValue:!0,label:e.$t("contactPage.yes"),variant:"card"},model:{value:e.commonFields.is_actor,callback:function(t){e.$set(e.commonFields,"is_actor",t)},expression:"commonFields.is_actor"}}),s("Radio",{attrs:{checkValue:!1,label:e.$t("contactPage.no"),variant:"card"},model:{value:e.commonFields.is_actor,callback:function(t){e.$set(e.commonFields,"is_actor",t)},expression:"commonFields.is_actor"}})],1):e._e(),e.isRequestAccessAndActor?s("CheckableGroup",{attrs:{title:e.$t("contactPage.whichEstablishment"),rules:"required",id:"is_actor"}},[s("Radio",{attrs:{checkValue:"public_establishment",label:e.$t("contactPage.public"),variant:"card"},model:{value:e.requestAccessFields.organization_category,callback:function(t){e.$set(e.requestAccessFields,"organization_category",t)},expression:"\n                                requestAccessFields.organization_category\n                            "}}),s("Radio",{attrs:{checkValue:"territorial_collectivity",label:e.$t("contactPage.territorialCollectivity"),variant:"card"},model:{value:e.requestAccessFields.organization_category,callback:function(t){e.$set(e.requestAccessFields,"organization_category",t)},expression:"\n                                requestAccessFields.organization_category\n                            "}}),s("Radio",{attrs:{checkValue:"association",label:e.$t("contactPage.association"),variant:"card"},model:{value:e.requestAccessFields.organization_category,callback:function(t){e.$set(e.requestAccessFields,"organization_category",t)},expression:"\n                                requestAccessFields.organization_category\n                            "}}),s("Radio",{attrs:{checkValue:"administration",label:e.$t("contactPage.administration"),variant:"card"},model:{value:e.requestAccessFields.organization_category,callback:function(t){e.$set(e.requestAccessFields,"organization_category",t)},expression:"\n                                requestAccessFields.organization_category\n                            "}})],1):e._e(),e.isPublicEstablishmentRequest?s("PublicEstablishmentForm",{attrs:{organizationType:e.publicEstablishmentFields.organization_type,organizationTerritory:e.publicEstablishmentFields.organization_public,organizationFunction:e.requestAccessFields.position},on:{"update:organizationType":function(t){return e.$set(e.publicEstablishmentFields,"organization_type",t)},"update:organization-type":function(t){return e.$set(e.publicEstablishmentFields,"organization_type",t)},"update:organizationTerritory":function(t){return e.$set(e.publicEstablishmentFields,"organization_public",t)},"update:organization-territory":function(t){return e.$set(e.publicEstablishmentFields,"organization_public",t)},"update:organizationFunction":function(t){return e.$set(e.requestAccessFields,"position",t)},"update:organization-function":function(t){return e.$set(e.requestAccessFields,"position",t)}}}):e._e(),e.isTerritorialCollectivityRequest?s("TerritorialCollectivityForm",{attrs:{collectivityName:e.territorialCollectivityFields.territorial_collectivity,collectivityFunction:e.requestAccessFields.position},on:{"update:collectivityName":function(t){return e.$set(e.territorialCollectivityFields,"territorial_collectivity",t)},"update:collectivity-name":function(t){return e.$set(e.territorialCollectivityFields,"territorial_collectivity",t)},"update:collectivityFunction":function(t){return e.$set(e.requestAccessFields,"position",t)},"update:collectivity-function":function(t){return e.$set(e.requestAccessFields,"position",t)}}}):e._e(),e.isAssociationRequest?s("AssociationForm",{attrs:{associationName:e.associationFields.association,associationTerritory:e.associationFields.departement,associationFunction:e.associationFields.position,newAssociationName:e.associationFields.new_association_name,newAssociationAcronym:e.associationFields.new_association_abbreviation},on:{"update:associationName":function(t){return e.$set(e.associationFields,"association",t)},"update:association-name":function(t){return e.$set(e.associationFields,"association",t)},"update:associationTerritory":function(t){return e.$set(e.associationFields,"departement",t)},"update:association-territory":function(t){return e.$set(e.associationFields,"departement",t)},"update:associationFunction":function(t){return e.$set(e.associationFields,"position",t)},"update:association-function":function(t){return e.$set(e.associationFields,"position",t)},"update:newAssociationName":function(t){return e.$set(e.associationFields,"new_association_name",t)},"update:new-association-name":function(t){return e.$set(e.associationFields,"new_association_name",t)},"update:newAssociationAcronym":function(t){return e.$set(e.associationFields,"new_association_abbreviation",t)},"update:new-association-acronym":function(t){return e.$set(e.associationFields,"new_association_abbreviation",t)}}}):e._e(),e.isAdministrationRequest?s("AdministrationForm",{attrs:{administrationName:e.administrationFields.organization_administration,administrationFunction:e.requestAccessFields.position},on:{"update:administrationName":function(t){return e.$set(e.administrationFields,"organization_administration",t)},"update:administration-name":function(t){return e.$set(e.administrationFields,"organization_administration",t)},"update:administrationFunction":function(t){return e.$set(e.requestAccessFields,"position",t)},"update:administration-function":function(t){return e.$set(e.requestAccessFields,"position",t)}}}):e._e(),s("TextArea",{attrs:{rows:8,label:e.$t("contactPage.message"),id:"access_request_message"},model:{value:e.commonFields.access_request_message,callback:function(t){e.$set(e.commonFields,"access_request_message",t)},expression:"commonFields.access_request_message"}}),e._v(" "),s("CheckableGroup",{attrs:{validationName:"Accord",rules:"required",id:"legal"}},[s("Checkbox",{attrs:{checkValue:"confirm",label:e.$t("contactPage.legal")},model:{value:e.commonFields.legal,callback:function(t){e.$set(e.commonFields,"legal",t)},expression:"commonFields.legal"}})],1),Object.values(a).filter((function(e){return e.length})).length?s("div",{staticClass:"bg-red-200 p-3 mb-8"},[e._v(" "+e._s(e.$t("contactPage.error"))+" "),s("ul",{staticClass:"mt-4"},e._l(a,(function(t,i){return s("li",{directives:[{name:"show",rawName:"v-show",value:t.length,expression:"error.length"}],key:i},[s("router-link",{staticClass:"link",attrs:{to:{hash:i}}},[e._v(e._s(t[0]))])],1)})),0)]):e._e(),s("div",{staticClass:"flex justify-between mt-8"},[s("router-link",{attrs:{to:"/"}},[s("Button",{attrs:{variant:"primaryText"}},[e._v(e._s(e.$t("contactPage.cancel")))])],1),s("Button",{attrs:{type:"submit",variant:"primary",loading:e.loading}},[e._v(e._s(e.$t("contactPage.send")))])],1)],1)]}}])}),s("div",{staticClass:"text-display-md mt-32 mb-2"},[e._v(" "+e._s(e.$t("contactPage.share"))+" ")]),s("SocialShare",{staticClass:"mb-8"})],1)])],1)},Kc=[];function Xc(e){return yo("/contact",e)}var ed=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Select",{attrs:{label:"Précisez le type de structure",value:e.organizationType,rules:"required",id:"organization_type"},on:{input:function(t){return e.$emit("update:organizationType",t)}}},[s("SelectOption",{attrs:{value:"none"}},[e._v("- Selectionner un choix -")]),e._l(e.orgTypesOptions,(function(t){return s("SelectOption",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],2),s("Select",{attrs:{label:"Territoire de rattachement",value:e.organizationTerritory,rules:"required",id:"organization_public"},on:{input:function(t){return e.$emit("update:organizationTerritory",t)}}},[s("SelectOption",[e._v("- Selectionner un choix -")]),e._l(e.orgTerritoryOptions,(function(t){return s("SelectOption",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])}))],2),s("TextInput",{attrs:{label:"Votre fonction",value:e.organizationFunction,rules:"required",id:"position"},on:{input:function(t){return e.$emit("update:organizationFunction",t)}}})],1)},td=[];function sd(){return bo("/organization-categories")}function id(e){return bo(`/organization-categories/${e}/organization-types`)}function ad(e,t=null){return bo(`/organization-categories/${e}/organizations${null!==t?"?search="+t:""}`)}function nd(e){return bo(`/organization-types/${e}/organizations`)}function od(e){return bo(`/organizations/${e}/users`)}function rd(e,t,s){let i="";return void 0!==s?i="departementId="+encodeURIComponent(s):void 0!==t&&(i="regionId="+encodeURIComponent(t)),bo(`/organization-categories/${e}/users?${i}`)}var ld={props:{organizationType:{required:!0},organizationTerritory:{required:!0},organizationFunction:{required:!0}},data(){return{orgTypesOptions:[],orgTerritoryOptions:[]}},async mounted(){const{types:e}=await id("public_establishment");this.orgTypesOptions=e.filter(({numberOfOrganizations:e})=>e>0).filter(({name_singular:e})=>"Gendarmerie nationale"!==e).map(({id:e,name_singular:t,abbreviation:s})=>({value:e,label:s||t}))},watch:{async organizationType(e){if("none"===e)return void(this.orgTerritoryOptions=[]);const{organizations:t}=await nd(e);this.orgTerritoryOptions=t.map(e=>{const t=e.location_type;let s=e[t+"_name"];return"nation"===t?s="France":"departement"===t&&(s=`${e[t+"_code"]} - ${e[t+"_name"]}`),{value:e.id,label:s}})}}},cd=ld,dd=Object(d["a"])(cd,ed,td,!1,null,null,null),ud=dd.exports,pd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("InputWrapper",[s("InputLabel",{attrs:{label:"Nom de la structure"}}),s("ValidationProvider",{attrs:{rules:"required",name:"Nom de la structure",vid:"territorial_collectivity"},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.errors;return[s("div",{staticClass:"v1"},[s("Collectivity",{attrs:{value:e.collectivityName},on:{input:function(t){return e.$emit("update:collectivityName",t)}}})],1),s("InputError",[e._v(e._s(i[0]))])]}}])})],1),s("TextInput",{attrs:{label:"Votre fonction",value:e.collectivityFunction,rules:"required",id:"position"},on:{input:function(t){return e.$emit("update:collectivityFunction",t)}}})],1)},md=[],hd={components:{InputLabel:ce,Collectivity:Al,InputWrapper:he,InputError:be},props:{collectivityName:{required:!0},collectivityFunction:{required:!0}}},vd=hd,fd=Object(d["a"])(vd,pd,md,!1,null,null,null),_d=fd.exports,gd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Select",{attrs:{label:"Précisez le type de structure",value:e.associationName,rules:"required",id:"association"},on:{input:function(t){return e.$emit("update:associationName",t)}}},[s("optgroup",{attrs:{label:"Autre"}},[s("option",{attrs:{value:"Autre"}},[e._v("Mon association n'est pas dans cette liste")])]),s("optgroup",{attrs:{label:"Associations connues"}},e._l(e.associationNameOptions,(function(t){return s("option",{key:t.value,domProps:{value:t.value}},[e._v(e._s(t.label))])})),0)]),"Autre"===e.associationName?s("div",[s("TextInput",{attrs:{label:"Précisez le nom complet",value:e.newAssociationName,rules:"required",id:"new_association_name"},on:{input:function(t){return e.$emit("update:newAssociationName",t)}}}),s("TextInput",{attrs:{label:"Précisez l'acronyme, si besoin",value:e.newAssociationAcronym,id:"new_association_abbreviation"},on:{input:function(t){return e.$emit("update:newAssociationAcronym",t)}}})],1):e._e(),s("div",[s("Select",{attrs:{label:"Territoire de rattachement",value:e.associationTerritory,rules:"required",id:"departement"},on:{input:function(t){return e.$emit("update:associationTerritory",t)}}},[s("SelectOption",[e._v("- Selectionner un choix -")]),e._l(e.associationTerritoryOptions,(function(t){return s("SelectOption",{key:t.value,attrs:{value:t.value}},[e._v(" "+e._s(t.label)+" ")])}))],2)],1),s("TextInput",{attrs:{label:"Votre fonction",value:e.associationFunction,rules:"required",id:"position"},on:{input:function(t){return e.$emit("update:associationFunction",t)}}})],1)},bd=[],yd={props:{associationName:{required:!0},associationTerritory:{required:!0},associationFunction:{required:!0},newAssociationName:{required:!0},newAssociationAcronym:{required:!0}},data(){return{associationNameOptions:[],associationTerritoryOptions:[]}},async mounted(){const[{organizations:e},{departements:t}]=await Promise.all([ad("association"),Er()]),s=[];this.associationNameOptions=e.filter(e=>-1===s.indexOf(e.name)&&(s.push(e.name),!0)).map(({name:e,abbreviation:t})=>({value:e,label:null!==t?`${t} (${e})`:e})),this.associationTerritoryOptions=t.map(({code:e,name:t})=>({value:e,label:`${e} - ${t}`}))}},Cd=yd,wd=Object(d["a"])(Cd,gd,bd,!1,null,null,null),xd=wd.exports,kd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("Select",{attrs:{label:"Nom de la structure",value:e.administrationName,rules:"required",id:"organization_administration"},on:{input:function(t){return e.$emit("update:administrationName",t)}}},[s("SelectOption",{attrs:{value:"none"}},[e._v("- Selectionner un choix -")]),e._l(e.administrationNameOptions,(function(t){return s("SelectOption",{key:t.value,attrs:{value:t.value}},[e._v(e._s(t.label))])}))],2),s("TextInput",{attrs:{label:"Votre fonction",value:e.administrationFunction,rules:"required",id:"position"},on:{input:function(t){return e.$emit("update:administrationFunction",t)}}})],1)},Pd=[],Sd={props:{administrationName:{required:!0},administrationFunction:{required:!0}},data(){return{administrationNameOptions:[]}},async mounted(){const{organizations:e}=await ad("administration");this.administrationNameOptions=e.map(({id:e,name:t})=>({value:e,label:t}))}},$d=Sd,Td=Object(d["a"])($d,kd,Pd,!1,null,null,null),Ad=Td.exports,Ed=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("a",{attrs:{href:"https://www.facebook.com/sharer/sharer.php?u="+e.url,target:"_blank"}},[s("Icon",{staticClass:"text-display-lg",attrs:{icon:["fab","facebook-square"]}})],1),e._v(" "+e._s(" ")+" "),s("a",{attrs:{href:"http://www.twitter.com/share?url="+e.url,target:"_blank"}},[s("Icon",{staticClass:"text-display-lg",attrs:{icon:["fab","twitter-square"]}})],1)])},Od=[],Id={computed:{url(){return encodeURIComponent("https://resorption-bidonvilles.beta.gouv.fr/#/contact")}}},Dd=Id,jd=Object(d["a"])(Dd,Ed,Od,!1,null,null,null),qd=jd.exports,Ld={components:{SocialShare:qd,Checkbox:et,CheckableGroup:Us,PublicContainer:Vi,PublicLayout:ba,PublicEstablishmentForm:ud,TerritorialCollectivityForm:_d,AdministrationForm:Ad,AssociationForm:xd},computed:{isFrenchLocale(){return"fr"===this.$i18n.locale},isRequestAccess(){return this.commonFields.request_type.includes("access-request")&&this.isFrenchLocale},isRequestAccessAndActor(){return this.isRequestAccess&&this.commonFields.is_actor},isPublicEstablishmentRequest(){return this.isRequestAccessAndActor&&"public_establishment"===this.requestAccessFields.organization_category},isTerritorialCollectivityRequest(){return this.isRequestAccessAndActor&&"territorial_collectivity"===this.requestAccessFields.organization_category},isAssociationRequest(){return this.isRequestAccessAndActor&&"association"===this.requestAccessFields.organization_category},isAdministrationRequest(){return this.isRequestAccessAndActor&&"administration"===this.requestAccessFields.organization_category}},methods:{async submitForm(){const e={...this.commonFields,legal:this.commonFields.legal.length>0,is_actor:!!this.commonFields.is_actor,...this.isRequestAccessAndActor?this.requestAccessFields:{},...this.isPublicEstablishmentRequest?this.publicEstablishmentFields:{},...this.isTerritorialCollectivityRequest?this.territorialCollectivityFields:{},...this.isAssociationRequest?this.associationFields:{},...this.isAdministrationRequest?this.administrationFields:{}};this.loading=!0;try{await Xc(e),this.loading=!1,this.$router.push("/"),zc({group:"notifications",type:"success",title:"Succès",text:this.isRequestAccessAndActor?"Votre demande d'accès a été envoyée":"Votre message a bien été envoyé"})}catch(t){this.loading=!1,this.error=t,this.$refs.form.setErrors(t.fields)}}},data(){return{loading:!1,error:null,commonFields:{email:this.$route.query.email||"",first_name:"",last_name:"",request_type:[],legal:[],is_actor:null,access_request_message:""},requestAccessFields:{organization_category:null,position:""},publicEstablishmentFields:{organization_type:null,organization_public:null},territorialCollectivityFields:{territorial_collectivity:null},associationFields:{association:"",departement:"",new_association_name:"",new_association_abbreviation:""},administrationFields:{organization_administration:""}}}},Fd=Ld,Md=(s("65a2"),Object(d["a"])(Fd,Zc,Kc,!1,null,null,null)),Nd=Md.exports,zd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--dashboard"},[s("Quickview",{attrs:{town:e.quickview.town,origin:e.quickview.originEvent},on:{"outside-click":e.hideQuickview}}),s("POIView",{attrs:{poi:e.poiview.poi,origin:e.poiview.originEvent},on:{"outside-click":e.hidePOIView}}),s("NavBar"),s("section",{staticClass:"dashboard"},[s("simplebar",{ref:"filters",staticClass:"filters",attrs:{"data-simplebar-auto-hide":"false"}},e._l(e.allowedFilters,(function(e){return s("FilterGroup",{key:e.id,attrs:{id:e.id,faIcon:e.faIcon,icon:e.icon,label:e.label,options:e.options,opened:e.opened}})})),1),s("div",{ref:"main",staticClass:"content",style:{width:e.loading||e.error?0:"auto"}},[s("Map",e._b({ref:"map",on:{"town-click":e.showQuickview,"poi-click":e.showPOIView,"on-row-click":e.routeToTown}},"Map",e.rendererProps,!1))],1),e.loading?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),e.error?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.fetchData}},[e._v("Réessayer ?")])])]):e._e()],1)],1)])},Bd=[],Rd=s("8d3b"),Vd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"filterGroup"},[s("aside",[null!==e.faIcon?s("font-awesome-icon",{attrs:{icon:e.faIcon}}):s("img",{attrs:{src:e.icon,alt:""}})],1),s("main",[s("h1",{on:{click:e.toggle}},[e._v(e._s(e.label)+" "),s("span",{staticClass:"filterGroup-toggle"},[e._v("( "+e._s(e.toggler)+" )")])]),e._l(e.options,(function(t,i){return"open"===e.status?s("div",{key:i},[s("input",{directives:[{name:"model",rawName:"v-model",value:t.checked,expression:"option.checked"}],attrs:{type:"checkbox",id:e.id+"-"+(t.id||i)},domProps:{value:t.value,checked:Array.isArray(t.checked)?e._i(t.checked,t.value)>-1:t.checked},on:{change:function(s){var i=t.checked,a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=t.value,r=e._i(i,o);a.checked?r<0&&e.$set(t,"checked",i.concat([o])):r>-1&&e.$set(t,"checked",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(t,"checked",n)}}}),s("label",{staticClass:"label-inline",attrs:{for:e.id+"-"+(t.id||i)}},[void 0!==t.icon?s("font-awesome-icon",{style:{color:"#"+t.icon.color},attrs:{icon:t.icon.id,"fixed-width":""}}):e._e(),s("span",[e._v(e._s(t.label))])],1),s("br")]):e._e()}))],2)])},Ud=[],Hd={props:{id:String,icon:{type:String,required:!1,default:null},faIcon:{type:String,required:!1,default:null},label:String,options:Array,opened:{type:Boolean,default:!1}},data(){return{status:!0===this.opened?"open":"closed"}},computed:{toggler(){return"open"===this.status?"-":"+"}},methods:{toggle(){this.status="open"===this.status?"closed":"open"}}},Gd=Hd,Wd=Gd,Yd=(s("77c2"),Object(d["a"])(Wd,Vd,Ud,!1,null,null,null)),Jd=Yd.exports,Qd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("section",{staticClass:"map"},[e.displaySearchbar?s("Address",{attrs:{placeholder:e.placeholder},model:{value:e.address,callback:function(t){e.address=t},expression:"address"}}):e._e(),s("div",{attrs:{id:"map"}},[s("div",{ref:"adressToggler",staticClass:"leaflet-address-toggler"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.showAddresses,expression:"showAddresses"}],attrs:{type:"checkbox"},domProps:{checked:Array.isArray(e.showAddresses)?e._i(e.showAddresses,null)>-1:e.showAddresses},on:{change:function(t){var s=e.showAddresses,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&(e.showAddresses=s.concat([n])):o>-1&&(e.showAddresses=s.slice(0,o).concat(s.slice(o+1)))}else e.showAddresses=a}}}),e._v(" Voir les adresses des sites ")]),s("div",{ref:"legends",staticClass:"leaflet-legend"},[s("h1",[e._v("Légende")]),e._l(e.fieldTypes,(function(t){return s("p",[s("span",{style:{"background-color":t.color}}),e._v(" "+e._s(t.label)+" ")])}))],2)])],1)},Zd=[],Kd=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search__group"},[s("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.query,expression:"query",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:e.placeholder,autofocus:e.autofocus},domProps:{value:e.query},on:{keyup:e.onTyping,keydown:e.onNavigation,focus:e.onFocus,blur:[e.onBlur,function(t){return e.$forceUpdate()}],input:function(t){t.target.composing||(e.query=t.target.value.trim())}}}),e.suggestions.length?s("div",{staticClass:"autocomplete"},e._l(e.suggestions,(function(t,i){return s("p",{staticClass:"autocomplete-result",class:{active:i===e.indexOfHighlightedSuggestion},domProps:{innerHTML:e._s((t.type?"<span>"+t.type+"</span><br/>":"")+t.label)},on:{mousedown:function(s){return e.onSuggestionClick(t)}}})})),0):e._e(),e.showMagnifier?s("button",{staticClass:"overlay-button",attrs:{"aria-label":"Recherche"}},[s("svg",{staticClass:"icon icon-search"},[s("use",{attrs:{"xlink:href":"#magnifier"}})])]):e._e()])},Xd=[];const eu=200,tu=3;var su={props:{value:Object,autofocus:Boolean,placeholder:String,autocompleteFunction:{type:Function,default:Tr},showMagnifier:{type:Boolean,default:!0},typingMin:{type:Number,default:tu}},data(){return{pendingRequest:null,typingTimeout:null,suggestions:[],filled:null!==this.value,query:null!==this.value&&this.value.label||"",previousQuery:null!==this.value?this.value.label:"",focused:!1,indexOfHighlightedSuggestion:null}},mounted(){document.addEventListener("click",this.checkOutsideClick)},beforeDestroy(){null!==this.typingTimeout&&(clearTimeout(this.typingTimeout),this.typingTimeout=null)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{onTyping(){this.previousQuery!==this.query&&(this.previousQuery=this.query,null!==this.typingTimeout&&clearTimeout(this.typingTimeout),this.filled=!1,this.$emit("input",null),this.setSuggestions([]),this.indexOfHighlightedSuggestion=null,this.typingTimeout=setTimeout(this.autocomplete,eu))},onFocus(){this.focused=!0},onBlur(){this.focused=!1,null!==this.pendingRequest&&this.pendingRequest.abort(),!1===this.filled&&(this.query="",this.previousQuery=""),this.setSuggestions([])},onNavigation(e){38===e.keyCode?this.indexOfHighlightedSuggestion-1<0?this.indexOfHighlightedSuggestion=null:this.indexOfHighlightedSuggestion-=1:40===e.keyCode?this.suggestions.length>0&&(null===this.indexOfHighlightedSuggestion?this.indexOfHighlightedSuggestion=0:this.indexOfHighlightedSuggestion=Math.min(this.suggestions.length-1,this.indexOfHighlightedSuggestion+1)):13===e.keyCode?null!==this.indexOfHighlightedSuggestion&&this.onSelect(this.suggestions[this.indexOfHighlightedSuggestion]):this.indexOfHighlightedSuggestion=null},onSuggestionClick(e){this.onSelect(e)},onSelect(e){const{label:t}=e;this.$emit("input",e),this.setSuggestions([]),this.filled=!0,this.query=t,this.previousQuery=t},autocomplete(){null!==this.pendingRequest&&this.pendingRequest.abort(),this.query.length<this.typingMin||!0!==this.focused||(this.pendingRequest=this.autocompleteFunction(this.query),this.pendingRequest.then(e=>{!0===this.focused&&this.setSuggestions(e)}).catch(()=>{this.pendingRequest=null}))},checkOutsideClick(e){this.$el.contains(e.target)||this.setSuggestions([])},setSuggestions(e){this.suggestions=e,this.suggestions.length>0?this.indexOfHighlightedSuggestion=0:this.indexOfHighlightedSuggestion=null}}},iu=su,au=iu,nu=(s("e072"),Object(d["a"])(au,Kd,Xd,!1,null,"6b423108",null)),ou=nu.exports,ru=(s("8243"),s("3ac1"),s("7319"),s("67e3")),lu=s.n(ru),cu=s("71ee"),du=s.n(cu),uu=s("64e1"),pu=s.n(uu),mu=s("0eac"),hu=s.n(mu);const vu=[46.7755829,2.0497727],fu=13;var _u={components:{Address:ou},props:{towns:{type:Array,required:!1,default(){return[]}},pois:{type:Array,required:!1,default(){return[]}},displaySearchbar:{type:Boolean,required:!1,default:!0},placeholder:{type:String,required:!1,default:"Recherchez un lieu en saisissant une adresse"},defaultView:{type:Object,default:()=>({center:vu,zoom:6})}},data(){return{map:null,markersGroup:{towns:Nr.a.markerClusterGroup(),search:Nr.a.markerClusterGroup(),pois:Nr.a.markerClusterGroup({disableClusteringAtZoom:fu})},searchMarker:this.createSearchMarker(),townSearchMarker:null,townMarkers:[],poiMarkers:[],poiMarkersVisible:!1,hashedTownMarkers:{},address:null,showAddresses:!1,fieldTypes:Ao().field_types}},computed:{fieldTypeColors(){return this.fieldTypes?this.fieldTypes.reduce((e,t)=>Object.assign(e,{[t.id]:t.color}),{}):{}},mapLayers(){return{Satellite:Nr.a.tileLayer.provider("Esri.WorldImagery"),Dessin:Nr.a.tileLayer.provider("OpenStreetMap.Mapnik")}}},watch:{towns(){this.syncTownMarkers()},pois(){this.syncPOIMarkers()},showAddresses(){!0===this.showAddresses?document.body.setAttribute("class","leaflet-show-addresses"):document.body.setAttribute("class","")},address(){if(null===this.address)return void this.clearSearchMarker();const{coordinates:[e,t],label:s,addressType:i}=this.address;this.centerMap([t,e],20),this.$nextTick(()=>{this.setSearchMarker(i,s,[t,e])})}},mounted(){this.createMap(),this.syncTownMarkers()},methods:{setupMapControls(){this.setupZoomControl(),this.setupLayersControl(),this.setupAddressTogglerControl(),this.setupFieldTypesLegendControl()},setupZoomControl(){this.map.zoomControl.setPosition("bottomright")},setupLayersControl(){const e=Nr.a.control.layers(this.mapLayers,void 0,{collapsed:!1});this.map.addControl(e)},setupAddressTogglerControl(){const{adressToggler:e}=this.$refs,t=Nr.a.Control.extend({options:{position:"bottomleft"},onAdd(){return e}});this.map.addControl(new t)},setupFieldTypesLegendControl(){const{legends:e}=this.$refs,t=Nr.a.Control.extend({options:{position:"bottomleft"},onAdd(){return e}});this.map.addControl(new t)},setupMarkerGroups(){this.map.addLayer(this.markersGroup.towns),this.map.addLayer(this.markersGroup.search),this.map.addLayer(this.markersGroup.pois)},setupView(){const{center:e,zoom:t}=this.defaultView;this.centerMap(e,t)},createMap(){this.map=Nr.a.map("map",{layers:this.mapLayers.Dessin,scrollWheelZoom:!1}),this.map.on("zoomend",this.onZoomEnd),this.setupMapControls(),this.setupMarkerGroups(),this.setupView()},onZoomEnd(){const e=this.map.getZoom();!this.poiMarkersVisible&&e>fu&&(this.poiMarkersVisible=!0,this.pois.forEach(this.createPOIMarker)),this.poiMarkersVisible&&e<=fu&&(this.poiMarkersVisible=!1,this.removeAllPOIMarkers())},syncTownMarkers(){this.removeAllTownMarkers(),this.towns.forEach(this.createTownMarker)},syncPOIMarkers(){this.removeAllPOIMarkers(),this.poiMarkersVisible&&this.pois.forEach(this.createPOIMarker)},removeAllTownMarkers(){this.markersGroup.towns.clearLayers(),this.townMarkers=[],this.hashedTownMarkers={}},removeAllPOIMarkers(){this.markersGroup.pois.clearLayers(),this.poiMarkers=[]},getTownAddress(e){return e.usename},getTownCoordinates(e){const{latitude:t,longitude:s}=e;return[t,s]},getTownColor(e){return void 0!==e.fieldType?this.fieldTypeColors[e.fieldType.id]:"#cccccc"},getTownWaterImage(e){return!0===e.accessToWater?lu.a:!1===e.accessToWater?pu.a:hu.a},createSearchMarker(){return Nr.a.marker(vu,{title:"A",icon:Nr.a.divIcon({className:"leaflet-marker",html:'<span class="mapPin mapPin--result">\n                        <span class="mapPin-wrapper">\n                            <span class="mapPin-marker" style="background-color: red"></span>\n                        </span>\n                        <span class="mapPin-address"></span>\n                    </span>',iconAnchor:[13,28]})})},createTownMarker(e){const t=this.getTownAddress(e),s=this.getTownCoordinates(e),i=this.getTownColor(e),a=this.getTownWaterImage(e),n=Nr.a.marker(s,{title:e.address,icon:Nr.a.divIcon({className:"leaflet-marker",html:`<span class="mapPin mapPin--shantytown">\n                        <span class="mapPin-wrapper">\n                            <span class="mapPin-water"><img src="${a}" /></span>\n                            <span class="mapPin-marker" style="background-color: ${i}"></span>\n                        </span>\n                        <span class="mapPin-address">${t}</span>\n                    </span>`,iconAnchor:[13,28]})});n.on("click",this.handleTownMarkerClick.bind(this,e)),n.on("add",()=>{!0===n.searchResult&&this.markTownAsSearchResult(n)}),n.addTo(this.markersGroup.towns),this.townMarkers.push(n),this.hashedTownMarkers[s.join(";")]=n},createPOIMarker(e){const{latitude:t,longitude:s}=e,i=[t,s],a=Nr.a.marker(i,{title:e.address,icon:Nr.a.divIcon({className:"leaflet-marker",html:`<span class="mapPin mapPin--poi" >\n                        <span class="mapPin-wrapper">\n                            <img src="${du.a}" width="12" height="12"/>\n                        </span>\n                        <span class="mapPin-address">${e.address}</span>\n                    </span>`,iconAnchor:[13,28]})});a.on("click",this.handlePOIMarkerClick.bind(this,e)),a.addTo(this.markersGroup.pois),this.poiMarkers.push(a)},handleTownMarkerClick(e,t){this.$emit("town-click",e,t)},handlePOIMarkerClick(e,t){this.$emit("poi-click",e,t)},centerMap(e,t){this.map.setView(e,t)},resize(){null!==this.map&&this.map.invalidateSize(!0)},clearSearchMarker(){if(null!==this.townSearchMarker)return this.townSearchMarker._icon&&this.townSearchMarker._icon.querySelector(".mapPin").classList.remove("mapPin--result"),this.townSearchMarker.searchResult=!1,void(this.townSearchMarker=null);this.searchMarker.remove()},getMatchingTownMarker(e){return this.hashedTownMarkers[e.join(";")]||null},markTownAsSearchResult(e){this.townSearchMarker=e,this.townSearchMarker.searchResult=!0,e._icon.querySelector(".mapPin").classList.add("mapPin--result")},setSearchMarker(e,t,s){this.clearSearchMarker();const i=this.getMatchingTownMarker(s);if(null!==i)return void this.markTownAsSearchResult(i);this.searchMarker.addTo(this.markersGroup.search),this.searchMarker.setLatLng(s),this.searchMarker._icon.querySelector(".mapPin-address").innerHTML=t;let a="add";"housenumber"!==e&&(a="remove"),this.searchMarker._icon.querySelector(".mapPin").classList[a]("mapPin--street")}}},gu=_u,bu=gu,yu=(s("6613"),Object(d["a"])(bu,Qd,Zd,!1,null,"055bfb64",null)),Cu=yu.exports,wu=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{active:e.active}},[s("div",{staticClass:"shadow"}),s("simplebar",{ref:"quickviewPanel",staticClass:"quickview",attrs:{"data-simplebar-auto-hide":"false"}},[e.town?s("header",{staticClass:"quickview-header"},[s("div",{staticClass:"quickview-actions"},[s("button",{staticClass:"actionButton",attrs:{type:"button"},on:{click:e.showTown}},[e._v("Voir le site")]),s("a",{attrs:{href:"#"},on:{click:function(t){return e.$emit("outside-click")}}},[s("svg",{staticClass:"icon icon-cross"},[s("use",{attrs:{"xlink:href":"#round-cross"}})])])]),s("h1",{staticClass:"quickview-title"},[s("a",{on:{click:e.showTown}},[e._v(e._s(e.town.address.split(/[0-9]{5}/)[0].replace(/[0-9]/g,"").replace(/,/g," ").replace(/\s{2,}/g," ")))])]),s("h2",{staticClass:"quickview-subtitle"},[e._v("Site de "+e._s(e.town.city.name))]),e.town.name?s("h2",{staticClass:"quickview-name"},[e._v(e._s(e.town.name))]):e._e(),void 0!==e.town.updatedAt?s("h2",{staticClass:"quickview-time"},[e._v("(Dernière modification le "),s("time",[e._v(e._s(e.formatDate(e.town.updatedAt)))]),e._v(")")]):e._e()]):e._e(),e._l(e.sections,(function(t,i){return s("section",{class:{even:i%2!==0}},[s("header",[s("h1",[e._v(e._s(t.title))])]),s("table",[s("tbody",e._l(t.rows,(function(t){return s("tr",[t.label?s("th",[e._v(e._s(t.label)+" :")]):e._e(),s("td",{attrs:{colspan:t.label?1:2}},[e._v(e._s(t.value))])])})),0)])])}))],2)],1)},xu=[],ku={components:{simplebar:Rd["a"]},props:{town:Object,origin:Event},computed:{active(){return!!this.town},caracteristicSection(){if(!this.town)return null;const e=[];return void 0!==this.town.fieldType&&e.push({label:"Type de site",value:this.town.fieldType.label}),void 0!==this.town.ownerType&&e.push({label:"Type de propriétaire",value:this.town.ownerType.label}),void 0!==this.town.builtAt&&e.push({label:"Date d'installation",value:this.town.builtAt?App.formatDate(this.town.builtAt):"Inconnue"}),0===e.length?null:{title:"Caractéristiques",rows:e}},demographySection(){if(!this.town)return null;const e=[];return void 0!==this.town.populationTotal&&e.push({label:"Nombre de personnes",value:null!==this.town.populationTotal?this.town.populationTotal:"inconnu"}),void 0!==this.town.populationCouples&&e.push({label:"Nombre de ménages",value:null!==this.town.populationCouples?this.town.populationCouples:"inconnu"}),void 0!==this.town.populationMinors&&e.push({label:"Nombre de mineurs",value:null!==this.town.populationMinors?this.town.populationMinors:"inconnu"}),void 0!==this.town.socialOrigins&&(e.push({label:"Origines",value:this.town.socialOrigins.length>0?"":"inconnu"}),this.town.socialOrigins.forEach(t=>{e.push({value:t.label})})),0===e.length?null:{title:"Habitants",rows:e}},justiceSection(){if(!this.town)return null;const e=[],t={[!0]:"oui",[!1]:"non"};if(void 0!==this.town.justiceProcedure&&e.push({label:"Existence d'une procédure judiciaire",value:t[this.town.justiceProcedure]||"inconnu"}),void 0!==this.town.justiceRendered&&e.push({label:"Décision de justice rendue",value:t[this.town.justiceRendered]||"inconnu"}),void 0!==this.town.policeStatus){const t={none:"non demandé",requested:"demandé",granted:"obtenu"};e.push({label:"Concours de la force publique demandé",value:t[this.town.policeStatus]||"inconnu"})}return 0===e.length?null:{title:"Procédure judiciaire d'expulsion",rows:e}},sections(){return[this.caracteristicSection,this.demographySection,this.justiceSection].filter(e=>null!==e)}},mounted(){document.addEventListener("click",this.checkOutsideClick)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{hasPermission:Io,formatDate:e=>App.formatDate(e),checkOutsideClick(e){this.town&&e!==this.origin&&(this.$refs.quickviewPanel.$el.contains(e.target)||this.$emit("outside-click",e))},showTown(){const e=this.$router.resolve("/site/"+this.town.id);mo(e.href)}}},Pu=ku,Su=Pu,$u=(s("e119"),Object(d["a"])(Su,wu,xu,!1,null,"12c43bda",null)),Tu=$u.exports,Au=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:{active:e.active}},[s("div",{staticClass:"shadow"}),s("simplebar",{ref:"quickviewPanel",staticClass:"quickview",attrs:{"data-simplebar-auto-hide":"false"}},[e.poi?s("header",{staticClass:"quickview-header"},[s("div",{staticClass:"px-4"},[s("div",{staticClass:"text-right"},[s("a",{attrs:{href:"#"},on:{click:function(t){return e.$emit("outside-click")}}},[s("svg",{staticClass:"icon icon-cross"},[s("use",{attrs:{"xlink:href":"#round-cross"}})])])]),s("h1",{staticClass:"quickview-title"},[e._v(" Point de distribution alimentaire ")]),e.poi.name?s("h4",{staticClass:"my-4"},[e._v(" "+e._s(e.poi.name)+" ")]):e._e(),e.poi.address?s("div",[e._v(" "+e._s(e.poi.address)+" ")]):e._e(),e.poi.phone?s("div",{staticClass:"my-2"},[e._v(" Tel: "+e._s(e.poi.phone)+" ")]):e._e(),e.poi.email?s("div",{staticClass:"my-2"},[e._v(" Email: "+e._s(e.poi.email)+" ")]):e._e(),e.poi.language?s("div",{staticClass:"my-2"},[e._v(" Langue: "+e._s(e.poi.language)+" ")]):e._e(),e.poi.temporarily_closed?s("div",{staticClass:"my-2"},[e._v(" "+e._s(e.poi.temporarily_closed)+" ")]):e._e(),e.poi.temporary_information?s("div",{staticClass:"my-2"},[e._v(" "+e._s(e.poi.temporary_information)+" ")]):e._e(),e.poi.solinum_id?s("a",{staticClass:"my-2",attrs:{target:"_blank",href:"https://soliguide.fr/fiche/"+e.poi.solinum_id},on:{click:e.trackOpenSoliguide}},[e._v(" Voir plus ")]):e._e()])]):e._e()])],1)},Eu=[],Ou={components:{simplebar:Rd["a"]},props:{poi:Object,origin:Event},computed:{active(){return!!this.poi}},mounted(){document.addEventListener("click",this.checkOutsideClick)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},watch:{active:function(e){e&&this.trackOpenPOI()}},methods:{trackOpenPOI(){this.$piwik.trackEvent("POI","Open POI",this.poi.solinum_id)},trackOpenSoliguide(){this.$piwik.trackEvent("POI","Click See More",this.poi.solinum_id)},checkOutsideClick(e){this.poi&&e!==this.origin&&(this.$refs.quickviewPanel.$el.contains(e.target)||this.$emit("outside-click",e))}}},Iu=Ou,Du=(s("bb25"),Object(d["a"])(Iu,Au,Eu,!1,null,"d6ae0734",null)),ju=Du.exports;function qu(){return bo("/pois")}var Lu=s("6ecd"),Fu=s.n(Lu),Mu=s("9934"),Nu=s.n(Mu),zu=s("597c"),Bu=s.n(zu),Ru=s("d89d"),Vu=s.n(Ru);function Uu(e){switch(e){case"nation":case"region":return 6;default:case"departement":case"epci":case"city":return 10}}var Hu={components:{NavBar:cr,FilterGroup:Jd,Map:Cu,Quickview:Tu,POIView:ju,simplebar:Rd["a"]},data(){const{user:e}=Ao();return{error:void 0,loading:!1,defaultMapView:{center:[e.organization.location.latitude,e.organization.location.longitude],zoom:Uu(e.organization.location.type)},towns:[],pois:[],quickview:{town:null,originEvent:null},poiview:{poi:null,originEvent:null},permission:Oo("shantytown.list"),filters:[{faIcon:"tint",label:"Accès à l'eau",id:"accessToWater",options:[{value:!0,label:"Oui",checked:!0,icon:{id:"tint",color:"00a0e3"}},{value:!1,label:"Non",checked:!0,icon:{id:"tint-slash",color:"ADB9C9"}},{value:null,label:"Inconnu",checked:!0,icon:{id:"question",color:"ADB9C9"}}],opened:!0},{icon:Fu.a,label:"Types de site",id:"fieldType",options:[],opened:!0},{icon:Nu.a,label:"Nombre de personnes",id:"population",options:[{value:null,label:"Inconnu",checked:!0},{value:"-9",label:"Moins de 10 personnes",checked:!0},{value:"10-99",label:"Entre 10 et 99 personnes",checked:!0},{value:"100-",label:"100 personnes et plus",checked:!0}]},{icon:Bu.a,label:"Statut des sites",id:"status",options:[{value:"closed",label:"Disparus",checked:!1},{value:"opened",label:"Existants",checked:!0}]},{icon:Nu.a,label:"Type de propriétaire",id:"ownerType",options:Ao().owner_types.map(e=>({value:e.id,label:e.label,checked:!0}))},{icon:Vu.a,label:"Points d'intérêts",id:"poi",options:[{value:"food_bank",label:"Distribution alimentaire",checked:!0}],opened:!0}]}},computed:{allowedFilters(){return this.permission?this.filters.filter(e=>!e.permissions||e.permissions.every(e=>this.permission[e])):[]},rendererProps(){return{towns:this.visibleTowns,pois:this.visiblePOIs,defaultView:this.defaultMapView}},visiblePOIs(){let e=this.pois;return this.allowedFilters.forEach(t=>{switch(t.id){case"poi":e=e.filter(()=>t.options[0].checked);break;default:}}),e},visibleTowns(){let e=this.towns;return this.allowedFilters.forEach(t=>{switch(t.id){case"accessToWater":{const s=t.options.filter(e=>e.checked).map(e=>e.value);e=e.filter(e=>-1!==s.indexOf(e.accessToWater))}break;case"fieldType":{const s=t.options.filter(e=>e.checked).map(e=>e.value);e=e.filter(e=>e.fieldType&&-1!==s.indexOf(e.fieldType.id))}break;case"population":{const s=t.options.filter(e=>!e.checked).map(e=>e.value);s.forEach(t=>{if(null===t)return void(e=e.filter(e=>null!==e.populationTotal));let[s,i]=t.split("-");s=parseInt(s,10),i=parseInt(i,10),e=e.filter(e=>null===e.populationTotal||(Number.isNaN(s)||Number.isNaN(i)?Number.isNaN(s)?!!Number.isNaN(i)||e.populationTotal>i:e.populationTotal<s:e.populationTotal<s||e.populationTotal>i))})}break;case"status":{const s=t.options.filter(e=>!e.checked).map(e=>e.value);s.forEach(t=>{"closed"===t?e=e.filter(e=>"open"===e.status):"opened"===t&&(e=e.filter(e=>"open"!==e.status))})}break;case"ownerType":{const s=t.options.filter(e=>e.checked).map(e=>e.value);e=e.filter(e=>e.ownerType&&-1!==s.indexOf(e.ownerType.id))}break;default:}}),e}},created(){this.fetchData()},mounted(){window.addEventListener("resize",this.resize)},beforeDestroy(){window.removeEventListener("resize",this.resize)},methods:{sortNumber(e,t){return"inconnu"===e&&"inconnu"===t?0:"inconnu"===e?-1:"inconnu"===t?1:e<t?-1:e>t?1:0},showQuickview(e,t){this.quickview={town:e,originEvent:t.originalEvent}},showPOIView(e,t){this.poiview={poi:e,originEvent:t.originalEvent}},hideQuickview(){this.quickview={town:null,originEvent:null}},hidePOIView(){this.poiview={town:null,originEvent:null}},routeToTown(e){const t=this.$router.resolve("/site/"+e.row.id);mo(t.href)},resize(){this.$refs.main&&(this.stretchToBottom(this.$refs.main),this.stretchToBottom(this.$refs.filters.$el))},stretchToBottom(e){const t=e.offsetHeight,s=t+(document.body.offsetHeight-(this.absoluteOffsetTop(e)+t));e.style.height=s+"px"},absoluteOffsetTop(e){let t=0,s=e;do{t+=s.offsetTop||0,s=s.offsetParent}while(s);return t},fetchData(){!0!==this.loading&&(this.loading=!0,this.error=void 0,Promise.all([sl(),qu()]).then(([e,t])=>{const{field_types:s}=Ao();this.loading=!1;const i=this.filters.filter(({id:e})=>"fieldType"===e)[0];i.options=[...s.map(e=>({id:e.id,value:e.id,label:e.label,checked:!0}))],this.towns=e,this.pois=t,this.$nextTick(()=>{this.resize(),this.$refs.map.resize()})}).catch(e=>{this.error=e.user_message,this.loading=!1}))}}},Gu=Hu,Wu=Gu,Yu=(s("669e"),Object(d["a"])(Wu,zd,Bd,!1,null,null,null)),Ju=Yu.exports,Qu=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[e.error?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.loadConfig}},[e._v("Réessayer ?")])])]):s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Initialisation de la plateforme en cours...")])])])])],1)},Zu=[],Ku={data(){return{error:null}},components:{NavBar:cr},mounted(){this.loadConfig()},methods:{loadConfig(){!0!==So()?(this.error=null,$o().then(()=>{this.redirect()}).catch(e=>{this.error=e.user_message})):this.redirect()},redirect(){const{user:e}=Ao();this.track(e),this.$router.push(wy())},track(e){this.$piwik&&(this.$piwik.setUserId(e.id),this.$piwik.setCustomVariable(1,"superuser",e.is_superuser),this.$piwik.setCustomVariable(2,"structure",e.organization.type.abbreviation||e.organization.type.name_singular),this.$piwik.setCustomVariable(3,"niveau_geo",e.organization.location.type),this.$piwik.setCustomVariable(4,"geo_nom",e.organization.location[e.organization.location.type]?e.organization.location[e.organization.location.type].name:null))}}},Xu=Ku,ep=Xu,tp=Object(d["a"])(ep,Qu,Zu,!1,null,null,null),sp=tp.exports,ip=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),e.exportIsVisible?s("Export",{attrs:{towns:[],location:e.currentLocation,closedTowns:e.showClosedTowns},on:{close:e.hideExport}}):e._e(),"loading"===e.state?s("section",{staticClass:"section section-white"},[e._m(0)]):e._e(),"error"===e.state?s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])])])]):e._e(),"loaded"===e.state?s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("header",{staticClass:"townList-header"},[s("div",[s("hgroup",{staticClass:"townList-hgroup"},[s("h3",[e._v("Sites "+e._s(e.pageTitle))]),s("h1",[e._v(e._s(e.locationTitle))])]),s("CollectivityInput",{staticClass:"townList-search",model:{value:e.location,callback:function(t){e.location=t},expression:"location"}}),s("div",{staticClass:"switch"},[s("button",{class:{active:!e.showClosedTowns},on:{click:function(t){return e.showTowns("open")}}},[e._v("Sites existants")]),s("button",{class:{active:e.showClosedTowns},on:{click:function(t){return e.showTowns("closed")}}},[e._v("Sites fermés")])])],1),s("div",{staticClass:"townList-headerRight"},[s("div",{staticClass:"townList-actions"},[e.hasPermission("shantytown.create")?s("router-link",{staticClass:"button secondary",attrs:{to:"/nouveau-site"}},[e._v("Déclarer un site")]):e._e(),e.hasPermission("shantytown.export")&&e.dashboardShantytowns.length>0?s("a",{staticClass:"button button--excel",on:{click:e.showExport}},[s("font-awesome-icon",{attrs:{icon:"file-excel"}}),e._v(" Exporter")],1):e._e()],1),e.showClosedTowns?e._e():s("section",{staticClass:"townList-summary"},[s("header",[s("h1",[e._v("Au total : "),s("span",[e._v(e._s(e.currentLocation.label))])]),e.lastUpdate?s("h2",[e._v("mis à jour le "+e._s(e.formatDate(e.lastUpdate,"d M y")))]):e._e()]),s("div",{staticClass:"townList-figures"},[s("div",[s("span",[e._v(e._s(e.dashboardShantytowns.length))]),s("br"),e._v("sites existants")]),s("div",[s("span",[e._v(e._s(e.populationTotal))]),s("br"),e._v("personnes")]),s("div",[s("span",[e._v(e._s(e.minorsTotal))]),s("br"),e._v("mineurs")]),e.hasJusticePermission?s("div",[s("span",[e._v(e._s(e.justiceTotal))]),e._v(" site(s) avec une"),s("br"),e._v("procédure judiciaire")]):e._e()])])])]),s("div",{staticClass:"rb-pagination"},[s("span",{staticClass:"link",class:{"link--disabled":0===e.currentPage},on:{click:e.previousPage}},[s("font-awesome-icon",{attrs:{icon:"caret-square-left"}}),e._v(" Précédent")],1),s("span",{staticClass:"pagination-pages"},[e._v(e._s(e.pageBeginning)+" - "+e._s(e.pageEnd)+" sur "+e._s(e.filteredShantytowns.length))]),s("span",{staticClass:"link",class:{"link--disabled":e.currentPage===e.lastPage},on:{click:e.nextPage}},[e._v("Suivant "),s("font-awesome-icon",{attrs:{icon:"caret-square-right"}})],1)])]),s("div",{staticClass:"rb-table"},[s("table",{ref:"table",staticClass:"table"},[s("thead",[s("tr",[e._m(1),e._m(2),e._m(3),s("th",{staticClass:"townColumn-fieldType filterable"},[s("TableFilter",{attrs:{visible:"fieldType"===e.currentFilter},on:{"outside-click":e.hideFilter,clean:e.hideFilter},scopedSlots:e._u([{key:"default",fn:function(t){return[s("span",{staticClass:"fieldType"},[s("i",{style:"background-color: "+t.item.color}),e._v(" "),s("span",[e._v(e._s(t.item.label))])])]}}],null,!1,635955910),model:{value:e.fieldFilterItems,callback:function(t){e.fieldFilterItems=t},expression:"fieldFilterItems"}}),s("span",{class:{active:e.checkedFieldFilterItems>0},on:{click:function(t){return e.toggleFilter("fieldType")}}},[e._v("Type "),e.checkedFieldFilterItems>0?s("span",{staticClass:"badge"},[e._v(e._s(e.checkedFieldFilterItems))]):e._e(),s("font-awesome-icon",{attrs:{icon:"sort-down",size:"2x"}})],1)],1),e._m(4),e.showClosedTowns?s("th",{staticClass:"townColumn-statusDetails filterable"},[s("TableFilter",{attrs:{visible:"status"===e.currentFilter},on:{"outside-click":e.hideFilter,clean:e.hideFilter},model:{value:e.statusFilterItems,callback:function(t){e.statusFilterItems=t},expression:"statusFilterItems"}}),s("span",{class:{active:e.checkedStatusFilterItems>0},on:{click:function(t){return e.toggleFilter("status")}}},[e._v("Cause de la fermeture "),e.checkedStatusFilterItems>0?s("span",{staticClass:"badge"},[e._v(e._s(e.checkedStatusFilterItems))]):e._e(),s("font-awesome-icon",{attrs:{icon:"sort-down",size:"2x"}})],1)],1):e._e(),s("th",{staticClass:"townColumn-population filterable"},[s("TableFilter",{attrs:{visible:"population"===e.currentFilter},on:{"outside-click":e.hideFilter,clean:e.hideFilter},model:{value:e.populationFilterItems,callback:function(t){e.populationFilterItems=t},expression:"populationFilterItems"}}),s("span",{class:{active:e.checkedPopulationFilterItems>0},on:{click:function(t){return e.toggleFilter("population")}}},[e._v("Personnes "),e.checkedPopulationFilterItems>0?s("span",{staticClass:"badge"},[e._v(e._s(e.checkedPopulationFilterItems))]):e._e(),s("font-awesome-icon",{attrs:{icon:"sort-down",size:"2x"}})],1)],1),e._m(5),e._m(6),e._m(7),e.showClosedTowns?e._e():s("th",{staticClass:"townColumn-livingConditions"},[s("span",[e._v("Conditions de vies")])]),e.showClosedTowns?e._e():s("th",{staticClass:"townColumn-census"},[s("span",[e._v("Diagnostic")])]),!e.showClosedTowns&&e.hasJusticePermission?s("th",{staticClass:"townColumn-justice filterable"},[s("TableFilter",{attrs:{visible:"justice"===e.currentFilter},on:{"outside-click":e.hideFilter,clean:e.hideFilter},model:{value:e.justiceFilterItems,callback:function(t){e.justiceFilterItems=t},expression:"justiceFilterItems"}}),s("span",{class:{active:e.checkedJusticeFilterItems>0},on:{click:function(t){return e.toggleFilter("justice")}}},[e._v("Procédure judiciaire "),e.checkedJusticeFilterItems>0?s("span",{staticClass:"badge"},[e._v(e._s(e.checkedJusticeFilterItems))]):e._e(),s("font-awesome-icon",{attrs:{icon:"sort-down",size:"2x"}})],1)],1):e._e(),e.showClosedTowns?s("th",{staticClass:"townColumn-closingSolutions"},[s("span",[e._v("Orientations des ménages")])]):e._e()])]),s("tbody",[0===e.pageContent.length?s("tr",{staticClass:"townRow--empty"},[s("td",{attrs:{colspan:e.showClosedTowns?11:12-(e.hasJusticePermission?0:1)}},[e._v("Il n'existe aucun site correspondant aux filtres sélectionnés")])]):e._e(),e._l(e.pageContent,(function(t,i){return s("tr",{class:i%2===0?"odd":"",on:{click:function(s){return e.routeToTown(t)}}},[s("td",{staticClass:"townColumn-departement"},[e._v(e._s(t.departement.code)+" - "+e._s(t.departement.name))]),s("td",{staticClass:"townColumn-city"},[e._v(e._s(t.city.name))]),s("td",{staticClass:"townColumn-address"},[e._v(e._s(t.usename)+" ")]),s("td",{staticClass:"townColumn-fieldType"},[s("span",{staticClass:"fieldType"},[s("i",{style:"background-color: "+t.fieldType.color}),e._v(" "),s("span",[e._v(e._s(t.fieldType.label))])])]),s("td",{staticClass:"townColumn-status"},[null===t.statusName?s("span",{staticClass:"secondary"},[e._v("NC")]):s("span",[e._v(e._s(t.statusName)+" depuis"),s("br"),e._v("le "+e._s(e.formatDate(t.statusDate,"d/m/y"))),s("br"),e._v(e._s(t.statusSince))])]),e.showClosedTowns?s("td",{staticClass:"townColumn-statusDetails"},[e._v(e._s(t.statusDetails))]):e._e(),s("td",{staticClass:"townColumn-population"},[null===t.populationTotal?s("span",{staticClass:"secondary"},[e._v("NC")]):s("div",[s("span",{staticClass:"primary"},[e._v(e._s(t.populationTotal))]),s("br"),s("span",{staticClass:"secondary"},[e._v("au "+e._s(e.formatDate(t.updatedAt||t.builtAt,"d/m/y")))])])]),s("td",{staticClass:"townColumn-minors"},[null===t.populationMinors?s("span",{staticClass:"secondary"},[e._v("NC")]):s("span",[e._v(e._s(t.populationMinors))])]),s("td",{staticClass:"townColumn-couples"},[null===t.populationCouples?s("span",{staticClass:"secondary"},[e._v("NC")]):s("span",[e._v(e._s(t.populationCouples))])]),s("td",{staticClass:"townColumn-origins"},[0===t.socialOrigins.length?s("span",{staticClass:"secondary"},[e._v("NC")]):s("span",[e._v(e._s(t.socialOrigins.map((function(e){var t=e.label;return t})).join(" / ")))])]),e.showClosedTowns?e._e():s("td",{staticClass:"townColumn-livingConditions"},[s("ul",{staticClass:"list"},[s("li",{class:"listItem-"+e.boolToCss[t.electricityType.value]},[e._v("électricité : "+e._s(e.boolToLabel[t.electricityType.value]))]),s("li",{class:"listItem-"+e.boolToCss[t.accessToWater]},[e._v("eau : "+e._s(e.boolToLabel[t.accessToWater]))]),s("li",{class:"listItem-"+e.boolToCss[t.trashEvacuation]},[e._v("évacuation des déchets : "+e._s(e.boolToLabel[t.trashEvacuation]))])])]),e.showClosedTowns?e._e():s("td",{staticClass:"townColumn-census"},[null===t.censusStatus?s("span",{staticClass:"secondary"},[e._v("NC")]):"done"!==t.censusStatus?s("span",[e._v(e._s(e.censusStatuses[t.censusStatus]))]):s("span",[e._v("Réalisé"),t.censusConductedAt?s("span",[e._v(" le"),s("br"),e._v(e._s(e.formatDate(t.censusConductedAt,"d/m/y")))]):e._e()])]),!e.showClosedTowns&&e.hasJusticePermission?s("td",{staticClass:"townColumn-justice"},[null===t.justiceStatus?s("span",{staticClass:"secondary"},[e._v("NC")]):s("ul",{staticClass:"list list--circle"},e._l(t.justiceStatuses,(function(t){return s("li",[e._v(e._s(t.label)+" "),t.date?s("span",{staticClass:"secondary"},[s("br"),e._v("le "+e._s(e.formatDate(t.date,"d/m/y")))]):e._e()])})),0)]):e._e(),e.showClosedTowns?s("td",{staticClass:"townColumn-closingSolutions"},[0===t.closingSolutions.length?s("span",{staticClass:"secondary"},[e._v("NC")]):s("ul",{staticClass:"list"},e._l(t.closingSolutions,(function(t){return s("li",[e._v(e._s(t.householdsAffected||"NC")+" - "+e._s(e.closingSolutionNames[t.id]))])})),0)]):e._e()])}))],2)])]),e.pageContent.length>2?s("div",{staticClass:"container"},[s("div",{staticClass:"rb-pagination"},[s("span",{staticClass:"link",class:{"link--disabled":0===e.currentPage},on:{click:e.previousPage}},[s("font-awesome-icon",{attrs:{icon:"caret-square-left"}}),e._v(" Précédent")],1),s("span",{staticClass:"pagination-pages"},[e._v(e._s(e.pageBeginning)+" - "+e._s(e.pageEnd)+" sur "+e._s(e.filteredShantytowns.length))]),s("span",{staticClass:"link",class:{"link--disabled":e.currentPage===e.lastPage},on:{click:e.nextPage}},[e._v("Suivant "),s("font-awesome-icon",{attrs:{icon:"caret-square-right"}})],1)])]):e._e()]):e._e()],1)])},ap=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-departement"},[s("span",[e._v("Département")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-city"},[s("span",[e._v("Commune")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-address"},[s("span",[e._v("Adresse")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-status"},[s("span",[e._v("Date")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-minors"},[s("span",[e._v("Mineurs")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-couples"},[s("span",[e._v("Ménages")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("th",{staticClass:"townColumn-origins"},[s("span",[e._v("Origines")])])}],np=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"alert"},[s("div",{ref:"wrapper",staticClass:"alert-wrapper"},[s("header",{staticClass:"alert-header"},[s("hgroup",[s("h1",{staticClass:"alert-title"},[e._v("Exporter les sites "+e._s(e.title)+" :")]),s("h2",{staticClass:"alert-subtitle"},[e._v(e._s(e.location.label))])]),s("div",{staticClass:"alert-actionButtons"},[s("a",{ref:"link",staticStyle:{display:"none"},attrs:{href:"#"}}),s("button",{staticClass:"button secondary",on:{click:e.close}},[e._v("Annuler")]),s("button",{staticClass:"button",on:{click:e.download}},[s("font-awesome-icon",{attrs:{icon:"file-excel"}}),e._v(" Exporter")],1)])]),s("section",{staticClass:"alert-body"},[s("p",[s("strong",[e._v("Les données exportées par défaut")]),s("ul",{staticClass:"list--circle"},[s("li",[e._v("Localisation : département, commune, adresse")]),s("li",[e._v("Site : type de site (terrain / bâti), date d’installation, date de signalement")]),s("li",[e._v("Habitants : nombre de personnes, mineurs, ménages et origines")]),e.closedTowns?s("li",[e._v("Orientations des ménages après la fermeture")]):e._e(),s("li",[e._v("Date de la dernière mise à jour")])])]),s("p",{staticClass:"alert-options"},[e._v("Cochez les informations supplémentaires que vous souhaitez exporter "),s("ul",e._l(e.availableOptions,(function(t){return s("li",[s("span",{class:"option-"+t.id},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.options[t.id],expression:"options[option.id]"}],attrs:{type:"checkbox",id:"option-"+t.id},domProps:{checked:Array.isArray(e.options[t.id])?e._i(e.options[t.id],null)>-1:e.options[t.id]},on:{change:function(s){var i=e.options[t.id],a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=null,r=e._i(i,o);a.checked?r<0&&e.$set(e.options,t.id,i.concat([o])):r>-1&&e.$set(e.options,t.id,i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.options,t.id,n)}}}),s("label",{attrs:{for:"option-"+t.id}},[e._v(e._s(t.label)),t.description?s("span",[e._v(" "+e._s(t.description))]):e._e()])])])})),0)])])])])},op=[],rp={props:{location:Object,closedTowns:Boolean},data(){return{existingOptions:[{id:"priority",label:"Priorité",description:"(1, 2, 3)",closedTowns:!1},{id:"address_details",label:"Informations d'accès au site",closedTowns:!1},{id:"owner",label:"Propriétaire",description:": type et identité"},{id:"life_conditions",label:"Conditions de vie",description:": accès à l'électricité, l'eau, toilettes, évacuation des déchets"},{id:"demographics",label:"Diagnostic",description:": statut, date, et service en charge"},{id:"justice",label:"Procédures judiciaires",description:": statut et date des étapes",permission:{entity:"shantytown",feature:"export",data:"justice"}},{id:"comments",label:"Commentaires",description:": les 5 derniers",permission:{entity:"shantytown_comment",feature:"list",data:null}},{id:"covid_comments",label:"Commentaires Covid-19",permission:{entity:"covid_comment",feature:"list",data:null}}],options:{priority:!1,address_details:!1,demographics:!1,life_conditions:!1,justice:!1,owner:!1,comments:!1,covid_comments:!1}}},computed:{title(){return this.closedTowns?"fermés":"existants"},availableOptions(){return this.existingOptions.filter(({closedTowns:e})=>void 0===e||this.closedTowns===e).filter(({permission:e})=>{if(void 0===e)return!0;const t=Oo(`${e.entity}.${e.feature}`);return null!==t&&(null===e.data||!0===t["data_"+e.data])})}},mounted(){document.addEventListener("click",this.checkOutsideClick)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{checkOutsideClick(e){0!==this.$refs.wrapper.offsetHeight&&(this.$refs.wrapper.contains(e.target)||this.close())},download(){const{code:e,type:t}=this.location.data;let s=`https://api.resorption-bidonvilles.beta.gouv.fr/towns/export?locationType=${encodeURIComponent(t)}&locationCode=${encodeURIComponent(e)}&closedTowns=${this.closedTowns?"1":"0"}`;const i=this.availableOptions.map(({id:e})=>e).filter(e=>this.options[e]);i.length>0&&(s+="&options="+encodeURIComponent(i.join(","))),ko(s)},close(){this.$emit("close")}}},lp=rp,cp=lp,dp=(s("2a38"),Object(d["a"])(cp,np,op,!1,null,"7dc4c302",null)),up=dp.exports;function pp(e){const t=new Date,s=new Date(1e3*e);let i=0;if(t.getFullYear()===s.getFullYear())i=Math.max(0,t.getMonth()-s.getMonth());else if(t.getFullYear()>s.getFullYear()){const e=t.getFullYear()-s.getFullYear();i=12*(e-1)+(t.getMonth()+12-s.getMonth())}return{years:Math.floor(i/12),months:i%12}}const mp=10,hp={closed_by_justice:"Exécution d'une décision de justice",closed_by_admin:"Exécution d'une décision administrative",other:"Autre",unknown:"Raison inconnue"};var vp={components:{NavBar:cr,CollectivityInput:Dl,TableFilter:yl,Export:up},data(){const{field_types:e,closing_solutions:t,user:s}=Ao(),i=Oo("shantytown.list"),a={shantytowns:[],error:null,state:null,fieldTypeColors:e.reduce((e,t)=>Object.assign(e,{[t.id]:t.color}),{}),closingSolutionNames:t.reduce((e,t)=>Object.assign(e,{[t.id]:t.label.split("(")[0]}),{}),censusStatuses:{none:"Non prévu",scheduled:"Prévu"},boolToLabel:{[null]:"inconnu",[!0]:"oui",[!1]:"non"},boolToCss:{[null]:"unknown",[!0]:"yes",[!1]:"no"},currentPage:0,fieldFilterItems:e.map(({id:e,label:t,color:s})=>({value:e,label:t,color:s,checked:!1})),populationFilterItems:[{label:"Inconnu",value:null,checked:!1},{label:"Moins de 10 personnes",value:"-9",checked:!1},{label:"Entre 10 et 99 personnes",value:"10-99",checked:!1},{label:"Plus de 100 personnes",value:"100-",checked:!1}],justiceFilterItems:[{label:"Inconnu",value:null,checked:!1},{label:"Aucune",value:"none",checked:!1},{label:"Plainte déposée",value:"ownerComplaint",checked:!1},{label:"Procédure en cours",value:"justiceProcedure",checked:!1},{label:"Décision rendue",value:"justiceRendered",checked:!1}],statusFilterItems:[{label:"Raison inconnue",value:"unknown",checked:!1},{label:"Décision de justice",value:"closed_by_justice",checked:!1},{label:"Décision administrative",value:"closed_by_admin",checked:!1},{label:"Autre",value:"other",checked:!1}],currentFilter:null,hasNationalPermission:"nation"===i.geographic_level,hasJusticePermission:!0===i.data_justice,showClosedTowns:!1,locationTitle:null,defaultLocation:null,location:null,exportIsVisible:!1},n={id:"nation"===s.organization.location.type?null:s.organization.location[s.organization.location.type].code,label:"nation"===s.organization.location.type?"France":s.organization.location[s.organization.location.type].name,category:s.organization.location.type,data:{code:"nation"===s.organization.location.type?null:s.organization.location[s.organization.location.type].code,type:s.organization.location.type}};return!0!==a.hasNationalPermission||"nation"===s.organization.location.type?(a.defaultLocation={...n},a.location=null):(a.defaultLocation={id:null,label:"France",category:"Pays",data:{code:null,type:"nation"}},a.location={...n}),"nation"===a.defaultLocation.data.type?a.locationTitle="National":a.locationTitle=a.defaultLocation.label,a},computed:{pageTitle(){return!0===this.showClosedTowns?"fermés":"existants"},currentLocation(){return this.location||this.defaultLocation},populationTotal(){return this.dashboardShantytowns.reduce((e,{populationTotal:t})=>e+(t||0),0)},minorsTotal(){return this.dashboardShantytowns.reduce((e,{populationMinors:t})=>e+(t||0),0)},justiceTotal(){return this.dashboardShantytowns.filter(({justiceProcedure:e})=>!0===e).length},lastUpdate(){return this.dashboardShantytowns.reduce((e,{updatedAt:t})=>null===e||null!==t&&t>e?t:e,null)},dashboardShantytowns(){return this.shantytowns.filter(e=>this.showClosedTowns?"open"!==e.status:"open"===e.status).filter(e=>{if("nation"===this.currentLocation.data.type)return!0;const t=e[this.currentLocation.data.type];return!t||(t.code===""+this.currentLocation.data.code||t.main===""+this.currentLocation.data.code)})},filteredShantytowns(){const e=this.fieldFilterItems.filter(({checked:e})=>e).map(({value:e})=>e),t=this.populationFilterItems.filter(({checked:e})=>e).map(({value:e})=>e),s=this.justiceFilterItems.filter(({checked:e})=>e).map(({value:e})=>e),i=this.statusFilterItems.filter(({checked:e})=>e).map(({value:e})=>e);return e.length+t.length+s.length+i.length===0?this.dashboardShantytowns:this.dashboardShantytowns.filter(a=>!(e.length>0&&!this.checkFieldType(a,e))&&(!(t.length>0&&!this.checkPopulation(a,t))&&(!(s.length>0&&!this.checkJustice(a,s))&&!(i.length>0&&!this.checkStatus(a,i)))))},pageContent(){return this.filteredShantytowns.slice(this.currentPage*mp,this.currentPage*mp+mp)},lastPage(){return Math.max(0,Math.ceil(this.filteredShantytowns.length/mp)-1)},pageBeginning(){return this.filteredShantytowns.length>0?this.currentPage*mp+1:0},pageEnd(){return Math.min(this.pageBeginning-1+mp,this.filteredShantytowns.length)},checkedFieldFilterItems(){return this.fieldFilterItems.filter(({checked:e})=>e).length},checkedPopulationFilterItems(){return this.populationFilterItems.filter(({checked:e})=>e).length},checkedJusticeFilterItems(){return this.justiceFilterItems.filter(({checked:e})=>e).length},checkedStatusFilterItems(){return this.statusFilterItems.filter(({checked:e})=>e).length}},created(){this.load()},watch:{location(){this.currentPage=0},filteredShantytowns(){this.currentPage=0}},methods:{load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,sl().then(e=>{this.shantytowns=e.map(this.enrichShantytown),this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},enrichShantytown(e){let t=!0;"Inconnu"===e.electricityType.label?t=null:"Non"===e.electricityType.label&&(t=!1);const s=[];switch(!0===e.justiceChallenged||!0===e.justiceRendered?(s.push({label:"Décision rendue",date:e.justiceRenderedAt}),!0===e.justiceChallenged&&s.push({label:"Contentieux"})):!0===e.justiceProcedure&&s.push({label:"Procédure en cours"}),!0===e.ownerComplaint&&s.push({label:"Plainte déposée"}),e.policeStatus){case"none":s.push({label:"Concours de la force publique non demandé"});break;case"requested":s.push({label:"Concours de la force publique demandé",date:e.policeRequestedAt});break;case"granted":s.push({label:"Concours de la force publique accordé",date:e.policeGrantedAt});break;default:case null:s.push({label:"Concours de la force publique : NC"});break}let i,a;const n=[];if("open"===e.status?e.builtAt?(i="Existe",a=e.builtAt):e.declaredAt?(i="Signalé",a=e.declaredAt):(i=null,a=null):(i="Fermé",a=e.closedAt),null!==a){const{years:e,months:t}=pp(a);e>0&&n.push(`${e} an${e>1?"s":""}`),t>0&&n.push(t+" mois")}const o=e.closingSolutions.reduce((e,t)=>t.householdsAffected?(e||0)+t.householdsAffected:e,null);return{...e,statusName:i,statusDate:a,statusSince:n.join(" "),statusDetails:hp[e.status],fieldType:{...e.fieldType,color:this.fieldTypeColors[e.fieldType.id]},electricityType:{...e.electricityType,value:t},justiceStatuses:s,totalSolutions:o}},retryLoading(){this.load()},formatDate(...e){return window.App.formatDate.apply(window,e)},previousPage(){this.currentPage=Math.max(0,this.currentPage-1)},nextPage(){this.currentPage=Math.min(this.lastPage,this.currentPage+1)},routeToTown(e){const t=this.$router.resolve("/site/"+e.id);mo(t.href)},toggleFilter(e){this.currentFilter===e?this.currentFilter=null:this.currentFilter=e},hideFilter(){this.currentFilter=null},checkFieldType(e,t){return-1!==t.indexOf(e.fieldType.id)},checkPopulation(e,t){return t.some(t=>{if(null===t)return null===e.populationTotal;if(null===e.populationTotal)return!1;const[s,i]=t.split("-");return!(""!==s&&parseInt(s,10)>e.populationTotal)&&!(""!==i&&parseInt(i,10)<e.populationTotal)})},checkJustice(e,t){return t.some(t=>"ownerComplaint"===t?!0===e.ownerComplaint:!0===e.justiceRendered?"justiceRendered"===t:!0===e.justiceProcedure?"justiceProcedure"===t:null===t)},checkStatus(e,t){return-1!==t.indexOf(e.status)},showTowns(e){this.showClosedTowns!==("closed"===e)&&(this.showClosedTowns="closed"===e,this.currentPage=0,this.cleanFilters())},cleanFilters(){const e=["fieldFilterItems","populationFilterItems","justiceFilterItems","statusFilterItems"];e.forEach(e=>{for(let t=0;t<this[e].length;t+=1)this[e][t].checked=!1})},showExport(){setTimeout(()=>{this.exportIsVisible=!0},100)},hideExport(){this.exportIsVisible=!1},hasPermission(...e){return Io(...e)}}},fp=vp,_p=fp,gp=(s("4f37"),Object(d["a"])(_p,ip,ap,!1,null,"42c968f1",null)),bp=gp.exports,yp=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("PrivateLayout",[e.exportIsVisible?s("Export",{attrs:{towns:[],location:e.currentLocation,closedTowns:"open"!==e.filters.status},on:{close:e.hideExport}}):e._e(),s("div",{staticClass:"bg-G100"},[s("PrivateContainer",{staticClass:"py-6"},[s("h1",{staticClass:"text-display-md text-center mb-4"},[e._v(" Rechercher un site, une commune, un département... ? ")]),s("TownsListSearchBar",{attrs:{value:e.filters.location},on:{input:function(t){return e.updateFilters("location",t)}}})],1)],1),s("PrivateContainer",{staticClass:"pt-10"},[s("TownsListHeader",{staticClass:"mb-6",attrs:{search:e.filters.location}},[s("template",{slot:"filters"},[s("TownsListHeaderTab",{staticClass:"mr-8",attrs:{active:"open"===e.filters.status},on:{click:function(){return e.updateFilters("status","open")}}},[e._v("Sites existants")]),s("TownsListHeaderTab",{attrs:{active:"close"===e.filters.status},on:{click:function(){return e.updateFilters("status","close")}}},[e._v("Sites fermés")])],1),s("template",{slot:"title"},[s("div",{staticClass:"text-display-xl mb-2"},[e._v(e._s(e.title))]),e.isLoading?e._e():s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"mr-4"},[s("img",{attrs:{src:e.locationImg,width:"80",height:"80"}})]),s("div",[s("div",[s("div",[e._v(e._s(e.populationTotal)+" personnes")]),s("div",[e._v(" "+e._s(e.filteredShantytowns.length)+" sites "),e.hasJusticePermission&&e.justiceTotal.length?s("span",[e._v("dont "+e._s(e.justiceTotal)+" site(s) avec une procédure judiciaire")]):e._e()])])])])]),s("template",{slot:"buttons"},[s("Button",{staticClass:"mr-6 mb-2 md:mb-0",attrs:{icon:"file-excel",iconPosition:"left",variant:"primary"},on:{click:e.showExport}},[e._v("Exporter")]),e.hasPermission("shantytown.create")?s("router-link",{attrs:{to:"/nouveau-site"}},[s("Button",{staticClass:"whitespace-no-wrap",attrs:{icon:"plus",iconPosition:"left",variant:"secondary"}},[e._v(" Déclarer un nouveau site")])],1):e._e()],1)],2),e.isLoading?s("div",{staticClass:"text-center text-primary text-display-lg mt-16"},[s("Spinner")],1):s("div",[s("div",{staticClass:"md:flex items-end mb-4 justify-between"},[s("TownsListFilters",{},[s("TownsListFilter",{staticClass:"mr-2 mb-2",attrs:{title:"Nombre de personnes",value:e.filters.population,options:[{value:null,label:"Inconnu"},{value:"-9",label:"Moins de 10 personnes"},{value:"10-99",label:"Entre 10 et 99 personnes"},{value:"100-",label:"Plus de 100 personnes"}]},on:{input:function(t){return e.updateFilters("population",t)}}}),s("TownsListFilter",{staticClass:"mr-2 mb-2",attrs:{title:"Type de terrain",value:e.filters.fieldType,options:e.fieldTypes.map((function(e){return{label:e.label,value:e.id}}))},on:{input:function(t){return e.updateFilters("fieldType",t)}}}),s("TownsListFilter",{staticClass:"mr-2 mb-2",attrs:{title:"Procédure judiciaire",value:e.filters.justice,options:[{value:null,label:"Inconnu"},{value:"none",label:"Aucune"},{value:"ownerComplaint",label:"Plainte déposée"},{value:"justiceProcedure",label:"Procédure en cours"},{value:"justiceRendered",label:"Décision rendue"}]},on:{input:function(t){return e.updateFilters("justice",t)}}}),s("TownsListFilter",{staticClass:"mr-2 mb-2",attrs:{title:"Origine",value:e.filters.origin,options:[{value:1,label:"Français"},{value:2,label:"Union européenne"},{value:3,label:"Hors Union européenne"}]},on:{input:function(t){return e.updateFilters("origin",t)}}}),s("TownsListFilter",{staticClass:"mr-2 mb-2",attrs:{title:"Conditions de vie",value:e.filters.conditions,options:[{value:"accessToWater",label:"eau"},{value:"accessToElectricity",label:"électricité"},{value:"accessToTrash",label:"évac. des déchets"},{value:"accessToSanitary",label:"toilettes"}]},on:{input:function(t){return e.updateFilters("conditions",t)}},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.label;return[s("div",{staticClass:"text-red flex items-center"},[s("div",{staticClass:"mr-2"},[s("Icon",{attrs:{icon:"times"}}),e._v("/"),s("Icon",{staticClass:"text-xs",attrs:{icon:"question"}})],1),e._v(" "+e._s(i)+" ")])]}}],null,!1,1485956960)})],1),s("TownsListSort",{staticClass:"mb-2",attrs:{value:e.sort},on:{input:e.updateSort}})],1),s("div",[e._l(e.filteredShantytownsByPage,(function(e){return s("TownCard",{key:e.id,staticClass:"mb-6",attrs:{shantytown:e}})})),s("div",{staticClass:"flex flex-end mb-12"},[e.nbPages>1?s("Pagination",{staticClass:"mt-2 md:mt-0 ml-auto ",attrs:{currentPage:e.currentPage,nbPages:e.nbPages,onChangePage:e.onChangePage}}):e._e()],1)],2),e.filteredShantytowns.length?e._e():s("div",{staticClass:"text-center text-G600 italic pt-4"},[e._v(" Aucun site ne correspond à votre recherche, essayez d'autres filtres ou périmètre géographique ")])])],1)],1)},Cp=[],wp=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container px-4 mx-auto"},[e._t("default")],2)},xp=[],kp={},Pp=Object(d["a"])(kp,wp,xp,!1,null,null,null),Sp=Pp.exports,$p=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"v1"},[s("NavBar")],1),e._t("default")],2)},Tp=[],Ap={components:{NavBar:cr}},Ep=Ap,Op=Object(d["a"])(Ep,$p,Tp,!1,null,null,null),Ip=Op.exports,Dp=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["rounded-sm cursor-pointer border",e.isHover?"bg-blue100 border-transparent":""],on:{mouseenter:function(t){e.isHover=!0},mouseleave:function(t){e.isHover=!1}}},[s("router-link",{attrs:{to:"site-new/"+e.shantytown.id}},[s("div",{staticClass:"pt-6"},[s("div",{staticClass:"text-md px-6"},[s("div",{staticClass:"text-primary text-display-md "},[s("span",{staticClass:"font-bold"},[e._v(" "+e._s(e.shantytown.addressSimple)+" "),e.shantytown.name?s("span",[e._v("« "+e._s(e.shantytown.name)+" »")]):e._e()]),s("span",{staticClass:"font-normal"},[e._v(" "+e._s(e.shantytown.city.name)+" ")])])]),s("div",{staticClass:"md:grid cardGridTemplateColumns gap-10 px-6 py-4"},[s("div",[s("div",{staticClass:"flex items-center customAlign"},[s("Icon",{staticClass:"text-lg",style:"color: "+e.shantytown.fieldType.color,attrs:{icon:"map-marker-alt"}}),s("div",{staticClass:"font-bold ml-2"},[e._v(" "+e._s(e.shantytown.fieldType.label)+" ")])],1),s("div",{staticClass:"ml-5"},[s("div",[e._v(" "+e._s(e.shantytown.statusName)+" depuis "),s("br"),s("span",{staticClass:"font-bold"},[e._v(e._s(e.shantytown.statusSince))])])])]),s("div",[null===e.shantytown.populationTotal?s("div",{staticClass:"font-bold"},[e._v(" Population inconnue ")]):s("div",{staticClass:"text-lg font-bold flex items-center"},[s("div",{staticClass:"mr-2"},[e._v(" "+e._s(e.shantytown.populationTotal)+" ")]),s("div",[s("Icon",{attrs:{icon:"male"}}),e._v(e._s(" ")+" "),e.shantytown.populationTotal>=25?s("span",[s("Icon",{attrs:{icon:"male"}}),e._v(e._s(" "))],1):e._e(),e.shantytown.populationTotal>=75?s("span",[s("Icon",{attrs:{icon:"male"}}),e._v(e._s(" "))],1):e._e(),e.shantytown.populationTotal>=100?s("span",[s("Icon",{attrs:{icon:"male"}})],1):e._e()],1)]),e._l(e.shantytown.socialOrigins,(function(t){return s("div",{key:t.id,staticClass:"flex items-center"},[s("img",{staticClass:" w-6 mr-2",attrs:{src:e.socialOrigin(t).img}}),s("span",[e._v(e._s(e.socialOrigin(t).label))])])}))],2),s("div",[s("div",[s("TownCardIcon",{attrs:{value:e.shantytown.accessToWater}},[e._v("eau")]),s("TownCardIcon",{attrs:{value:e.shantytown.electricityType.value}},[e._v("électricité")]),s("TownCardIcon",{attrs:{value:e.shantytown.trashEvacuation}},[e._v("évac. des déchets")]),s("TownCardIcon",{attrs:{value:e.shantytown.accessToSanitary}},[e._v("toilettes")])],1)]),s("div",[e.shantytown.justiceStatuses&&e.shantytown.justiceStatuses.length?s("div",e._l(e.shantytown.justiceStatuses,(function(t){return s("div",{key:t.label,staticClass:"flex "},[t.icon?s("Icon",{attrs:{icon:t.icon}}):e._e(),t.img?s("img",{staticClass:"w-5 h-4 mt-1",attrs:{src:t.img}}):e._e(),s("div",{staticClass:"ml-2"},[s("span",{staticClass:"font-bold"},[e._v(e._s(t.label))]),t.date?s("span",{staticClass:"secondary"},[e._v(" le "+e._s(e.formatDate(t.date,"d/m/y")))]):e._e()])],1)})),0):s("div",{staticClass:"text-G600"},[s("Icon",{attrs:{icon:"ban"}}),e._v(" Aucune procédure judiciaire en cours ")],1)])]),s("div",{staticClass:"flex justify-between items-center px-4 pt-4 "},[s("Tag",{staticClass:"text-xs"},[e._v(" "+e._s(e.lastUpdate)+" ")]),s("div",[s("transition",{attrs:{name:"fade"}},[e.isHover?s("router-link",{attrs:{to:"site/"+e.shantytown.id}},[s("Button",{staticClass:"text-display-sm hover:underline -mb-1",attrs:{variant:"secondaryText",icon:"pen",iconPosition:"left"}},[e._v("Mettre à jour")])],1):e._e()],1),s("Button",{staticClass:"text-display-sm hover:underline -mb-1",attrs:{variant:"primaryText",icon:"arrow-right"}},[e._v("Voir la fiche du site")])],1)],1)])])],1)},jp=[],qp=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["flex items-center",e.color]},[s("div",{staticClass:"mr-2 w-4"},[!0===e.value?s("Icon",{attrs:{icon:"check"}}):e._e(),!1===e.value?s("Icon",{attrs:{icon:"times"}}):e._e(),null===e.value?s("Icon",{attrs:{icon:"question"}}):e._e()],1),e._t("default")],2)},Lp=[],Fp={props:{value:{validator:e=>"boolean"===typeof e||null===e}},computed:{color(){return!0===this.value?"text-green":"text-red"}}},Mp=Fp,Np=Object(d["a"])(Mp,qp,Lp,!1,null,null,null),zp=Np.exports,Bp=s("2416"),Rp=s.n(Bp),Vp=s("2b50"),Up=s.n(Vp),Hp=s("08c7"),Gp=s.n(Hp),Wp={props:{shantytown:{type:Object}},data(){return{isHover:!1}},components:{TownCardIcon:zp},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)},dateDiff(...e){return window.App.dateDiff.apply(window,e)},socialOrigin(e){return 1===e.id?{id:1,label:"Français",img:Up.a}:2===e.id?{id:2,label:"Européens",img:Rp.a}:3===e.id?{id:3,label:"Extra-communautaires",img:Gp.a}:e}},computed:{lastUpdate(){const e=new Date(1e3*this.shantytown.updatedAt),t=new Date;let s;if(s=12*(e.getFullYear()-t.getFullYear()),s+=s+(e.getMonth()-t.getMonth()),s=Math.abs(s),0===s){const i=Math.floor(Math.abs(t.getTime()-e.getTime())/864e5),a=Math.ceil(i/7);if(0===i)return"Dernière actualisation aujourd'hui";if(i>0&&i<7)return`Dernière actualisation il y a ${i} jours`;if(a>0&&0===s)return`Dernière actualisation il y a ${a} semaine${a>1?"s":""}`}return s<12?`Dernière actualisation il y a ${s} mois`:"Dernière actualisation il y a plus d'un an"}}},Yp=Wp,Jp=(s("1469"),Object(d["a"])(Yp,Dp,jp,!1,null,"a76812cc",null)),Qp=Jp.exports,Zp=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mx-auto searchbox -mb-6"},[s("AutocompleteV2",{attrs:{id:"test",defaultValue:this.$props.value?e.resultValue(this.$props.value):"",search:e.search,getResultValue:e.resultValue,loading:e.loading,prefixIcon:"search",inputClasses:["rounded-full shadow-sm"]},on:{submit:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"extra",fn:function(t){var i=t.removeItem;return[s("div",{staticClass:"py-1 px-2 text-right"},[s("Button",{staticClass:"font-bold",attrs:{variant:"primaryText",size:"sm"},on:{click:i}},[e._v("Voir tous les sites de France")])],1)]}},{key:"default",fn:function(t){var i=t.results,a=t.resultListProps,n=t.resultListListeners,o=t.resultProps,r=t.getResultValue;return[i.length?e._e():s("Menu",[s("MenuItem",[e._v(" Aucun résultats ")])],1),s("Menu",e._g(e._b({},"Menu",a,!1),n),e._l(e.getCategories(i),(function(t){return s("div",{key:t.label,staticClass:"flex flex-row border-b-2 border-G100"},[s("div",{staticClass:"px-4 py-2 w-48 text-G600 border-r-2 border-G100 text-sm text-right pr-4"},[e._v(" "+e._s(t.label)+" ")]),s("div",{staticClass:"flex-1"},e._l(i,(function(i,a){return s("MenuItem",e._b({key:o[a].id,class:["flex flex-col cursor-pointer hover:bg-G100",i.type===t.label?"block":"hidden",o[a]["aria-selected"]&&"bg-G100"]},"MenuItem",o[a],!1),[e._v(" "+e._s(r(i))+" ")])})),1)])})),0)]}}]),model:{value:e.result,callback:function(t){e.result=t},expression:"result"}})],1)},Kp=[],Xp={props:{value:{type:Object}},data(){return{input:"test",result:"",results:[],loading:!1}},methods:{onSubmit(){alert(this.result)},resultValue(e){return e.label},getCategories(e){const t=(e,t)=>e.reduce((e,s)=>({...e,[s[t]]:[...e[s[t]]||[],s]}),{});return Object.values(t(e,"type")).map(e=>({label:e[0].type,items:e}))},async search(e){return this.input=e,e?(this.loading=!0,this.results=await Ar(e),this.loading=!1,this.results):[]}}},em=Xp,tm=(s("a8bd"),Object(d["a"])(em,Zp,Kp,!1,null,"929c41c2",null)),sm=tm.exports,im=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"block md:flex justify-between items-baseline"},[s("div",[s("div",{staticClass:"flex items-center mb-4"},[e._t("filters")],2),s("div",[e._t("title")],2)]),s("div",{staticClass:"block md:flex items-center"},[e._t("buttons")],2)])},am=[],nm={props:{search:{type:Object},showExport:{type:Function}}},om=nm,rm=Object(d["a"])(om,im,am,!1,null,null,null),lm=rm.exports,cm=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",e._g({class:["border-b-2 pb-1",e.active?"text-primary font-bold border-primary":"cursor-pointer border-transparent"]},e.$listeners),[e._t("default")],2)},dm=[],um={props:{active:{type:Boolean}}},pm=um,mm=Object(d["a"])(pm,cm,dm,!1,null,null,null),hm=mm.exports,vm=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"mb-2"},[e._v("Filtrer par")]),s("div",{staticClass:"flex items-center flex-wrap"},[e._t("default")],2)])},fm=[],_m={},gm=Object(d["a"])(_m,vm,fm,!1,null,null,null),bm=gm.exports,ym=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Dropdown",{scopedSlots:e._u([{key:"button",fn:function(t){var i=t.isOpen;return[s("Button",{class:["px-4 rounded focus:outline-none border border-primary whitespace-nowrap",i?"bg-primary text-white hover:text-white focus:text-white":"hover:bg-blue200 hover:text-primary text-primary"],attrs:{variant:"custom",size:"sm",icon:i?"chevron-up":"chevron-down",iconPosition:"right"}},[e._v(e._s(e.titleWithActiveFilters))])]}},{key:"menu",fn:function(){return[s("Menu",{attrs:{containerClasses:"py-0"}},[e._l(e.options,(function(t){return s("div",{key:t.id,staticClass:"flex items-center whitespace-no-wrap text-sm menuWidth"},[s("Checkbox",{attrs:{checkValue:t.value,value:e.value,variant:"invisible",containerClasses:"w-full",labelClasses:"w-full block"},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.isChecked;return[s("div",{staticClass:"flex items-center justify-between w-full  hover:bg-blue200 py-2 px-3 text-primary"},[e._t("default",[s("div",{staticClass:"flex-1"},[e._v(e._s(t.label))])],{label:t.label}),a?s("div",{staticClass:"ml-4"},[s("Icon",{attrs:{icon:"check"}})],1):e._e()],2)]}}],null,!0)})],1)})),s("div",{staticClass:"px-1 py-1 border-t "},[s("Button",{staticClass:"hover:underline",attrs:{size:"sm",variant:"primaryText"},on:{click:function(t){return e.$emit("input",[])}}},[e._v(" Effacer ")])],1)],2)]},proxy:!0}])})},Cm=[],wm={props:{title:{type:String},options:{type:Array},value:{type:Array}},computed:{titleWithActiveFilters(){return this.value.length?`${this.title} (${this.value.length})`:this.title}}},xm=wm,km=(s("30a5"),Object(d["a"])(xm,ym,Cm,!1,null,"defa5cd8",null)),Pm=km.exports;function Sm(e,t){return e.filter(e=>("open"!==t.status||"open"===e.status)&&(("close"!==t.status||"open"!==e.status)&&(!(t.location&&!Am(e,t))&&(!(t.fieldType.length>0&&!Em(e,t.fieldType))&&(!(t.population.length>0&&!Om(e,t.population))&&(!(t.justice.length>0&&!Im(e,t.justice))&&(!(t.origin.length>0&&!Tm(e,t.origin))&&!(t.conditions.length>0&&!$m(e,t.conditions)))))))))}function $m(e,t){return t.some(t=>"accessToSanitary"===t?!e.accessToSanitary:"accessToWater"===t?!e.accessToWater:"accessToTrash"===t?!e.trashEvacuation:"accessToElectricity"!==t||!e.electricityType.value)}function Tm(e,t){if(!e.socialOrigins)return!1;const s=e.socialOrigins.map(e=>e.id),i=s.filter(e=>t.includes(e));return i.length}function Am(e,t){if("nation"===t.location.type)return!0;const s=e[t.location.locationType];return!s||(s.code===""+t.location.code||s.main===""+t.location.code)}function Em(e,t){return-1!==t.indexOf(e.fieldType.id)}function Om(e,t){return t.some(t=>{if(null===t)return null===e.populationTotal;if(null===e.populationTotal)return!1;const[s,i]=t.split("-");return!(""!==s&&parseInt(s,10)>e.populationTotal)&&!(""!==i&&parseInt(i,10)<e.populationTotal)})}function Im(e,t){return t.some(t=>"ownerComplaint"===t?!0===e.ownerComplaint:!0===e.justiceRendered?"justiceRendered"===t:!0===e.justiceProcedure?"justiceProcedure"===t:null===t)}var Dm=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{staticClass:"modalContainer",attrs:{isOpen:!0,closeModal:e.close,closeClickOutside:""},scopedSlots:e._u([{key:"header",fn:function(){return[s("div",{staticClass:"pt-10 px-10 pb-4 flex justify-between border-b border-G200"},[s("div",{staticClass:"text-primary"},[s("div",{staticClass:"text-display-md text-primary"},[e._v(" Exporter les sites existants ")]),s("div",{staticClass:"font-bold mt-2"},[e._v(e._s(e.location.label))])]),s("div",{staticClass:"ml-16"},[s("Button",{attrs:{variant:"primaryOutline"},on:{click:e.close}},[e._v(" Annuler")]),s("Button",{staticClass:"ml-6",on:{click:e.download}},[e._v("Exporter")])],1)])]},proxy:!0},{key:"body",fn:function(){return[s("div",[s("div",{staticClass:"font-bold mb-1"},[e._v(" Les données exportées par défaut ")]),s("ul",[s("li",[e._v("- Localisation : département, commune, adresse")]),s("li",[e._v(" - Site : type de site (terrain / bâti), date d’installation, date de signalement ")]),s("li",[e._v(" - Habitants : nombre de personnes, mineurs, ménages et origines ")]),e.closedTowns?s("li",[e._v(" - Orientations des ménages après la fermeture ")]):e._e(),s("li",[e._v("- Date de la dernière mise à jour")])])]),s("div",{staticClass:"mt-4"},[s("p",{staticClass:"font-bold mb-1"},[e._v(" Cochez les informations supplémentaires que vous souhaitez exporter ")]),e._l(e.availableOptions,(function(t){return s("Checkbox",{key:t.id,attrs:{checkValue:t.id,label:t.label+" "+(t.description||"")},model:{value:e.options,callback:function(t){e.options=t},expression:"options"}})}))],2)]},proxy:!0}])})},jm=[],qm={components:{Checkbox:et},props:{location:Object,closedTowns:Boolean},data(){return{existingOptions:[{id:"priority",label:"Priorité",description:"(1, 2, 3)",closedTowns:!1},{id:"address_details",label:"Informations d'accès au site",closedTowns:!1},{id:"owner",label:"Propriétaire",description:": type et identité"},{id:"life_conditions",label:"Conditions de vie",description:": accès à l'électricité, l'eau, toilettes, évacuation des déchets"},{id:"demographics",label:"Diagnostic",description:": statut, date, et service en charge"},{id:"justice",label:"Procédures judiciaires",description:": statut et date des étapes",permission:{entity:"shantytown",feature:"export",data:"justice"}},{id:"comments",label:"Commentaires",description:": les 5 derniers",permission:{entity:"shantytown_comment",feature:"list",data:null}},{id:"covid_comments",label:"Commentaires Covid-19",permission:{entity:"covid_comment",feature:"list",data:null}}],options:[]}},computed:{title(){return this.closedTowns?"fermés":"existants"},availableOptions(){return this.existingOptions.filter(({closedTowns:e})=>void 0===e||this.closedTowns===e).filter(({permission:e})=>{if(void 0===e)return!0;const t=Oo(`${e.entity}.${e.feature}`);return null!==t&&(null===e.data||!0===t["data_"+e.data])})}},methods:{download(){const{code:e,type:t}=this.location.data;let s=`https://api.resorption-bidonvilles.beta.gouv.fr/towns/export?locationType=${encodeURIComponent(t)}&locationCode=${encodeURIComponent(e)}&closedTowns=${this.closedTowns?"1":"0"}`;this.options.length>0&&(s+="&options="+encodeURIComponent(this.options.join(","))),ko(s)},close(){this.$emit("close")}}},Lm=qm,Fm=Object(d["a"])(Lm,Dm,jm,!1,null,null,null),Mm=Fm.exports,Nm=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"mb-2"},[e._v("Trier par")]),s("div",{staticClass:"flex items-center"},[s("Dropdown",{scopedSlots:e._u([{key:"button",fn:function(t){var i=t.isOpen;return[s("Button",{class:["px-4 rounded focus:outline-none border border-primary whitespace-nowrap ",i?"bg-primary text-white hover:text-white focus:text-white":"hover:bg-blue200 hover:text-primary text-primary"],attrs:{variant:"custom",size:"sm",icon:i?"chevron-up":"chevron-down",iconPosition:"right"}},[e._v(e._s(e.title)+" ")])]}},{key:"menu",fn:function(){return[s("Menu",{attrs:{containerClasses:"py-0"}},e._l(e.options,(function(t){return s("div",{key:t.id,staticClass:"flex items-center whitespace-no-wrap text-sm menuWidth"},[s("Radio",{attrs:{checkValue:t.value,value:e.value,variant:"invisible",containerClasses:"w-full",labelClasses:"w-full block"},on:{input:function(t){return e.$emit("input",t)}},scopedSlots:e._u([{key:"default",fn:function(i){var a=i.isChecked;return[s("div",{staticClass:"flex items-center justify-between w-full  hover:bg-blue200 py-2 px-3 text-primary"},[s("div",{staticClass:"flex-1"},[e._v(e._s(t.label))]),a?s("div",{staticClass:"ml-4"},[s("Icon",{attrs:{icon:"check"}})],1):e._e()])]}}],null,!0)})],1)})),0)]},proxy:!0}])})],1)])},zm=[],Bm={props:{value:{type:Array}},data(){return{options:[{value:"builtAt",label:"Date d'installation"},{value:"updatedAt",label:"Date d'actualisation"},{value:"createdAt",label:"Date de signalement"}]}},computed:{title(){const e=this.options.find(e=>e.value===this.value);return e.label}}},Rm=Bm,Vm=(s("ccb6"),Object(d["a"])(Rm,Nm,zm,!1,null,"75c57cfa",null)),Um=Vm.exports,Hm=s("2f62"),Gm=s("ccab"),Wm=s.n(Gm);function Ym(e,t){const s=t.reduce((e,t)=>Object.assign(e,{[t.id]:t.color}),{});let i=!0;"Inconnu"===e.electricityType.label?i=null:"Non"===e.electricityType.label&&(i=!1);const a=[];switch(!0===e.ownerComplaint&&a.push({icon:"scroll",label:"Plainte déposée"}),!e.justiceProcedure||e.justiceChallenged||e.justiceRendered||a.push({icon:"balance-scale",label:"Procédure en cours"}),e.justiceProcedure&&e.justiceRendered&&a.push({icon:"balance-scale",label:"Décision rendue",date:e.justiceRenderedAt}),e.justiceProcedure&&!0===e.justiceChallenged&&a.push({icon:"balance-scale",label:"Contentieux"}),e.policeStatus){case"none":a.push({img:Wm.a,label:"Concours de la force publique non demandé"});break;case"requested":a.push({img:Wm.a,label:"Concours de la force publique demandé",date:e.policeRequestedAt});break;case"granted":a.push({img:Wm.a,label:"Concours de la force publique accordé",date:e.policeGrantedAt});break;default:case null:break}let n,o;const r=[];if("open"===e.status?e.builtAt?(n="Existe",o=e.builtAt):e.declaredAt?(n="Signalé",o=e.declaredAt):(n=null,o=null):(n="Fermé",o=e.closedAt),null!==o){const{years:e,months:t}=Jm(o);e>0&&r.push(`${e} an${e>1?"s":""}`),e>0&&t>0&&r.push("et"),t>0&&r.push(t+" mois")}const l=e.closingSolutions.reduce((e,t)=>t.householdsAffected?(e||0)+t.householdsAffected:e,null);return{...e,statusName:n,statusDate:o,statusSince:r.join(" "),statusDetails:Qm[e.status],fieldType:{...e.fieldType,color:s[e.fieldType.id]},electricityType:{...e.electricityType,value:i},justiceStatuses:a,totalSolutions:l}}function Jm(e){const t=new Date,s=new Date(1e3*e);let i=0;if(t.getFullYear()===s.getFullYear())i=Math.max(0,t.getMonth()-s.getMonth());else if(t.getFullYear()>s.getFullYear()){const e=t.getFullYear()-s.getFullYear();i=12*(e-1)+(t.getMonth()+12-s.getMonth())}return{years:Math.floor(i/12),months:i%12}}const Qm={closed_by_justice:"Exécution d'une décision de justice",closed_by_admin:"Exécution d'une décision administrative",other:"Autre",unknown:"Raison inconnue"};i["default"].use(Hm["a"]);var Zm=new Hm["a"].Store({state:{towns:{data:[],loading:!0,error:null,sort:"createdAt",filters:{population:[],fieldType:[],justice:[],origin:[],conditions:[],status:"open",location:null},currentPage:1}},mutations:{setLoading(e,t){e.towns.loading=t},setTowns(e,t){e.towns.data=t},setError(e,t){e.towns.error=t},setSort(e,t){e.towns.sort=t},setFilters(e,t){e.towns.filters=t},setCurrentPage(e,t){e.towns.currentPage=t}},actions:{async fetchTowns({commit:e}){e("setLoading",!0);try{const{field_types:t}=Ao(),s=await sl(),i=s.map(e=>Ym(e,t));e("setTowns",i),e("setLoading",!1)}catch(t){e("setError",t),e("setLoading",!1)}}},getters:{towns:e=>e.towns.data,townsLoading:e=>e.towns.loading,townsError:e=>e.towns.error,townsFilters:e=>e.towns.filters,townsSort:e=>e.towns.sort,townsCurrentPage:e=>e.towns.currentPage}});const Km=20;var Xm={components:{TownsListSort:Um,Spinner:Is,TownCard:Qp,PrivateContainer:Sp,PrivateLayout:Ip,TownsListSearchBar:sm,TownsListHeader:lm,TownsListHeaderTab:hm,TownsListFilters:bm,TownsListFilter:Pm,Export:Mm},data(){const{field_types:e}=Ao(),t=Oo("shantytown.list");return{hasNationalPermission:"nation"===t.geographic_level,hasJusticePermission:!0===t.data_justice,fieldTypes:e,exportIsVisible:!1}},methods:{updateSort(e){Zm.commit("setSort",e)},updateFilters(e,t){Zm.commit("setFilters",{...this.filters,[e]:t})},onChangePage(e){Zm.commit("setCurrentPage",e)},hasPermission(...e){return Io(...e)},load(){this.shantytowns.length||Zm.dispatch("fetchTowns")},showExport(){setTimeout(()=>{this.exportIsVisible=!0},100)},hideExport(){this.exportIsVisible=!1}},created(){this.load()},computed:{...Object(Hm["b"])({shantytowns:"towns",isLoading:"townsLoading",error:"townsError",filters:"townsFilters",sort:"townsSort",currentPage:"townsCurrentPage"}),locationImg(){const e=["01","02","03","04","06"],t=this.filters.location,s=t&&"Région"===t.type,i=s&&e.includes(t.code),a=!s&&t&&!t.departement;return!t||a||i?"/img/regions/fallback.svg":s?`/img/regions/${this.filters.location.code}.svg`:`/img/departements/${this.filters.location.departement}.svg`},currentLocation(){return this.filters.location||{id:null,label:"France",category:"Pays",data:{code:null,type:"nation"}}},populationTotal(){return this.filteredShantytowns.reduce((e,{populationTotal:t})=>e+(t||0),0)},justiceTotal(){return this.filteredShantytowns.filter(({justiceProcedure:e})=>!0===e).length},filteredShantytowns(){return Sm(this.shantytowns,this.filters).sort((e,t)=>t[this.sort]-e[this.sort])},filteredShantytownsByPage(){return this.filteredShantytowns.slice((this.currentPage-1)*Km,Km*this.currentPage)},title(){return this.currentLocation.code?""+this.currentLocation.label:"France métropolitaine"},nbPages(){return Math.ceil(this.filteredShantytowns.length/Km)}}},eh=Xm,th=Object(d["a"])(eh,yp,Cp,!1,null,null,null),sh=th.exports,ih=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("Form",e._b({ref:"form",on:{complete:e.onComplete,stepcomplete:e.onStepComplete},model:{value:e.data,callback:function(t){e.data=t},expression:"data"}},"Form",e.formDefinition,!1))],1)])},ah=[],nh={components:{NavBar:cr,Form:Hc},data(){const{field_types:e,owner_types:t,social_origins:s,electricity_types:i}=Ao(),a=[{value:"none",label:"Non prévu"},{value:"scheduled",label:"Prévu"},{value:"done",label:"Réalisé"},{value:null,label:"Inconnu"}],n=[{value:1,label:"Oui"},{value:0,label:"Non"},{value:-1,label:"Inconnu"}],o=[{value:"none",label:"Non demandé"},{value:"requested",label:"Demandé"},{value:"granted",label:"Obtenu"},{value:null,label:"Inconnu"}],r={title:"Déclaration d'un site",description:"Ce formulaire vous permet de déclarer un site identifié sur votre territoire (bidonville ou squat). Il est divisé en quatre onglets : caractéristiques, démographie, conditions de vie et procédure judiciaire d'expulsion des occupants. Lorsque le symbole (*) apparaît en rouge au début de l'intitulé de la question, cela signifie qu'il s'agit d'une question obligatoire. Il n'est pas possible de valider le formulaire sans y avoir répondu.",steps:[{title:"Caractéristiques du site",sections:[{title:"Caractéristiques",inputs:{address:{type:"addressWithLocation",label:"Localisation géographique",description:"Saisissez ici l'adresse du site, puis précisez sa position en déplaçant le point sur la carte.",mandatory:!0},name:{type:"text",label:"Appellation du site",description:"Exemples : Entrepôt de la Poste, Rond-point du centre...",mandatory:!1,specificProps:{maxlength:35}},detailed_address:{type:"text",label:"Informations d'accès",description:"Saisissez ici toutes les informations qui, en plus de l'adresse, peuvent être utiles pour l'accès au site.",mandatory:!1},priority:{type:"radio",options:[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3}],label:"Niveau de priorité du site",description:"1 étant le niveau de priorité le plus haut.<br/>Le niveau de priorité est un indicateur réservé aux correspondants des services de l’État.",mandatory:!1},built_at:{type:"date",label:"Date d'installation du site",mandatory:!0},declared_at:{type:"date",label:"Date de signalement du site",mandatory:!1},field_type:{type:"radio",options:e.map(({id:e,label:t})=>({label:t,value:e})),label:"Type de site",mandatory:!0},owner_type:{type:"radio",options:t.map(({id:e,label:t})=>({label:t,value:e})),label:"Type de propriétaire",mandatory:!0},owner:{type:"text",label:"Identité du propriétaire",condition({owner_type:e}){return e&&"Inconnu"!==t.find(({id:t})=>t===e).label}}}},{title:"Habitants",inputs:{census_status:{type:"radio",options:a,label:"Statut du diagnostic social",description:"Un diagnostic social vise à identifier les situations et besoins des familles et personnes, de repérer le contexte territorial et les acteurs en présence.",mandatory:!0},census_conducted_at:{type:"date",label:"Date du diagnostic",mandatory:!0,condition({census_status:e}){return-1!==["scheduled","done"].indexOf(e)}},census_conducted_by:{type:"text",label:"Service ou opérateur en charge du diagnostic",mandatory:!0,condition({census_status:e}){return-1!==["scheduled","done"].indexOf(e)}},population_total:{type:"number",label:"Nombre de personnes",description:"Laissez ce champ vide si l'information est inconnue",mandatory:!1},population_couples:{type:"number",label:"Nombre de ménages",description:"Laissez ce champ vide si l'information est inconnue",mandatory:!1},population_minors:{type:"number",label:"Nombre de mineurs",description:"Laissez ce champ vide si l'information est inconnue",mandatory:!1},social_origins:{type:"checkbox",options:s.map(({id:e,label:t})=>({label:t,value:e})),label:"Origines",description:"Ne rien cocher si l'information est inconnue",mandatory:!1}}},{title:"Conditions de vie",inputs:{electricity_type:{type:"radio",options:i.map(({id:e,label:t})=>({label:t,value:e})),label:"Accès à l'électricité",mandatory:!0},electricity_comments:{type:"textarea",label:"Modalités d'accès",description:"Exemples : groupe électrogène, raccordement à une usine...",mandatory:!1},access_to_water:{type:"radio",options:n,label:"Accès à l'eau",mandatory:!0},water_comments:{type:"textarea",label:"Modalités d'accès",description:"Exemples: Citerne de 100 litres remplie par les pompiers tous les jours, 3 robinets raccordés par la collectivité, borne incendie à 200 mètres...",mandatory:!1},access_to_sanitary:{type:"radio",options:n,label:"Accès à des toilettes",mandatory:!0},sanitary_comments:{type:"textarea",label:"Modalités d'accès",description:"Exemples : 3 toilettes sèches, toilettes raccordés au réseau, un bloc sanitaire fourni par la ville...",mandatory:!1},trash_evacuation:{type:"radio",options:n,label:"Évacuation des déchets",mandatory:!0}}},...Io("shantytown.create.data_justice")?[{title:"Procédure judiciaire d'expulsion des occupants",inputs:{owner_complaint:{type:"radio",options:n,label:"Dépôt de plainte par le propriétaire",mandatory:!0},justice_procedure:{type:"radio",options:n,label:"Existence d'une procédure judiciaire",mandatory:!0},justice_rendered:{type:"radio",options:n,label:"Décision de justice rendue",mandatory:!0,condition({justice_procedure:e}){return 1===e}},justice_rendered_by:{type:"text",label:"Origine de la décision",mandatory:!0,condition({justice_procedure:e,justice_rendered:t}){return 1===e&&1===t}},justice_rendered_at:{type:"date",label:"Date de la décision",mandatory:!0,condition({justice_procedure:e,justice_rendered:t}){return 1===e&&1===t}},justice_challenged:{type:"radio",options:n,label:"Contentieux relatif à la décision de justice",mandatory:!0,condition({justice_procedure:e,justice_rendered:t}){return 1===e&&1===t}},police_status:{type:"radio",options:o,label:"Concours de la force publique",mandatory:!0},police_requested_at:{type:"date",label:"Date de la demande du CFP",mandatory:!0,condition({police_status:e}){return-1!==["requested","granted"].indexOf(e)}},police_granted_at:{type:"date",label:"Date d'octroi du CFP",mandatory:!0,condition({police_status:e}){return"granted"===e}},bailiff:{type:"text",label:"Nom de l'étude d'huissiers",mandatory:!1}}}]:[]],wording:{submit:"Déclarer le site",error:"La déclaration du site a échoué",success:"La déclaration du site a réussi"},submit:e=>{const t=["built_at","declared_at","census_conducted_at","justice_rendered_at","police_requested_at","police_granted_at"];t.forEach(t=>{const s=e[t];s&&Object.assign(e,{[t]:`${s.getFullYear()}-${(""+(s.getMonth()+1)).padStart(2,"0")}-${(""+s.getDate()).padStart(2,"0")}`})});const s=al(e);return s.then(({plans:e})=>{r.steps[1].sections[0].inputs.plans.options=e.map(({id:e,name:t,type:s})=>({label:t||s,value:e}))}),s}}]};return{data:{},formDefinition:r}},methods:{onStepComplete(e,t){0===e&&(t.plans&&0!==t.plans.length||this.$nextTick(()=>{this.$refs.form.goToNextStep(null)}))},onComplete(e,[{town:{id:t}}]){this.$router.push("/site/"+t)}}},oh=nh,rh=oh,lh=(s("5a39"),Object(d["a"])(rh,ih,ah,!1,null,"40c10962",null)),ch=lh.exports,dh=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("NavBar"),e.loading||e.error?s("section",{staticClass:"section section-white"},[e.loading||e.error?s("div",{staticClass:"container"},[e.loading?s("div",[e._m(0)]):e.error?s("div",[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.fetchData}},[e._v("Réessayer ?")])])])]):e._e()]):e._e()]):s("section",{ref:"wrapper",staticClass:"section section-white town-wrapper"},[null!==e.commentToBeDeleted?s("CommentDeletion",{ref:"commentDeletionPopin",attrs:{comment:e.commentToBeDeleted},on:{close:e.closeCommentDeletion,deleted:e.onCommentDeleted}}):e._e(),"close"===e.mode?s("div",{staticClass:"popin"},[s("div",{ref:"wrapper",staticClass:"popin-wrapper"},[s("div",[s("p",{staticClass:"popin-close"},[s("span",{staticClass:"link",on:{click:e.closePopin}},[s("font-awesome-icon",{attrs:{icon:"times",size:"2x"}})],1)]),s("section",[s("h2",[e._v("Disparition du site")]),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.closed_at}},[e._v("Date de disparition du site :")]),e.fieldErrors.closed_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.closed_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"clear-button":!0,language:e.dateLanguage,"monday-first":!0,"disabled-dates":{from:new Date},"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.edit.closedAt,callback:function(t){e.$set(e.edit,"closedAt",t)},expression:"edit.closedAt"}})],1),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.closed_with_solutions}},[s("strong",[e._v("Est-ce que ce site a été résorbé définitivement ? :")])]),s("p",{staticClass:"question-info"},[e._v("C’est-à-dire sans réinstallation illicite et avec un accompagnement de la majorité des personnes vers des solutions pérennes")]),e.fieldErrors.closed_with_solutions?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.closed_with_solutions,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.closedWithSolutionsValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.closedWithSolutions,expression:"edit.closedWithSolutions"}],attrs:{type:"radio",name:"closed_with_solutions",id:"status"+i},domProps:{value:t.value,checked:e._q(e.edit.closedWithSolutions,t.value)},on:{change:function(s){return e.$set(e.edit,"closedWithSolutions",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"status"+i}},[e._v(e._s(t.label))])])}))],2)]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.status}},[s("strong",[e._v("Cause de la disparition :")])]),e.fieldErrors.status?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.status,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.statusValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.status,expression:"edit.status"}],attrs:{type:"radio",name:"status",id:"status"+i},domProps:{value:t.value,checked:e._q(e.edit.status,t.value)},on:{change:function(s){return e.$set(e.edit,"status",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"status"+i}},[e._v(e._s(t.label))])])}))],2)]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.solutions}},[s("strong",[e._v("Orientations des ménages :")])]),e._l(e.closingSolutions,(function(t,i){return s("fieldset",[s("legend",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.solutions[t.id].checked,expression:"edit.solutions[value.id].checked"}],attrs:{type:"checkbox",name:"closingSolution",id:"closingSolution"+i},domProps:{value:t.id,checked:Array.isArray(e.edit.solutions[t.id].checked)?e._i(e.edit.solutions[t.id].checked,t.id)>-1:e.edit.solutions[t.id].checked},on:{change:function(s){var i=e.edit.solutions[t.id].checked,a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=t.id,r=e._i(i,o);a.checked?r<0&&e.$set(e.edit.solutions[t.id],"checked",i.concat([o])):r>-1&&e.$set(e.edit.solutions[t.id],"checked",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.edit.solutions[t.id],"checked",n)}}}),s("label",{staticClass:"label-inline",attrs:{for:"closingSolution"+i}},[e._v(e._s(t.label))])]),s("div",{staticClass:"solution-people",class:{visible:e.edit.solutions[t.id].checked}},[e.fieldErrors.solutions&&e.fieldErrors.solutions[t.id]?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.solutions[t.id],(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Nombre de ménages concernés :"),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.solutions[t.id].householdsAffected,expression:"edit.solutions[value.id].householdsAffected"}],attrs:{type:"number"},domProps:{value:e.edit.solutions[t.id].householdsAffected},on:{input:function(s){s.target.composing||e.$set(e.edit.solutions[t.id],"householdsAffected",s.target.value)}}})]),s("p",[e._v("Nombre de personnes concernées :"),s("br"),s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.solutions[t.id].peopleAffected,expression:"edit.solutions[value.id].peopleAffected"}],attrs:{type:"number"},domProps:{value:e.edit.solutions[t.id].peopleAffected},on:{input:function(s){s.target.composing||e.$set(e.edit.solutions[t.id],"peopleAffected",s.target.value)}}})])])])}))],2)]),e.editError?s("div",{staticClass:"notification error"},[e._v(e._s(e.editError)+".")]):e._e(),s("div",{staticClass:"form__group"},[s("button",{staticClass:"button",on:{click:e.submitClose}},[e._v("Valider")]),s("button",{staticClass:"button secondary",on:{click:e.closePopin}},[e._v("Annuler")])])])])])]):e._e(),s("header",{ref:"header",staticClass:"town-header"},[s("div",{staticClass:"container"},[s("div",{staticClass:"town-name"},[s("div",{staticClass:"town-reference"},[s("h1",[s("span",{attrs:{"data-cy-data":"address"}},[e._v("Site "+e._s(e.town.addressSimple))]),e._v(" "),e.town.name?s("span",{staticClass:"town-usename",attrs:{"data-cy-data":"name"}},[e._v("« "+e._s(e.town.name)+" »")]):e._e(),s("span",{class:"town-status "+e.town.status},[e._v(e._s(e.status))])]),s("h2",[s("span",{attrs:{"data-cy-data":"city"}},[e._v(e._s(e.town.city.name))])])]),s("div",{staticClass:"town-actionButtons"},["open"===e.town.status&&"edit"!==e.mode&&e.hasPermission("shantytown.close",e.town)?s("button",{staticClass:"button secondary",on:{click:e.setCloseMode}},[e._v("Fermer le site")]):e._e(),"open"===e.town.status&&"edit"!==e.mode&&e.hasPermission("shantytown.update",e.town)?s("button",{staticClass:"button",on:{click:e.setEditMode}},[e._v("Mettre à jour")]):e._e(),"edit"!==e.mode&&e.hasPermission("shantytown.delete",e.town)?s("button",{staticClass:"button warning",attrs:{"data-cy-button":"delete"},on:{click:e.destroy}},[e._v("Supprimer le site")]):e._e(),"edit"===e.mode?s("button",{staticClass:"button",on:{click:e.submit}},[e._v("Sauvegarder")]):e._e(),"edit"===e.mode?s("button",{staticClass:"button warning",on:{click:e.setViewMode}},[e._v("Annuler")]):e._e()])]),s("div",{staticClass:"town-info"},[e.town.changelog.length>0?s("p",{staticClass:"town-links"},[s("span",{staticClass:"link",attrs:{"data-group":"sidePanelLink"},on:{click:function(t){return e.showAside("changelog")}}},[s("font-awesome-icon",{attrs:{icon:"history"}}),e._v(" Modifié le "+e._s(e.formatDate(e.town.updatedAt,"d M y"))+" - voir l'historique")],1)]):e._e(),e.hasPermission("shantytown_comment.list",e.town)?s("p",{staticClass:"town-links"},[s("span",{staticClass:"link",attrs:{"data-group":"sidePanelLink"},on:{click:function(t){return e.showAside("comments")}}},[s("font-awesome-icon",{attrs:{icon:"comment"}}),e._v(" "+e._s(e.town.comments.regular.length)+" commentaire"+e._s(e.town.comments.regular.length>1?"s":""))],1)]):e._e(),e.hasPermission("covid_comment.list")?s("p",{staticClass:"town-links town-links--covid"},[s("span",{staticClass:"link",attrs:{"data-group":"sidePanelLink"},on:{click:function(t){return e.showAside("covidComments")}}},[s("font-awesome-icon",{attrs:{icon:"comment"}}),e._v(" "+e._s(e.town.comments.covid.length)+" commentaire"+e._s(e.town.comments.covid.length>1?"s":"")+" COVID-19")],1)]):e._e()])])]),s("div",{ref:"main",staticClass:"town-main"},[s("div",{staticClass:"sidepanel",class:{"sidepanel--visible":null!==e.sidePanel}},[s("div",{staticClass:"sidepanel-shadow"}),s("div",{ref:"aside",staticClass:"sidepanel-wrapper"},[s("div",{staticClass:"sidepanel-actions"},[s("span",{on:{click:e.hideAside}},[s("font-awesome-icon",{attrs:{icon:"times",size:"2x"}})],1)]),"changelog"===e.sidePanel?s("div",[s("header",{staticClass:"sidepanel-header"},[s("h1",{staticClass:"sidepanel-title"},[s("font-awesome-icon",{attrs:{icon:"history"}}),e._v(" Historique des modifications")],1)]),s("div",{staticClass:"sidepanel-content"},e._l(e.town.changelog,(function(t){return s("div",{staticClass:"sidepanel-section"},[s("article",{staticClass:"userpost userpost--changelog"},[s("header",{staticClass:"userpost-header"},[e._v("changelog "),s("p",{staticClass:"userpost-date"},[s("time",[e._v(e._s(e.formatDate(t.date,"d M y à h:i")))])]),s("h1",{staticClass:"userpost-title"},[s("router-link",{attrs:{to:"/annuaire/"+t.author.organization.id}},[s("font-awesome-icon",{attrs:{icon:"user"}}),s("span",[e._v(e._s(t.author.last_name.toUpperCase())+" "+e._s(t.author.first_name))])],1)],1)]),e._l(t.diff,(function(t){return s("p",{staticClass:"changelog"},[s("span",{staticClass:"changelog-name"},[e._v(e._s(t.field)+" :")]),s("br"),s("span",{staticClass:"changelog-oldValue",class:{"changelog-value--unknown":!t.oldValue}},[e._v(e._s(t.oldValue||"non renseigné"))]),e._v(", "),s("span",{staticClass:"changelog-newValue",class:{"changelog-value--unknown":!t.newValue}},[e._v(e._s(t.newValue||"non renseigné"))])])}))],2)])})),0)]):e._e(),"comments"===e.sidePanel?s("div",[s("header",{staticClass:"sidepanel-header"},[s("h1",{staticClass:"sidepanel-title"},[s("font-awesome-icon",{attrs:{icon:"comment"}}),e._v(" Commentaires")],1)]),s("div",{staticClass:"sidepanel-content"},[s("div",{staticClass:"sidepanel-section"},[e.hasPermission("shantytown_comment.create",e.town)?s("div",{staticClass:"comment-form"},[s("h1",[e._v("Ajouter un commentaire")]),s("p",[e._v("Merci de respecter les règles de confidentialité. Ne pas citer l’identité des individus (Nom, âge, sexe, origine...)")]),e.commentErrors.description?s("p",{staticClass:"error"},[s("ul",e._l(e.commentErrors.description,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("div",{staticClass:"input__group"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.newComment,expression:"newComment"}],domProps:{value:e.newComment},on:{input:function(t){t.target.composing||(e.newComment=t.target.value)}}})]),s("p",[s("button",{staticClass:"button large",on:{click:e.addComment}},[e._v("Ajouter le commentaire")])])]):e._e()]),0===e.town.comments.regular.length?s("div",{staticClass:"sidepanel-section"},[s("p",[e._v("Aucun commentaire enregistré pour le moment")])]):e._e(),e._l(e.town.comments.regular,(function(t){return s("div",{staticClass:"sidepanel-section"},[s("article",{staticClass:"userpost userpost--comment"},[s("header",{staticClass:"userpost-header"},[s("p",{staticClass:"userpost-date"},[s("time",[e._v(e._s(e.formatDate(t.createdAt,"d M y à h:i")))])]),s("h1",{staticClass:"userpost-title"},[s("router-link",{attrs:{to:"/annuaire/"+t.createdBy.organizationId}},[s("font-awesome-icon",{attrs:{icon:"user"}}),s("span",[e._v(e._s(t.createdBy.lastName.toUpperCase())+" "+e._s(t.createdBy.firstName))])],1),s("span",{staticClass:"userpost-actions"},[e.canEditComment(t)?s("font-awesome-icon",{staticClass:"userpost-action--edit",attrs:{icon:"pencil-alt"},on:{click:function(s){return e.editComment(t)}}}):e._e(),e.canDeleteComment(t)?s("font-awesome-icon",{staticClass:"userpost-action--delete",attrs:{icon:"trash-alt"},on:{click:function(s){return e.deleteComment(t)}}}):e._e()],1)],1)]),e.commentEdit.commentId===t.id?s("div",[e.commentEdit.error?s("p",{staticClass:"error"},[s("ul",[s("li",[e._v(e._s(e.commentEdit.error))])])]):e._e(),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.commentEdit.value,expression:"commentEdit.value"}],attrs:{disabled:e.commentEdit.pending},domProps:{value:e.commentEdit.value},on:{input:function(t){t.target.composing||e.$set(e.commentEdit,"value",t.target.value)}}}),s("p",[s("button",{staticClass:"button",on:{click:function(s){return e.sendEditComment(t)}}},[e._v("Modifier")]),s("button",{staticClass:"button warning",on:{click:e.cancelEditComment}},[e._v("Annuler")])])]):s("p",[e._v(e._s(t.description))])])])}))],2)]):e._e(),"covidComments"===e.sidePanel?s("div",[s("header",{staticClass:"sidepanel-header"},[s("h1",{staticClass:"sidepanel-title"},[s("font-awesome-icon",{attrs:{icon:"comment"}}),e._v(" Commentaires COVID-19")],1)]),s("div",{staticClass:"sidepanel-content"},[s("div",{staticClass:"sidepanel-section"},[s("div",{staticClass:"comment-form"},[s("h1",[e._v("Ajouter un commentaire COVID-19")]),s("p",[e._v("Merci de préciser votre action, ses modalités, et le nombre de personnes avec des symptômes.")]),s("p",[e._v("Merci de respecter les règles de confidentialité. Ne pas citer l’identité des individus (Nom, âge, sexe, origine...)")]),e.covidErrors.length>0?s("p",{staticClass:"covid-header error"},[s("span",{staticClass:"error"},[e._v("Le fomulaire comporte des erreurs :")]),s("ul",e._l(e.covidErrors,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("div",{staticClass:"covid-header"},[e._m(1),s("datepicker",{attrs:{language:e.dateLanguage,"monday-first":!0,"disabled-dates":{to:e.town?new Date(1e3*e.town.builtAt):void 0,from:new Date},"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.covidComment.date,callback:function(t){e.$set(e.covidComment,"date",t)},expression:"covidComment.date"}})],1),e._m(2),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-equipeMaraude"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.equipe_maraude,expression:"covidComment.equipe_maraude"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-equipeMaraude",name:"covid-equipeMaraude"},domProps:{checked:Array.isArray(e.covidComment.equipe_maraude)?e._i(e.covidComment.equipe_maraude,null)>-1:e.covidComment.equipe_maraude},on:{change:function(t){var s=e.covidComment.equipe_maraude,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"equipe_maraude",s.concat([n])):o>-1&&e.$set(e.covidComment,"equipe_maraude",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"equipe_maraude",a)}}}),e._v(" Équipe de maraude ")])]),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-equipeSanitaire"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.equipe_sanitaire,expression:"covidComment.equipe_sanitaire"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-equipeSanitaire",name:"covid-equipeSanitaire"},domProps:{checked:Array.isArray(e.covidComment.equipe_sanitaire)?e._i(e.covidComment.equipe_sanitaire,null)>-1:e.covidComment.equipe_sanitaire},on:{change:function(t){var s=e.covidComment.equipe_sanitaire,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"equipe_sanitaire",s.concat([n])):o>-1&&e.$set(e.covidComment,"equipe_sanitaire",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"equipe_sanitaire",a)}}}),e._v(" Équipe sanitaire ")])]),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-equipeAccompagnement"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.equipe_accompagnement,expression:"covidComment.equipe_accompagnement"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-equipeAccompagnement",name:"covid-equipeAccompagnement"},domProps:{checked:Array.isArray(e.covidComment.equipe_accompagnement)?e._i(e.covidComment.equipe_accompagnement,null)>-1:e.covidComment.equipe_accompagnement},on:{change:function(t){var s=e.covidComment.equipe_accompagnement,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"equipe_accompagnement",s.concat([n])):o>-1&&e.$set(e.covidComment,"equipe_accompagnement",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"equipe_accompagnement",a)}}}),e._v(" Équipe d'accompagnement ")])]),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-distributionAlimentaire"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.distribution_alimentaire,expression:"covidComment.distribution_alimentaire"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-distributionAlimentaire",name:"covid-distributionAlimentaire"},domProps:{checked:Array.isArray(e.covidComment.distribution_alimentaire)?e._i(e.covidComment.distribution_alimentaire,null)>-1:e.covidComment.distribution_alimentaire},on:{change:function(t){var s=e.covidComment.distribution_alimentaire,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"distribution_alimentaire",s.concat([n])):o>-1&&e.$set(e.covidComment,"distribution_alimentaire",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"distribution_alimentaire",a)}}}),e._v(" Distribution d'aide alimentaire ")])]),e._m(3),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-personnesOrientees"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.personnes_orientees,expression:"covidComment.personnes_orientees"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-personnesOrientees",name:"covid-personnesOrientees"},domProps:{checked:Array.isArray(e.covidComment.personnes_orientees)?e._i(e.covidComment.personnes_orientees,null)>-1:e.covidComment.personnes_orientees},on:{change:function(t){var s=e.covidComment.personnes_orientees,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"personnes_orientees",s.concat([n])):o>-1&&e.$set(e.covidComment,"personnes_orientees",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"personnes_orientees",a)}}}),e._v(" Personne(s) orientée(s) vers un centre d'hébergement spécialisé (desserrement) ")])]),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-personnesAvecSymptomes"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.personnes_avec_symptomes,expression:"covidComment.personnes_avec_symptomes"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-personnesAvecSymptomes",name:"covid-personnesAvecSymptomes"},domProps:{checked:Array.isArray(e.covidComment.personnes_avec_symptomes)?e._i(e.covidComment.personnes_avec_symptomes,null)>-1:e.covidComment.personnes_avec_symptomes},on:{change:function(t){var s=e.covidComment.personnes_avec_symptomes,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"personnes_avec_symptomes",s.concat([n])):o>-1&&e.$set(e.covidComment,"personnes_avec_symptomes",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"personnes_avec_symptomes",a)}}}),e._v(" Personne(s) avec des symptômes Covid-19 ")])]),s("div",{staticClass:"input__group"},[s("label",{attrs:{for:"covid-besoinAction"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.besoin_action,expression:"covidComment.besoin_action"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"covid-besoinAction",name:"covid-v"},domProps:{checked:Array.isArray(e.covidComment.besoin_action)?e._i(e.covidComment.besoin_action,null)>-1:e.covidComment.besoin_action},on:{change:function(t){var s=e.covidComment.besoin_action,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n=null,o=e._i(s,n);i.checked?o<0&&e.$set(e.covidComment,"besoin_action",s.concat([n])):o>-1&&e.$set(e.covidComment,"besoin_action",s.slice(0,o).concat(s.slice(o+1)))}else e.$set(e.covidComment,"besoin_action",a)}}}),e._v(" Besoin d'une action prioritaire ")])]),s("div",{staticClass:"input__group"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.covidComment.description,expression:"covidComment.description"}],domProps:{value:e.covidComment.description},on:{input:function(t){t.target.composing||e.$set(e.covidComment,"description",t.target.value)}}})]),s("p",[s("button",{staticClass:"button large",on:{click:e.addCovidComment}},[e._v("Ajouter le commentaire")])])])]),0===e.town.comments.covid.length?s("div",{staticClass:"sidepanel-section"},[s("p",[e._v("Aucun commentaire enregistré pour le moment")])]):e._e(),e._l(e.town.comments.covid,(function(t){return s("div",{staticClass:"sidepanel-section"},[s("article",{staticClass:"userpost userpost--comment"},[s("header",{staticClass:"userpost-header"},[s("p",{staticClass:"userpost-date"},[e._v("Publié le : "),s("time",[e._v(e._s(e.formatDate(t.createdAt,"d M y à h:i")))])]),s("p",{staticClass:"userpost-date"},[e._v("Date de l'intervention : "),s("time",[e._v(e._s(e.formatDate(t.covid.date,"d M y")))])]),s("h1",{staticClass:"userpost-title"},[s("router-link",{attrs:{to:"/annuaire/"+t.createdBy.organizationId}},[s("font-awesome-icon",{attrs:{icon:"user"}}),s("span",[e._v(e._s(t.createdBy.lastName.toUpperCase())+" "+e._s(t.createdBy.firstName))])],1)],1)]),e._l(e.covidTags,(function(i){return!0===t.covid[i.prop]?s("p",{staticClass:"covidTag"},[s("span",{class:"rbTag rbTag--"+i.type},[e._v(e._s(i.label))])]):e._e()})),s("p",[e._v(e._s(t.description))])],2)])}))],2)]):e._e()])]),s("div",{staticClass:"container"},[null!==e.deleteError?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.deleteError))])]):e._e(),"details"===e.view?s("div",["view"===e.mode?s("div",[s("div",{staticClass:"panel"},[e._m(4),s("div",{staticClass:"form__group"},[e.town.priority?s("p",[s("strong",[e._v("Niveau de priorité du site :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"priority"}},[e._v(e._s(e.town.priority))])]):e._e(),void 0!==e.town.builtAt?s("p",[s("strong",[e._v("Date d'installation du site :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"built_at"}},[e._v(e._s(null!==e.town.builtAt?e.formatDate(e.town.builtAt):"Inconnue"))])]):e._e(),void 0!==e.town.declaredAt?s("p",[s("strong",[e._v("Date de signalement du site :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"declared_at"}},[e._v(e._s(null!==e.town.declaredAt?e.formatDate(e.town.declaredAt):"Inconnue"))])]):e._e(),"open"!==e.town.status&&void 0!==e.town.closedAt?s("p",[s("strong",[e._v("Date de disparition du site :")]),e._v(" "+e._s(null!==e.town.closedAt?e.formatDate(e.town.closedAt):"Inconnue")+" ")]):e._e(),"open"!==e.town.status?s("p",[s("strong",[e._v("Cause de la disparition :")]),e._v(" "+e._s(e.statusLabel)+" ")]):e._e(),"open"!==e.town.status&&void 0!==e.town.closingSolutions?s("p",[s("strong",[e._v("Orientation des ménages :")]),0===e.town.closingSolutions.length?s("span",[e._v(" aucune")]):e._e(),e.town.closingSolutions.length>0?s("ul",e._l(e.town.closingSolutions,(function(t){return s("li",[s("span",[e._v(e._s(e.closingSolutions.find((function(e){return e.id===t.id})).label))]),s("ul",e._l(e.formatSolution(t),(function(t){return s("li",[e._v(e._s(t))])})),0)])})),0):e._e()]):e._e()])]),s("div",{staticClass:"panel"},[e._m(5),s("div",{staticClass:"form__group"},[void 0!==e.town.address?s("p",[s("strong",[e._v("Adresse :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"address"}},[e._v(e._s(e.town.address))])]):e._e(),void 0!==e.town.addressDetails?s("p",[s("strong",[e._v("Informations d'accès :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"address_details"}},[e._v(e._s(e.town.addressDetails))])]):e._e(),s("Map",{attrs:{"display-searchbar":!1,towns:[e.town],"default-view":e.center}}),void 0!==e.town.fieldType?s("p",[s("strong",[e._v("Type de site :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"field_type"}},[e._v(e._s(e.town.fieldType.label))])]):e._e(),void 0!==e.town.ownerType?s("p",[s("strong",[e._v("Type de propriétaire :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"owner_type"}},[e._v(e._s(e.town.ownerType.label))])]):e._e(),void 0!==e.town.owner?s("p",[s("strong",[e._v("Propriétaire :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"owner"}},[e._v(e._s(e.town.owner||"Inconnu"))])]):e._e()],1)]),s("div",{staticClass:"panel"},[e._m(6),s("div",{staticClass:"form__group"},[void 0!==e.town.censusStatus?s("p",[s("strong",[e._v("Statut du diagnostic :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"census_status"}},[e._v(e._s("done"===e.town.censusStatus?"Réalisé":"scheduled"===e.town.censusStatus?"Prévu":"none"===e.town.censusStatus?"Non prévu":"Inconnu"))])]):e._e(),"done"===e.town.censusStatus||"scheduled"===e.town.censusStatus?s("p",[s("strong",[e._v("Date du diagnostic :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"census_conducted_at"}},[e._v(e._s(null!==e.town.censusConductedAt?e.formatDate(e.town.censusConductedAt):"Inconnue"))])]):e._e(),"done"===e.town.censusStatus||"scheduled"===e.town.censusStatus?s("p",[s("strong",[e._v("Opérateur en charge du diagnostic :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"census_conducted_by"}},[e._v(e._s(e.town.censusConductedBy||"Inconnu"))])]):e._e(),void 0!==e.town.populationTotal?s("p",[s("strong",[e._v("Nombre de personnes :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"population_total"}},[e._v(e._s(null!==e.town.populationTotal?e.town.populationTotal:"inconnu"))])]):e._e(),void 0!==e.town.populationCouples?s("p",[s("strong",[e._v("Nombre de ménages :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"population_couples"}},[e._v(e._s(null!==e.town.populationCouples?e.town.populationCouples:"inconnu"))])]):e._e(),void 0!==e.town.populationMinors?s("p",[s("strong",[e._v("Nombre de mineurs :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"population_minors"}},[e._v(e._s(null!==e.town.populationMinors?e.town.populationMinors:"inconnu"))])]):e._e(),void 0!==e.town.socialOrigins?s("p",{attrs:{"data-cy-data":"social_origins"}},[s("strong",[e._v("Origines :")]),e.town.socialOrigins.length>0?s("ul",e._l(e.town.socialOrigins,(function(t){return s("li",[e._v(e._s(t.label))])})),0):s("span",[e._v("inconnues")])]):e._e()])]),s("div",{staticClass:"panel"},[e._m(7),s("div",{staticClass:"form__group"},[s("p",[s("strong",[e._v("Accès à l'électricité:")]),e._v(" "),s("span",{attrs:{"data-cy-data":"electricity_type"}},[e._v(e._s(e.town.electricityType.label))])]),e.town.electricityComments?s("p",[s("strong",[e._v("Modalités d'accès à l'électricité :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"electricity_comments"}},[e._v(e._s(e.town.electricityComments))])]):e._e(),void 0!==e.town.accessToWater?s("p",[s("strong",[e._v("Accès à l'eau :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"access_to_water"}},[e._v(e._s(null!==e.town.accessToWater?e.town.accessToWater?"Oui":"Non":"Inconnu"))])]):e._e(),e.town.waterComments?s("p",[s("strong",[e._v("Modalités d'accès à l'eau :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"water_comments"}},[e._v(e._s(e.town.waterComments))])]):e._e(),void 0!==e.town.accessToSanitary?s("p",[s("strong",[e._v("Accès aux toilettes :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"access_to_sanitary"}},[e._v(e._s(null!==e.town.accessToSanitary?e.town.accessToSanitary?"Oui":"Non":"Inconnu"))])]):e._e(),e.town.sanitaryComments?s("p",[s("strong",[e._v("Modalités d'accès aux toilettes :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"sanitary_comments"}},[e._v(e._s(e.town.sanitaryComments))])]):e._e(),void 0!==e.town.trashEvacuation?s("p",[s("strong",[e._v("Évacuation des déchets :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"trash_evacuation"}},[e._v(e._s(null!==e.town.trashEvacuation?e.town.trashEvacuation?"Oui":"Non":"Inconnu"))])]):e._e()])]),e.hasPermission("shantytown.list.data_justice",e.town)?s("div",{staticClass:"panel"},[e._m(8),s("div",{staticClass:"form__group"},[void 0!==e.town.ownerComplaint?s("p",[s("strong",[e._v("Dépôt de plainte par le propriétaire :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"owner_complaint"}},[e._v(e._s(null===e.town.ownerComplaint?"Inconnu":e.town.ownerComplaint?"Oui":"Non"))])]):e._e(),void 0!==e.town.justiceProcedure?s("p",[s("strong",[e._v("Existence d’une procédure judiciaire :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"justice_procedure"}},[e._v(e._s(null===e.town.justiceProcedure?"Inconnu":e.town.justiceProcedure?"Oui":"Non"))])]):e._e(),e.town.justiceProcedure&&void 0!==e.town.justiceRendered?s("p",[s("strong",[e._v("Décision de justice rendue :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"justice_rendered"}},[e._v(e._s(null===e.town.justiceRendered?"Inconnu":e.town.justiceRendered?"Oui":"Non"))])]):e._e(),e.town.justiceRendered&&void 0!==e.town.justiceRenderedBy?s("p",[s("strong",[e._v("Origine de la décision :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"justice_rendered_by"}},[e._v(e._s(e.town.justiceRenderedBy||"Inconnue"))])]):e._e(),e.town.justiceRendered&&void 0!==e.town.justiceRenderedAt?s("p",[s("strong",[e._v("Date de la décision :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"justice_rendered_at"}},[e._v(e._s(null!==e.town.justiceRenderedAt?e.formatDate(e.town.justiceRenderedAt):"Inconnue"))])]):e._e(),e.town.justiceRendered&&void 0!==e.town.justiceChallenged?s("p",[s("strong",[e._v("Contentieux relatif à la décision de justice :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"justice_challenged"}},[e._v(e._s(null===e.town.justiceChallenged?"Inconnu":e.town.justiceChallenged?"Oui":"Non"))])]):e._e(),void 0!==e.town.policeStatus?s("p",[s("strong",[e._v("Concours de la force publique :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"police_status"}},[e._v(e._s("granted"===e.town.policeStatus?"Obtenu":"requested"===e.town.policeStatus?"Demandé":"Inconnu"))])]):e._e(),"requested"===e.town.policeStatus||"granted"===e.town.policeStatus?s("p",[s("strong",[e._v("Date de la demande du CFP :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"police_requested_at"}},[e._v(e._s(null!==e.town.policeRequestedAt?e.formatDate(e.town.policeRequestedAt):"Inconnue"))])]):e._e(),"requested"===e.town.policeStatus||"granted"===e.town.policeStatus?s("p",[s("strong",[e._v("Date d'octroi du CFP :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"police_granted_at"}},[e._v(e._s(null!==e.town.policeGrantedAt?e.formatDate(e.town.policeGrantedAt):"Inconnue"))])]):e._e(),void 0!==e.town.bailiff?s("p",[s("strong",[e._v("Nom de l'étude d'huissiers :")]),e._v(" "),s("span",{attrs:{"data-cy-data":"bailiff"}},[e._v(e._s(e.town.bailiff||"Inconnues"))])]):e._e()])]):e._e()]):e._e(),"edit"===e.mode?s("div",[s("div",{staticClass:"panel"},[e._m(9),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.priority}},[e._v("Niveau de priorité du site :")]),e._m(10),e.fieldErrors.priority?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.priority,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("select",{directives:[{name:"model",rawName:"v-model",value:e.edit.priority,expression:"edit.priority"}],attrs:{"data-cy-field":"priority"},on:{change:function(t){var s=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.$set(e.edit,"priority",t.target.multiple?s:s[0])}}},[s("option",{attrs:{value:"1"}},[e._v("1")]),s("option",{attrs:{value:"2"}},[e._v("2")]),s("option",{attrs:{value:"3"}},[e._v("3")])])]),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.built_at}},[e._v("Date d'installation du site :")]),e.fieldErrors.built_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.built_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"data-cy-field":"built_at",language:e.dateLanguage,"monday-first":!0,"disabled-dates":{from:new Date},"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.edit.builtAt,callback:function(t){e.$set(e.edit,"builtAt",t)},expression:"edit.builtAt"}})],1),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.declared_at}},[e._v("Date de signalement du site :")]),e.fieldErrors.declared_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.declared_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"data-cy-field":"declared_at",language:e.dateLanguage,"monday-first":!0,"disabled-dates":{from:new Date},"full-month-name":!0,format:"dd MMMM yyyy",clearButton:"true"},model:{value:e.edit.declaredAt,callback:function(t){e.$set(e.edit,"declaredAt",t)},expression:"edit.declaredAt"}})],1)]),s("div",{staticClass:"panel"},[e._m(11),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.address}},[e._v("Localisation géographique")]),e.fieldErrors.address?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.address,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Saisissez ici l'adresse du site, puis précisez sa position en déplaçant le point sur la carte.")]),s("AddressWithLocation",{attrs:{"data-cy-field":"address"},model:{value:e.edit.address,callback:function(t){e.$set(e.edit,"address",t)},expression:"edit.address"}})],1),s("div",{staticClass:"form__group"},[s("label",[e._v("Appellation du site :")]),e.fieldErrors.name?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.name,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Exemples : Entrepôt de la Poste, Rond-point du centre...")]),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.name,expression:"edit.name"}],attrs:{"data-cy-field":"name",type:"text",maxlength:"35"},domProps:{value:e.edit.name},on:{input:function(t){t.target.composing||e.$set(e.edit,"name",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("label",[e._v("Informations d'accès :")]),s("p",[e._v("Saisissez ici toutes les informations qui, en plus de l'adresse, peuvent être utiles pour l'accès au site :")]),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.detailedAddress,expression:"edit.detailedAddress"}],attrs:{"data-cy-field":"address_details",type:"text"},domProps:{value:e.edit.detailedAddress},on:{input:function(t){t.target.composing||e.$set(e.edit,"detailedAddress",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.field_type}},[e._v("Type de site :")]),e.fieldErrors.field_type?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.field_type,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.fieldTypes,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.fieldType,expression:"edit.fieldType"}],attrs:{"data-cy-field":"field_type","data-cy-label":t.label,type:"radio",id:"fieldType"+i},domProps:{value:t.id,checked:e._q(e.edit.fieldType,t.id)},on:{change:function(s){return e.$set(e.edit,"fieldType",t.id)}}}),s("label",{staticClass:"label-inline",attrs:{for:"fieldType"+i}},[e._v(e._s(t.label))])])}))],2)]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.owner_type}},[e._v("Type de propriétaire :")]),e.fieldErrors.owner_type?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.owner_type,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.ownerTypes,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.ownerType,expression:"edit.ownerType"}],attrs:{"data-cy-field":"owner_type","data-cy-label":t.label,type:"radio",id:"ownerType"+i},domProps:{value:t.id,checked:e._q(e.edit.ownerType,t.id)},on:{change:function(s){return e.$set(e.edit,"ownerType",t.id)}}}),s("label",{staticClass:"label-inline",attrs:{for:"ownerType"+i}},[e._v(e._s(t.label))])])}))],2)]),e.ownerTypes.find((function(t){return"Inconnu"!==t.label&&t.id===e.edit.ownerType}))?s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.owner}},[e._v("Identité du propriétaire :")]),e.fieldErrors.owner?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.owner,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.owner,expression:"edit.owner"}],attrs:{"data-cy-field":"owner",type:"text"},domProps:{value:e.edit.owner},on:{input:function(t){t.target.composing||e.$set(e.edit,"owner",t.target.value)}}})])])]):e._e()]),s("div",{staticClass:"panel"},[e._m(12),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.census_status}},[e._v("Statut du diagnostic social :")]),e.fieldErrors.census_status?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.census_status,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Un diagnostic social vise à identifier les situations et besoins des familles et personnes, de repérer le contexte territorial et les acteurs en présence.")]),e._l(e.diagnosisValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.census_status,expression:"edit.census_status"}],attrs:{"data-cy-field":"census_status","data-cy-label":t.label,type:"radio",name:"diagnosis",id:"diagnosis"+i},domProps:{value:t.value,checked:e._q(e.edit.census_status,t.value)},on:{change:function(s){return e.$set(e.edit,"census_status",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"diagnosis"+i}},[e._v(e._s(t.label))])])}))],2),"scheduled"===e.edit.census_status||"done"===e.edit.census_status?s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.census_conducted_at}},[e._v("Date du diagnostic :")]),e.fieldErrors.census_conducted_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.census_conducted_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"data-cy-field":"census_conducted_at",language:e.dateLanguage,"monday-first":!0,"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.edit.census_conducted_at,callback:function(t){e.$set(e.edit,"census_conducted_at",t)},expression:"edit.census_conducted_at"}})],1):e._e(),"scheduled"===e.edit.census_status||"done"===e.edit.census_status?s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.census_conducted_by}},[e._v("Service ou opérateur en charge du diagnostic :")]),e.fieldErrors.census_conducted_by?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.census_conducted_by,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.census_conducted_by,expression:"edit.census_conducted_by"}],attrs:{"data-cy-field":"census_conducted_by",type:"text"},domProps:{value:e.edit.census_conducted_by},on:{input:function(t){t.target.composing||e.$set(e.edit,"census_conducted_by",t.target.value)}}})])])]):e._e(),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.population_total}},[e._v("Nombre de personnes :")]),e.fieldErrors.population_total?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.population_total,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Laissez ce champ vide si l'information est inconnue")]),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.populationTotal,expression:"edit.populationTotal"}],attrs:{"data-cy-field":"population_total",type:"number"},domProps:{value:e.edit.populationTotal},on:{input:function(t){t.target.composing||e.$set(e.edit,"populationTotal",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.population_couples}},[e._v("Nombre de ménages :")]),e.fieldErrors.population_couples?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.population_couples,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Laissez ce champ vide si l'information est inconnue")]),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.populationCouples,expression:"edit.populationCouples"}],attrs:{"data-cy-field":"population_couples",type:"number"},domProps:{value:e.edit.populationCouples},on:{input:function(t){t.target.composing||e.$set(e.edit,"populationCouples",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.population_minors}},[e._v("Nombre de mineurs :")]),e.fieldErrors.population_minors?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.population_minors,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("p",[e._v("Laissez ce champ vide si l'information est inconnue")]),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.populationMinors,expression:"edit.populationMinors"}],attrs:{"data-cy-field":"population_minors",type:"number"},domProps:{value:e.edit.populationMinors},on:{input:function(t){t.target.composing||e.$set(e.edit,"populationMinors",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",[e._v("Origines :")]),s("div",[s("p",[e._v("Ne rien cocher si l'information est inconnue")]),e._l(e.socialOrigins,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.origins,expression:"edit.origins"}],attrs:{"data-cy-field":"social_origins","data-cy-label":t.label,type:"checkbox",id:"socialOrigins"+i},domProps:{value:t.id,checked:Array.isArray(e.edit.origins)?e._i(e.edit.origins,t.id)>-1:e.edit.origins},on:{change:function(s){var i=e.edit.origins,a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=t.id,r=e._i(i,o);a.checked?r<0&&e.$set(e.edit,"origins",i.concat([o])):r>-1&&e.$set(e.edit,"origins",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.edit,"origins",n)}}}),s("label",{staticClass:"label-inline",attrs:{for:"socialOrigins"+i}},[e._v(e._s(t.label))])])}))],2)])])]),s("div",{staticClass:"panel"},[e._m(13),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.electricity_type}},[e._v("Accès à l'électricité :")]),e.fieldErrors.electricity_type?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.electricity_type,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.electricityTypes,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.electricityType,expression:"edit.electricityType"}],attrs:{"data-cy-field":"electricity_type","data-cy-label":t.label,type:"radio",name:"electricityType",id:"electricityType"+i},domProps:{value:t.id,checked:e._q(e.edit.electricityType,t.id)},on:{change:function(s){return e.$set(e.edit,"electricityType",t.id)}}}),s("label",{staticClass:"label-inline",attrs:{for:"electricityType"+i}},[e._v(e._s(t.label))])])}))],2)]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.electricity_comments}},[e._v("Modalités d'accès :")]),s("p",[e._v("Exemples : groupe électrogène, raccordement à une usine...")]),e.fieldErrors.electricity_comments?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.electricity_comments,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.electricityComments,expression:"edit.electricityComments"}],staticClass:"input input--textarea",attrs:{"data-cy-field":"electricity_comments"},domProps:{value:e.edit.electricityComments},on:{input:function(t){t.target.composing||e.$set(e.edit,"electricityComments",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.access_to_water}},[e._v("Accès à l'eau :")]),e.fieldErrors.access_to_water?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.access_to_water,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.accessToWater,expression:"edit.accessToWater"}],attrs:{"data-cy-field":"access_to_water","data-cy-label":t.label,type:"radio",name:"accessToWater",id:"accessToWater"+i},domProps:{value:t.value,checked:e._q(e.edit.accessToWater,t.value)},on:{change:function(s){return e.$set(e.edit,"accessToWater",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"accessToWater"+i}},[e._v(e._s(t.label))])])}))],2)]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.water_comments}},[e._v("Modalités d'accès :")]),s("p",[e._v("Exemples: Citerne de 100 litres remplie par les pompiers tous les jours, 3 robinets raccordés par la collectivité, borne incendie à 200 mètres...")]),e.fieldErrors.water_comments?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.water_comments,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.waterComments,expression:"edit.waterComments"}],staticClass:"input input--textarea",attrs:{"data-cy-field":"water_comments"},domProps:{value:e.edit.waterComments},on:{input:function(t){t.target.composing||e.$set(e.edit,"waterComments",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.access_to_sanitary}},[e._v("Accès à des toilettes :")]),e.fieldErrors.access_to_sanitary?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.access_to_sanitary,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.accessToSanitary,expression:"edit.accessToSanitary"}],attrs:{"data-cy-field":"access_to_sanitary","data-cy-label":t.label,type:"radio",name:"accessToSanitary",id:"accessToSanitary"+i},domProps:{value:t.value,checked:e._q(e.edit.accessToSanitary,t.value)},on:{change:function(s){return e.$set(e.edit,"accessToSanitary",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"accessToSanitary"+i}},[e._v(e._s(t.label))])])}))],2)]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.sanitary_comments}},[e._v("Modalités d'accès :")]),s("p",[e._v("Exemples : 3 toilettes sèches, toilettes raccordés au réseau, un bloc sanitaire fourni par la ville...")]),e.fieldErrors.sanitary_comments?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.sanitary_comments,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.edit.sanitaryComments,expression:"edit.sanitaryComments"}],staticClass:"input input--textarea",attrs:{"data-cy-field":"sanitary_comments"},domProps:{value:e.edit.sanitaryComments},on:{input:function(t){t.target.composing||e.$set(e.edit,"sanitaryComments",t.target.value)}}})])]),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.trash_evacuation}},[e._v("Évacuation des déchets :")]),e.fieldErrors.trash_evacuation?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.trash_evacuation,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.trashEvacuation,expression:"edit.trashEvacuation"}],attrs:{"data-cy-field":"trash_evacuation","data-cy-label":t.label,type:"radio",name:"trashEvacuation",id:"trashEvacuation"+i},domProps:{value:t.value,checked:e._q(e.edit.trashEvacuation,t.value)},on:{change:function(s){return e.$set(e.edit,"trashEvacuation",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"trashEvacuation"+i}},[e._v(e._s(t.label))])])}))],2)])]),e.hasPermission("shantytown.update.data_justice",e.town)?s("div",{staticClass:"panel"},[e._m(14),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.owner_complaint}},[e._v("Dépôt de plainte par le propriétaire :")]),e.fieldErrors.owner_complaint?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.owner_complaint,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.owner_complaint,expression:"edit.owner_complaint"}],attrs:{"data-cy-field":"owner_complaint","data-cy-label":t.label,type:"radio",name:"ownerComplaint",id:"ownerComplaint"+i},domProps:{value:t.value,checked:e._q(e.edit.owner_complaint,t.value)},on:{change:function(s){return e.$set(e.edit,"owner_complaint",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"ownerComplaint"+i}},[e._v(e._s(t.label))])])}))],2),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.justice_procedure}},[e._v("Procédure judiciaire en cours :")]),e.fieldErrors.justice_procedure?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.justice_procedure,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.justiceProcedure,expression:"edit.justiceProcedure"}],attrs:{"data-cy-field":"justice_procedure","data-cy-label":t.label,type:"radio",name:"justiceProcedure",id:"justiceProcedure"+i},domProps:{value:t.value,checked:e._q(e.edit.justiceProcedure,t.value)},on:{change:function(s){return e.$set(e.edit,"justiceProcedure",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"justiceProcedure"+i}},[e._v(e._s(t.label))])])}))],2),1===e.edit.justiceProcedure?s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.justice_rendered}},[e._v("Décision de justice rendue :")]),e.fieldErrors.justice_rendered?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.justice_rendered,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.justice_rendered,expression:"edit.justice_rendered"}],attrs:{"data-cy-field":"justice_rendered","data-cy-label":t.label,type:"radio",name:"justiceRendered",id:"justiceRendered"+i},domProps:{value:t.value,checked:e._q(e.edit.justice_rendered,t.value)},on:{change:function(s){return e.$set(e.edit,"justice_rendered",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"justiceRendered"+i}},[e._v(e._s(t.label))])])}))],2):e._e(),1===e.edit.justiceProcedure&&1===e.edit.justice_rendered?s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.justice_rendered_by}},[e._v("Origine de la décision :")]),e.fieldErrors.justice_rendered_by?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.justice_rendered_by,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.justice_rendered_by,expression:"edit.justice_rendered_by"}],attrs:{"data-cy-field":"justice_rendered_by",type:"text"},domProps:{value:e.edit.justice_rendered_by},on:{input:function(t){t.target.composing||e.$set(e.edit,"justice_rendered_by",t.target.value)}}})])])]):e._e(),1===e.edit.justiceProcedure&&1===e.edit.justice_rendered?s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.justice_rendered_at}},[e._v("Date de la décision :")]),e.fieldErrors.justice_rendered_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.justice_rendered_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"data-cy-field":"justice_rendered_at",language:e.dateLanguage,"monday-first":!0,"disabled-dates":{from:new Date},"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.edit.justice_rendered_at,callback:function(t){e.$set(e.edit,"justice_rendered_at",t)},expression:"edit.justice_rendered_at"}})],1):e._e(),1===e.edit.justiceProcedure&&1===e.edit.justice_rendered?s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.justice_challenged}},[e._v("Contentieux relatif à la décision de justice :")]),e.fieldErrors.justice_challenged?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.justice_challenged,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.yesnoValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.justice_challenged,expression:"edit.justice_challenged"}],attrs:{"data-cy-field":"justice_challenged","data-cy-label":t.label,type:"radio",name:"justiceChallenged",id:"justiceChallenged"+i},domProps:{value:t.value,checked:e._q(e.edit.justice_challenged,t.value)},on:{change:function(s){return e.$set(e.edit,"justice_challenged",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"justiceChallenged"+i}},[e._v(e._s(t.label))])])}))],2):e._e(),s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.police_status}},[e._v("Concours de la force publique :")]),e.fieldErrors.police_status?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.police_status,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),e._l(e.cfpValues,(function(t,i){return s("div",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.police_status,expression:"edit.police_status"}],attrs:{"data-cy-field":"police_status","data-cy-label":t.label,type:"radio",name:"cfp",id:"cfp"+i},domProps:{value:t.value,checked:e._q(e.edit.police_status,t.value)},on:{change:function(s){return e.$set(e.edit,"police_status",t.value)}}}),s("label",{staticClass:"label-inline",attrs:{for:"cfp"+i}},[e._v(e._s(t.label))])])}))],2),"requested"===e.edit.police_status||"granted"===e.edit.police_status?s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.police_requested_at}},[e._v("Date de la demande du CFP :")]),e.fieldErrors.police_requested_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.police_requested_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"data-cy-field":"police_requested_at",language:e.dateLanguage,"monday-first":!0,"disabled-dates":{from:new Date},"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.edit.police_requested_at,callback:function(t){e.$set(e.edit,"police_requested_at",t)},expression:"edit.police_requested_at"}})],1):e._e(),"granted"===e.edit.police_status?s("div",{staticClass:"form__group"},[s("label",{class:{error:e.fieldErrors.police_granted_at}},[e._v("Date d'octroi du CFP :")]),e.fieldErrors.police_granted_at?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.police_granted_at,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("datepicker",{attrs:{"data-cy-field":"police_granted_at",language:e.dateLanguage,"monday-first":!0,"disabled-dates":{from:new Date},"full-month-name":!0,format:"dd MMMM yyyy"},model:{value:e.edit.police_granted_at,callback:function(t){e.$set(e.edit,"police_granted_at",t)},expression:"edit.police_granted_at"}})],1):e._e(),s("div",{staticClass:"form__group"},[s("fieldset",[s("legend",{class:{error:e.fieldErrors.bailiff}},[e._v("Nom de l'étude d'huissiers :")]),e.fieldErrors.bailiff?s("p",{staticClass:"error"},[s("ul",e._l(e.fieldErrors.bailiff,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e(),s("div",{staticClass:"input__group"},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.edit.bailiff,expression:"edit.bailiff"}],attrs:{"data-cy-field":"bailiff",type:"text"},domProps:{value:e.edit.bailiff},on:{input:function(t){t.target.composing||e.$set(e.edit,"bailiff",t.target.value)}}})])])])]):e._e(),e.editError?s("div",{staticClass:"notification error"},[e._v(e._s(e.editError)+".")]):e._e(),s("div",{staticClass:"form__group"},[s("button",{staticClass:"button large",attrs:{"data-cy-field":"submit"},on:{click:e.submit}},[e._v("Sauvegarder")])])]):e._e()]):"actions"===e.view?s("div",e._l(e.town.actions,(function(t){return s("div",{staticClass:"panel"},[s("div",{staticClass:"panel__header"},[s("h3",[s("router-link",{attrs:{to:"/action/"+t.id}},[e._v(e._s(t.name))]),e._v(" - "),s("small",{staticClass:"panel__header-extra"},[e._v("Débutée le "+e._s(e.formatDate(t.startedAt)))])],1)]),s("p",[s("strong",[e._v("Type de l'action :")]),e._v(" "+e._s(t.type))]),e._m(15,!0),s("p",[e._v(e._s(t.description||"Aucun détails fournis"))])])})),0):e._e()])])],1)],1)},uh=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("label",[s("strong",[e._v("Date de votre intervention :")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",{staticClass:"covid-header"},[s("strong",[e._v("Préciser votre intervention :")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",{staticClass:"covid-header"},[s("strong",[e._v("Signaler si nécessaire :")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("1. Situation du site")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("2. Localisation")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("3. Habitants")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("4. Conditions de vie")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("5. Procédure judiciaire d’expulsion des occupants")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("1. Situation du site")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[e._v("1 étant le niveau de priorité le plus haut"),s("br"),e._v("Le niveau de priorité est un indicateur réservé aux correspondants des services de l’État.")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("2. Localisation")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("3. Habitants")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("4. Conditions de vie")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"panel__header"},[s("h3",[e._v("5. Procédure judiciaire d’expulsion des occupants")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("strong",[e._v("Détails de l'action :")])])}],ph=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popin popin--commentDeletion"},[s("div",{ref:"wrapper",staticClass:"popin-wrapper"},[s("div",["pending"!==e.status?s("p",{staticClass:"popin-close"},[s("span",{staticClass:"link",on:{click:e.close}},[s("font-awesome-icon",{attrs:{icon:"times",size:"2x"}})],1)]):e._e(),s("div",{staticClass:"popin-header"},[s("span",{staticClass:"popin-icon"},[s("font-awesome-icon",{attrs:{icon:"trash-alt",size:"lg"}})],1),s("h1",{staticClass:"popin-title"},[e._v("Confirmez-vous la suppression du commentaire ?")])]),s("div",{staticClass:"popin-body"},[s("div",{staticClass:"comment"},[s("header",{staticClass:"comment-header"},[e._v(e._s(e.date)+" à "+e._s(e.time))]),s("ul",[s("li",{staticClass:"comment-author"},[s("span",[s("font-awesome-icon",{attrs:{icon:"user"}})],1),e._v(" "+e._s(e.comment.author.name))]),s("li",{staticClass:"comment-comment"},[s("span",[s("font-awesome-icon",{attrs:{icon:"comment"}})],1),e._v(" Commentaire")]),s("li",{staticClass:"comment-shantytown"},[s("span",[s("font-awesome-icon",{attrs:{icon:"map-pin"}})],1),e._v(" Site : "+e._s(e.address))])]),s("div",{staticClass:"comment-content",domProps:{innerHTML:e._s(e.comment.content)}})]),s("h1",{staticClass:"popin-h1"},[e._v("Pourquoi souhaitez-vous supprimer ce commentaire ?")]),null!==e.error?s("p",{staticClass:"error"},[e._v(e._s(e.error))]):e._e(),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.message,expression:"message"}],attrs:{placeholder:"Précisez la raison de la suppression à l'auteur, un mail lui sera envoyé"},domProps:{value:e.message},on:{input:function(t){t.target.composing||(e.message=t.target.value)}}}),s("div",{staticClass:"commentDeletionButtons"},["pending"!==e.status?s("button",{staticClass:"button secondary",on:{click:e.close}},[e._v("Annuler")]):e._e(),s("button",{staticClass:"button primary",attrs:{disabled:"pending"===e.status},on:{click:e.deleteComment}},["pending"!==e.status?s("span",[e._v("Oui, confirmer")]):s("span",[s("img",{attrs:{src:"/img/spinner_light.svg",width:"20"}})])])])])])])])},mh=[],hh={props:{comment:{type:Object,required:!0}},data(){return{status:null,error:null,message:""}},computed:{date(){return App.formatDate(this.comment.date,"d/m/y")},time(){return App.formatDate(this.comment.date,"h:i")},address(){return`${this.comment.shantytown.usename}, ${this.comment.shantytown.city}`}},mounted(){setTimeout(()=>{document.addEventListener("click",this.checkOutsideClick)},500)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{checkOutsideClick(e){this.$refs.wrapper.contains(e.target)||this.close()},close(){"pending"!==this.status&&this.$emit("close")},deleteComment(){"pending"!==this.status&&(this.status="pending",this.error=null,ul(this.comment.shantytown.id,this.comment.id,this.message).then(()=>{this.status=null,this.message="",this.$emit("deleted")}).catch(({user_message:e})=>{this.status=null,this.error=e}))}}},vh=hh,fh=vh,_h=(s("6501"),Object(d["a"])(fh,ph,mh,!1,null,"38509d0a",null)),gh=_h.exports;function bh(e){return!0===e?1:!1===e?0:-1}var yh={components:{NavBar:cr,Map:Cu,AddressWithLocation:Xr,Datepicker:hr["default"],simplebar:Rd["a"],CommentDeletion:gh},data(){return{userId:Ao().user.id,loading:!1,error:null,town:null,view:"details",mode:"view",editError:null,deleteError:null,fieldErrors:{},electricityTypes:Ao().electricity_types,fieldTypes:Ao().field_types,ownerTypes:Ao().owner_types,socialOrigins:Ao().social_origins,closingSolutions:Ao().closing_solutions,dateLanguage:Ws["fr"],yesnoValues:[{value:1,label:"Oui"},{value:0,label:"Non"},{value:-1,label:"Inconnu"}],closedWithSolutionsValues:[{value:!0,label:"Oui"},{value:!1,label:"Non"}],statusValues:[{value:"closed_by_justice",label:"Exécution d'une décision de justice"},{value:"closed_by_admin",label:"Exécution d'une décision administrative"},{value:"other",label:"Autre"},{value:"unknown",label:"Raison inconnue"}],diagnosisValues:[{value:"none",label:"Non prévu"},{value:"scheduled",label:"Prévu"},{value:"done",label:"Réalisé"},{value:null,label:"Inconnu"}],cfpValues:[{value:"none",label:"Non demandé"},{value:"requested",label:"Demandé"},{value:"granted",label:"Obtenu"},{value:null,label:"Inconnu"}],newComment:"",covidComment:{date:new Date,description:"",equipe_maraude:!1,equipe_sanitaire:!1,equipe_accompagnement:!1,distribution_alimentaire:!1,personnes_orientees:!1,personnes_avec_symptomes:!1,besoin_action:!1},covidTags:[{prop:"equipe_maraude",label:"Équipe de maraude",type:"warning"},{prop:"equipe_sanitaire",label:"Équipe sanitaire",type:"warning"},{prop:"equipe_accompagnement",label:"Équipe d'accompagnement",type:"warning"},{prop:"distribution_alimentaire",label:"Distribution d'aide alimentaire",type:"warning"},{prop:"personnes_orientees",label:"Personne(s) orientée(s) vers un centre d'hébergement spécialisé (desserrement)",type:"error"},{prop:"personnes_avec_symptomes",label:"Personne(s) avec des symptômes Covid-19",type:"error"},{prop:"besoin_action",label:"Besoin d'une action prioritaire",type:"error"}],sidePanel:null,commentError:null,commentErrors:{},covidErrors:[],edit:null,commentEdit:{commentId:null,value:null,pending:!1,error:null},asideTimeout:null,commentToBeDeleted:null}},computed:{status(){if(null===this.town)return null;switch(this.town.status){case"open":return"existe";case"closed_by_justice":case"closed_by_admin":case"other":case"unknown":return"yes"===this.town.closedWithSolutions?"résorbé":"disparu";default:return"inconnu"}},statusLabel(){if(null===this.town)return"inconnu";switch(this.town.status){case"closed_by_justice":return"Exécution d'une décision de justice";case"closed_by_admin":return"Exécution d'une décision administrative";case"other":return"Autre";default:return"inconnu"}},center(){return{center:[this.town.latitude,this.town.longitude],zoom:15}},hasAccessToWater(){return!!this.edit&&1===this.edit.accessToWater},hasAccessToElectricity(){if(!this.edit)return!1;const e=this.electricityTypes.find(({id:e})=>e===this.edit.electricityType);return e&&-1!==e.label.indexOf("Oui")}},mounted(){this.scroll=window.pageYOffset,window.addEventListener("scroll",this.stickTheHeader)},destroyed(){window.removeEventListener("scroll",this.stickTheHeader),document.body.removeEventListener("click",this.checkClickOutsideAside)},created(){this.fetchData()},methods:{showAside(e){this.sidePanel=e,this.asideTimeout=setTimeout(()=>{document.body.addEventListener("click",this.checkClickOutsideAside)},100)},hideAside(){clearTimeout(this.asideTimeout),this.sidePanel=null,document.body.removeEventListener("click",this.checkClickOutsideAside)},checkClickOutsideAside(e){this.$refs.commentDeletionPopin&&this.$refs.commentDeletionPopin.$el.contains(e.target)||this.$refs.aside.contains(e.target)||"sidePanelLink"===e.target.dataset.group||this.hideAside()},hasPermission:e=>Io(e),offsetTop(e){let t=e,s=0;while(null!==t)s+=t.offsetTop,t=t.offsetParent;return s},stickTheHeader(){const e=window.pageYOffset<this.scroll;this.scroll=window.pageYOffset,void 0!==this.$refs.main&&void 0!==this.$refs.header&&(!0===e?window.pageYOffset-this.$refs.main.offsetTop<=0&&this.$refs.wrapper.classList.remove("sticky"):window.pageYOffset>this.offsetTop(this.$refs.header)&&this.$refs.wrapper.classList.add("sticky"))},formatDate:(...e)=>App.formatDate(...e),fetchData(){!0!==this.loading&&(this.loading=!0,this.error=null,il(this.$route.params.id).then(e=>{this.loading=!1,this.town=e,this.resetEdit()}).catch(e=>{this.error=e.user_message,this.loading=!1}))},setViewMode(){this.mode="view"},setEditMode(){Io("shantytown.update")&&(this.setView("details"),this.resetEdit(),this.mode="edit")},setCloseMode(){Io("shantytown.close")&&(this.resetEdit(),this.mode="close")},closePopin(){this.resetEdit(),this.mode="view"},resetEdit(){this.editError=null,this.fieldErrors={},null!==this.town?this.edit={priority:this.town.priority,name:this.town.name,address:{address:{city:this.town.city.name,citycode:this.town.city.code,label:this.town.address},location:{coordinates:[this.town.latitude,this.town.longitude],zoom:16}},detailedAddress:this.town.addressDetails,declaredAt:null!==this.town.declaredAt?1e3*this.town.declaredAt:null,builtAt:null!==this.town.builtAt?1e3*this.town.builtAt:null,closedAt:null!==this.town.closedAt?1e3*this.town.closedAt:null,status:"open"!==this.town.status?this.town.status:null,fieldType:this.town.fieldType.id,ownerType:this.town.ownerType.id,owner:this.town.owner,owner_complaint:bh(this.town.ownerComplaint),justiceProcedure:bh(this.town.justiceProcedure),justice_rendered:bh(this.town.justiceRendered),justice_rendered_by:this.town.justiceRenderedBy,justice_rendered_at:null!==this.town.justiceRenderedAt?1e3*this.town.justiceRenderedAt:null,justice_challenged:bh(this.town.justiceChallenged),police_status:this.town.policeStatus,police_requested_at:null!==this.town.policeRequestedAt?1e3*this.town.policeRequestedAt:null,police_granted_at:null!==this.town.policeGrantedAt?1e3*this.town.policeGrantedAt:null,bailiff:this.town.bailiff,census_status:this.town.censusStatus,census_conducted_at:null!==this.town.censusConductedAt?1e3*this.town.censusConductedAt:null,census_conducted_by:this.town.censusConductedBy,populationTotal:this.town.populationTotal,populationCouples:this.town.populationCouples,populationMinors:this.town.populationMinors,origins:this.town.socialOrigins.map(e=>e.id),electricityType:this.town.electricityType.id,electricityComments:this.town.electricityComments||"",accessToSanitary:bh(this.town.accessToSanitary),sanitaryComments:this.town.sanitaryComments||"",accessToWater:bh(this.town.accessToWater),waterComments:this.town.waterComments||"",trashEvacuation:bh(this.town.trashEvacuation),solutions:this.town.closingSolutions?this.closingSolutions.reduce((e,t)=>{const s=Object.assign(e,{}),i=this.town.closingSolutions.find(e=>e.id===t.id);return s[t.id]={checked:void 0!==i,peopleAffected:i&&i.peopleAffected,householdsAffected:i&&i.householdsAffected},s},{}):[]}:this.edit=null},setView(e){this.setViewMode(),this.view=e},submit(){this.editError=null,this.fieldErrors={};const e=this.edit.address&&this.edit.address.location&&this.edit.address.location.coordinates,{address:t}=this.edit.address||{};function s(e){return e?(e instanceof Date||(e=new Date(e)),`${e.getFullYear()}-${(""+(e.getMonth()+1)).padStart(2,"0")}-${(""+e.getDate()).padStart(2,"0")}`):null}nl(this.town.id,{name:this.edit.name,priority:this.edit.priority||null,coordinates:e.join(","),city:t&&t.city,citycode:t&&t.citycode,address:t&&t.label,detailed_address:this.edit.detailedAddress,declared_at:s(this.edit.declaredAt),built_at:s(this.edit.builtAt),census_status:this.edit.census_status,census_conducted_at:-1!==["scheduled","done"].indexOf(this.edit.census_status)?s(this.edit.census_conducted_at):null,census_conducted_by:-1!==["scheduled","done"].indexOf(this.edit.census_status)?this.edit.census_conducted_by:"",population_total:this.edit.populationTotal||null,population_couples:this.edit.populationCouples||null,population_minors:this.edit.populationMinors||null,electricity_type:this.edit.electricityType,electricity_comments:this.edit.electricityComments,access_to_sanitary:this.edit.accessToSanitary,sanitary_comments:this.edit.sanitaryComments,access_to_water:this.edit.accessToWater,water_comments:this.edit.waterComments,trash_evacuation:this.edit.trashEvacuation,owner_complaint:this.edit.owner_complaint,justice_procedure:this.edit.justiceProcedure,justice_rendered:1===this.edit.justiceProcedure?this.edit.justice_rendered:void 0,justice_rendered_by:1===this.edit.justiceProcedure&&1===this.edit.justice_rendered?this.edit.justice_rendered_by:"",justice_rendered_at:1===this.edit.justiceProcedure&&1===this.edit.justice_rendered?s(this.edit.justice_rendered_at):null,justice_challenged:1===this.edit.justiceProcedure&&1===this.edit.justice_rendered?this.edit.justice_challenged:void 0,police_status:this.edit.police_status,police_requested_at:-1!==["requested","granted"].indexOf(this.edit.police_status)?s(this.edit.police_requested_at):null,police_granted_at:-1!==["granted"].indexOf(this.edit.police_status)?s(this.edit.police_granted_at):null,bailiff:this.edit.bailiff,social_origins:this.edit.origins,field_type:this.edit.fieldType,owner_type:this.edit.ownerType,owner:this.edit.owner}).then(()=>(zc({group:"notifications",type:"success",title:"Site correctement sauvegardé",text:"Le site a bien été modifié"}),this.loading=!0,this.error=null,il(this.$route.params.id).then(e=>{this.loading=!1,this.town=e,this.setViewMode(),this.resetEdit()}).catch(e=>{this.error=e.user_message,this.loading=!1}))).catch(e=>{this.editError=e.user_message,this.fieldErrors=e.fields||{}})},submitClose(){this.editError=null,this.fieldErrors={},ol(this.town.id,{closed_at:this.edit.closedAt,closed_with_solutions:this.edit.closedWithSolutions,status:this.edit.status,solutions:Object.keys(this.edit.solutions).filter(e=>this.edit.solutions[e].checked).map(e=>({id:e,peopleAffected:this.edit.solutions[e].peopleAffected?parseInt(this.edit.solutions[e].peopleAffected,10):null,householdsAffected:this.edit.solutions[e].householdsAffected?parseInt(this.edit.solutions[e].householdsAffected,10):null}))}).then(()=>(zc({group:"notifications",type:"success",title:"Site correctement fermé",text:"Le site a bien été marqué comme fermé"}),this.loading=!0,this.error=null,il(this.$route.params.id).then(e=>{this.loading=!1,this.town=e,this.setViewMode(),this.resetEdit()}).catch(e=>{this.error=e.user_message,this.loading=!1}))).catch(e=>{this.editError=e.user_message,this.fieldErrors=e.fields||{}})},destroy(){const e=confirm("Êtes-vous sûr ? Cette suppression est irréversible");!0===e&&rl(this.$route.params.id).then(()=>{this.$router.push("/liste-des-sites")}).catch(e=>{this.deleteError=e.user_message})},addComment(){Io("shantytown_comment.create")&&(this.commentError=null,this.commentErrors={},ll(this.$route.params.id,{description:this.newComment}).then(e=>{this.town.comments.regular=e.comments,this.newComment="",this.newStep=""}).catch(e=>{this.commentError=e.user_message,this.commentErrors=e.fields||{}}))},addCovidComment(){this.covidErrors=[],cl(this.$route.params.id,this.covidComment).then(e=>{this.town.comments.covid=e,this.covidComment={date:new Date,description:"",equipe_maraude:!1,equipe_sanitaire:!1,equipe_accompagnement:!1,distribution_alimentaire:!1,personnes_orientees:!1,personnes_avec_symptomes:!1,besoin_action:!1}}).catch(e=>{const t=e.fields||{};this.covidErrors=Object.keys(t).reduce((e,s)=>[...e,...t[s]],[])})},formatSolution(e){const t=[];if(null!==e.householdsAffected){const s=e.householdsAffected>1?"s":"";t.push(`${e.householdsAffected} ménage${s} concerné${s}`)}if(null!==e.peopleAffected){const s=e.peopleAffected>1?"s":"";t.push(`${e.peopleAffected} personne${s} concernée${s}`)}return t.length>0?t:["aucun détail sur le nombre de ménages/personnes concernés"]},canEditComment(e){return Io("shantytown_comment.create")||e.createdBy.id===this.userId},canDeleteComment(e){return Io("shantytown_comment.delete")||e.createdBy.id===this.userId},editComment(e){this.commentEdit.commentId=e.id,this.commentEdit.value=e.description,this.commentEdit.pending=!1,this.commentEdit.error=null},deleteComment(e){this.commentToBeDeleted={id:e.id,date:e.createdAt,shantytown:{id:this.town.id,usename:this.town.usename,city:this.town.city.name},author:{name:`${e.createdBy.firstName} ${e.createdBy.lastName.toUpperCase()}`},content:e.description}},sendEditComment(e){!1===this.commentEdit.pending&&(this.commentEdit.pending=!0,this.commentEdit.error=null,dl(this.$route.params.id,e.id,{description:this.commentEdit.value}).then(e=>{this.town.comments.regular=e.comments,this.commentEdit.commentId=null,this.commentEdit.value=null,this.commentEdit.pending=!1,this.commentEdit.error=null,zc({group:"notifications",type:"success",title:"Opération réussie",text:"Le commentaire a bien été modifié"})}).catch(e=>{this.commentEdit.pending=!1,this.commentEdit.error=e.user_message}))},cancelEditComment(){setTimeout(()=>{!1===this.commentEdit.pending&&(this.commentEdit.commentId=null,this.commentEdit.value=null,this.commentEdit.pending=!1,this.commentEdit.error=null)},100)},closeCommentDeletion(){setTimeout(()=>{this.commentToBeDeleted=null},100)},onCommentDeleted(){this.town.comments.regular=this.town.comments.regular.filter(({id:e})=>e!==this.commentToBeDeleted.id),this.commentToBeDeleted=null,zc({group:"notifications",type:"success",title:"Commentaire supprimé",text:"L'auteur du commentaire en a été notifié par email"})}}},Ch=yh,wh=Ch,xh=(s("bdf1"),Object(d["a"])(wh,dh,uh,!1,null,"4f6083a5",null)),kh=xh.exports,Ph=function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.loading?s("PrivateLayout",[s("div",{staticClass:"text-center text-primary text-display-lg mt-16"},[s("Spinner")],1)]):s("PrivateLayout",[e.town?s("PrivateContainer",{staticClass:"py-10"},[s("TownDetailsHeader",{attrs:{town:e.town},on:{openCancel:e.openCancel,openCovid:e.openCovid}}),s("div",{staticClass:"flex pt-10 "},[s("TownDetailsLeftColumn",{staticClass:"leftColumnWidth",attrs:{town:e.town},on:{openHistory:e.openHistory}}),s("div",{staticClass:"flex-1"},[s("TownDetailsPanelCharacteristics",{staticClass:"mb-10",attrs:{town:e.town,id:"characteristics"}}),s("TownDetailsPanelPeople",{staticClass:"mb-10",attrs:{town:e.town,id:"people"}}),s("TownDetailsPanelLivingConditions",{staticClass:"mb-10",attrs:{town:e.town,id:"living_conditions"}}),s("TownDetailsPanelJudicial",{staticClass:"mb-10",attrs:{town:e.town,id:"judicial"}})],1)],1)],1):e._e(),s("div",{staticClass:"bg-orange300 py-10"},[s("PrivateContainer",{staticClass:"flex items-center"},[s("div",{staticClass:"leftColumnWidth text-sm"},[s("div",[s("Icon",{attrs:{icon:"exclamation-triangle"}})],1),s("div",{staticClass:"font-bold"},[e._v(" Quelles sont les règles de confidentialités ? ")]),s("div",[e._v(" Merci de respecter les règles de confidentialité. Ne pas citer l’identité des individus (Nom, âge, sexe, origine…) ")])]),s("TownDetailsNewComment",{staticClass:"flex-1",attrs:{id:"newComment",user:e.user},on:{submit:function(t){e.town.comments.regular=t}}})],1)],1),e.town.comments.regular.length?s("div",{staticClass:"bg-orange100"},[s("PrivateContainer",{staticClass:"flex",attrs:{id:"comments"}},[s("div",{staticClass:"leftColumnWidth"}),s("TownDetailsComments",{staticClass:"flex-1",attrs:{comments:e.town.comments.regular}})],1)],1):e._e(),s("TownDetailsHistorySidePanel",{attrs:{town:e.town,isOpen:e.historyOpen,closePanel:function(){return e.historyOpen=!1}}}),s("TownDetailsCovidCommentsSidePanel",{attrs:{town:e.town,isOpen:e.covidOpen,closePanel:function(){return e.covidOpen=!1}},on:{updateTown:function(t){e.town=t}}}),s("TownDetailsCloseModal",{attrs:{town:e.town,isOpen:e.closeOpen},on:{closeModal:function(t){e.closeOpen=!1},updateTown:function(t){e.town=t}}})],1)},Sh=[],$h=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"flex justify-end mb-6"},["open"===e.town.status?s("Button",{staticClass:"mr-8",attrs:{variant:"primaryOutline",icon:"ban",iconPosition:"left"},on:{click:function(t){return e.$emit("openCancel")}}},[e._v("Fermer le site")]):e._e(),s("router-link",{attrs:{to:"#newComment"}},[s("Button",{staticClass:"mr-8",attrs:{variant:"primary",icon:"comment",iconPosition:"left"}},[e._v("Ecrire un commentaire")])],1),"open"===e.town.status?s("Button",{staticClass:"mr-8",attrs:{variant:"secondary",icon:"pen",iconPosition:"left"}},[e._v("Mettre a jour")]):e._e()],1),s("div",[s("div",[e._v(e._s(e.town.city.name)+" ("+e._s(e.town.departement.name)+")")]),s("div",{staticClass:"text-display-lg"},[e._v(" "+e._s(e.town.addressSimple)+" "),e.town.name?s("span",{staticClass:"text-display-xs"},[e._v("« "+e._s(e.town.name)+" »")]):e._e()])]),s("div",{staticClass:"flex items-center"},[s("div",{staticClass:"flex items-center uppercase text-sm mr-4"},[s("div",{staticClass:"rounded-full bg-corail h-3 w-3 mr-2 "}),e._v(" Mis à jour le "+e._s(e.formatDate(e.town.updatedAt,"d/m/y"))+" ")]),s("div",{staticClass:"flex items-center text-red uppercase text-xs font-bold cursor-pointer",on:{click:function(t){return e.$emit("openCovid")}}},[s("Icon",{staticClass:"mr-2",attrs:{icon:"comment"}}),this.town.comments.covid.length?s("div",[e._v(" "+e._s(this.town.comments.covid.length)+" commentaires covid ")]):e._e()],1)])])},Th=[],Ah={props:{town:{type:Object}},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)}}},Eh=Ah,Oh=Object(d["a"])(Eh,$h,Th,!1,null,null,null),Ih=Oh.exports,Dh=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"sticky stickyColumn"},[s("div",{staticClass:"font-bold"},[e._v("Rubriques")]),s("LeftColumnNavLink",{attrs:{to:"#characteristics",activeSection:"characteristics"===e.activeSection}},[e._v("Caractéristiques du site")]),s("LeftColumnNavLink",{attrs:{to:"#people",activeSection:"people"===e.activeSection}},[e._v("Habitants")]),s("LeftColumnNavLink",{attrs:{to:"#living_conditions",activeSection:"living_conditions"===e.activeSection}},[e._v("Conditions de vie")]),s("LeftColumnNavLink",{attrs:{to:"#judicial",activeSection:"judicial"===e.activeSection}},[e._v("Procédure judiciaire")]),s("LeftColumnNavLink",{attrs:{to:"#comments",activeSection:"comments"===e.activeSection}},[e._v(" "+e._s(e.town.comments.regular.length)+" commentaires")]),s("div",{staticClass:"flex text-primary font-bold mt-4 cursor-pointer",on:{click:function(t){return e.$emit("openHistory")}}},[s("Icon",{attrs:{icon:"history"}}),s("div",{staticClass:"ml-2"},[e._v("Voir l'historique des modifications")])],1)],1)])},jh=[],qh=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{class:["pl-2 border-l-4 my-2",e.activeSection?"text-primary  border-primary":"border-transparent"]},[s("router-link",{attrs:{to:e.to}},[e._t("default")],2)],1)},Lh=[],Fh={props:{to:{type:String},activeSection:{type:Boolean}}},Mh=Fh,Nh=Object(d["a"])(Mh,qh,Lh,!1,null,null,null),zh=Nh.exports,Bh={components:{LeftColumnNavLink:zh},props:{town:{type:Object}},data(){return{activeSection:"characteristics"}},mounted(){const e=e=>{e.forEach(e=>{e.isIntersecting&&(this.activeSection=e.target.id)})};let t=new IntersectionObserver(e,{rootMargin:"0px",threshold:1});t.observe(document.querySelector("#judicial")),t.observe(document.querySelector("#living_conditions")),t.observe(document.querySelector("#people")),t.observe(document.querySelector("#characteristics"))}},Rh=Bh,Vh=(s("ad9e"),Object(d["a"])(Rh,Dh,jh,!1,null,"016f8be4",null)),Uh=Vh.exports,Hh=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("TownDetailsPanel",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Caractéristiques du site")]},proxy:!0},{key:"body",fn:function(){return[s("div",{staticClass:"flex"},[s("div",{staticClass:"w-1/2 pr-8"},[s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",[s("div",{staticClass:"font-bold"},[e._v(" Installé depuis ")]),s("div",[e._v(" "+e._s(e.formatDateSince(e.town.builtAt))+" ")]),s("div",[e._v(" "+e._s(e.buildAt)+" ")])]),s("div",[s("div",{staticClass:"font-bold"},[e._v(" Signalé depuis ")]),s("div",[e._v(" "+e._s(e.formatDateSince(e.town.declaredAt))+" ")]),s("div",[e._v(" "+e._s(e.declaredAt)+" ")])])])]),s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"font-bold"},[e._v(" Type de site ")]),s("div",{staticClass:"flex items-center"},[s("Icon",{staticClass:"text-lg mr-2",style:"color: "+e.town.fieldType.color,attrs:{icon:"map-marker-alt"}}),e._v(" "+e._s(e.town.fieldType.label)+" ")],1)])]),e.town.addressDetails?s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"font-bold"},[e._v(" Informations d'accès ")]),s("div",[e._v(" "+e._s(e.town.addressDetails)+" ")])])]):e._e(),s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"font-bold"},[e._v(" Propriétaire ")]),s("div",[e._v(" "+e._s(e.town.ownerType.label)+" ")])])])],1),s("div",{staticClass:"w-1/2 bg-G200"},[s("div",{staticClass:"v1"},[s("Map",{attrs:{"display-searchbar":!1,towns:[e.town],"default-view":e.center}})],1)])])]},proxy:!0}])})},Gh=[],Wh=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"shadow p-5"},[s("div",{staticClass:"text-primary text-display-lg"},[e._t("title")],2),s("div",{staticClass:"pt-4"},[e._t("body")],2)])},Yh=[],Jh={},Qh=Object(d["a"])(Jh,Wh,Yh,!1,null,null,null),Zh=Qh.exports,Kh=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"border-t border-G200 py-4"},[e._t("default")],2)},Xh=[],ev={},tv=Object(d["a"])(ev,Kh,Xh,!1,null,null,null),sv=tv.exports;function iv(e){const t=new Date,s=new Date(1e3*e);let i=0;if(t.getFullYear()===s.getFullYear())i=Math.max(0,t.getMonth()-s.getMonth());else if(t.getFullYear()>s.getFullYear()){const e=t.getFullYear()-s.getFullYear();i=12*(e-1)+(t.getMonth()+12-s.getMonth())}return{years:Math.floor(i/12),months:i%12}}var av={props:{town:{type:Object}},components:{TownDetailsPanel:Zh,TownDetailsPanelSection:sv,Map:Cu},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)},formatDateSince(e){const{years:t,months:s}=iv(e);return t>0?`${t} an${t>1?"s":""}`:s>0?s+" mois":""}},computed:{buildAt(){return new Date(1e3*this.town.builtAt).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})},declaredAt(){return new Date(1e3*this.town.declaredAt).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})},center(){return{center:[this.town.latitude,this.town.longitude],zoom:15}}}},nv=av,ov=Object(d["a"])(nv,Hh,Gh,!1,null,null,null),rv=ov.exports,lv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("TownDetailsPanel",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Habitants")]},proxy:!0},{key:"body",fn:function(){return[s("TownDetailsPanelSection",[s("div",{staticClass:"flex items-center mb-4"},[s("div",{staticClass:"text-display-sm mr-4"},[e._v(" "+e._s(e.town.populationTotal||0)+" personnes ")]),s("div",{staticClass:"text-display-sm mr-4"},[e._v(" "+e._s(e.town.populationCouples||0)+" ménages ")]),s("div",{staticClass:"text-display-sm"},[e._v(" "+e._s(e.town.populationMinors||0)+" mineurs ")])]),s("div",[s("div",{staticClass:"font-bold"},[e._v("Origine")]),e._l(e.town.socialOrigins,(function(t){return s("div",{key:t.id,staticClass:"flex items-center"},[s("img",{staticClass:" w-8 mr-2",attrs:{src:e.socialOrigin(t).img}}),s("span",{staticClass:"text-display-sm"},[e._v(e._s(e.socialOrigin(t).label))])])}))],2)]),s("TownDetailsPanelSection",[s("div",{staticClass:"flex items-center justify-between"},[s("div",{staticClass:"w-96"},[s("div",{staticClass:"font-bold"},[e._v("Diagnostic social")]),s("div",[e._v(e._s(e.socialDiagnostic))])]),s("div",{staticClass:"italic"},[e._v(" Un diagnostic social vise à identifier les situations et besoins des familles et personnes, de repérer le contexte territorial et les acteurs en présence. ")])])])]},proxy:!0}])})},cv=[],dv={props:{town:{type:Object}},components:{TownDetailsPanel:Zh,TownDetailsPanelSection:sv},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)},socialOrigin(e){return 1===e.id?{id:1,label:"Français",img:Up.a}:2===e.id?{id:2,label:"Européens",img:Rp.a}:3===e.id?{id:3,label:"Extra-communautaires",img:Gp.a}:e}},computed:{socialDiagnostic(){return"done"===this.town.censusStatus?`Réalisé le ${this.formatDate(this.town.censusConductedAt,"y/m/d")} par ${this.town.censusConductedBy}`:"Non réalisé"}}},uv=dv,pv=Object(d["a"])(uv,lv,cv,!1,null,null,null),mv=pv.exports,hv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("TownDetailsPanel",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Conditions de vies")]},proxy:!0},{key:"body",fn:function(){return[s("div",{staticClass:"grid grid-cols-2"},[s("TownDetailsPanelLivingConditionsSection",{attrs:{title:"Accès à l’eau",value:e.town.accessToWater}},[e._v(" "+e._s(e.town.waterComments)+" ")]),s("TownDetailsPanelLivingConditionsSection",{attrs:{title:"Accès aux toilettes",value:e.town.accessToSanitary}},[e._v(e._s(e.town.sanitaryComments))]),s("TownDetailsPanelLivingConditionsSection",{attrs:{title:"Accès à l’électricité",value:e.town.electricityType.value}},[e._v(e._s(e.town.electricityComments))]),s("TownDetailsPanelLivingConditionsSection",{attrs:{title:"Évacuation des déchets",value:e.town.trashEvacuation}})],1)]},proxy:!0}])})},vv=[],fv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("TownDetailsPanelSection",[s("div",{staticClass:"flex items-center"},[s("Icon",{class:[e.colorClass,"mr-1","font-bold"],attrs:{icon:e.icon}}),s("div",[s("div",{staticClass:"flex items-center"},[s("div",{class:[e.colorClass,"font-bold","mr-1"]},[e._v(" "+e._s(e.title)+": ")]),s("div",[e._v(e._s(e.text))])]),e._t("default")],2)],1)])},_v=[],gv={components:{TownDetailsPanelSection:sv},props:{title:{type:String},value:{validator:e=>"boolean"===typeof e||null===e}},computed:{colorClass(){return!0===this.value?"text-green":"text-red"},icon(){return{null:"question",false:"times",true:"check"}[this.value]},text(){return{null:"inconnu",false:"non",true:"oui"}[this.value]}}},bv=gv,yv=Object(d["a"])(bv,fv,_v,!1,null,null,null),Cv=yv.exports,wv={props:{town:{type:Object}},components:{TownDetailsPanelLivingConditionsSection:Cv,TownDetailsPanel:Zh}},xv=wv,kv=Object(d["a"])(xv,hv,vv,!1,null,null,null),Pv=kv.exports,Sv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("TownDetailsPanel",{scopedSlots:e._u([{key:"title",fn:function(){return[e._v("Procédures judiciaires")]},proxy:!0},{key:"body",fn:function(){return[s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"flex items-center"},[s("Icon",{staticClass:"mr-2",attrs:{icon:"scroll"}}),s("div",{staticClass:"font-bold"},[e._v(" Dépôt de plainte du propriétaire ")])],1),s("div",[e._v(e._s(e.town.ownerComplaint?"oui":"non"))])])]),s("div",{staticClass:"flex"},[s("Icon",{staticClass:"mr-4 mt-5",attrs:{icon:"balance-scale"}}),s("div",{staticClass:"flex-1"},[s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"font-bold"},[e._v(" Existence d’une procédure judiciaire ")]),s("div",{staticClass:"-ml-5"},[e._v(" "+e._s(e.town.justiceProcedure?"oui":"non")+" ")])])]),s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"font-bold"},[e._v(" Décision de justice rendue ")]),s("div",{staticClass:"-ml-5"},[e._v(" "+e._s(e.town.justiceRenderedAt?"rendue le "+e.formatDate(e.town.justiceRenderedAt,"y/m/d"):"non")+" ")])])]),s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"font-bold"},[e._v("Contentieux")]),s("div",{staticClass:"-ml-5"},[e._v(" "+e._s(e.town.justiceChallenged?"oui":"non")+" ")])])])],1)],1),s("TownDetailsPanelSection",[s("div",{staticClass:"grid grid-cols-2"},[s("div",{staticClass:"flex items-center"},[s("img",{staticClass:"w-6 h-6 mr-2",attrs:{src:e.policeSiren}}),s("div",{staticClass:"font-bold"},[e._v(" Concours de la force publique ")])]),s("div",[e._v(e._s(e.policeStatusLabel))])])])]},proxy:!0}])})},$v=[],Tv={props:{town:{type:Object}},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)}},components:{TownDetailsPanel:Zh,TownDetailsPanelSection:sv},computed:{policeSiren(){return Wm.a},policeStatusLabel(){return"none"===this.town.policeStatus?"Non demandé":"requested"===this.town.policeStatus?"Demandé le "+this.formatDate(this.town.policeRequestedAt,"y/m/d"):"granted"===this.town.policeStatus?"Accordé le  "+this.formatDate(this.town.policeGrantedAt,"y/m/d"):"NC"}}},Av=Tv,Ev=Object(d["a"])(Av,Sv,$v,!1,null,null,null),Ov=Ev.exports,Iv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"text-display-lg text-corail py-6"},[s("Icon",{attrs:{icon:"comment"}}),e._v(" Écrire un commentaire ")],1),s("div",{staticClass:"bg-white p-6"},[s("div",{staticClass:"mb-4"},[s("Icon",{attrs:{icon:"user"}}),e._v(" "+e._s(e.user.first_name))],1),s("TextArea",{attrs:{rows:"10",name:"newComment",placeholder:"Votre commentaire - Merci de respecter les règles de confidentialité."},model:{value:e.newComment,callback:function(t){e.newComment=t},expression:"newComment"}}),e._v(" "),s("div",{staticClass:"flex items-center justify-between"},[s("Button",{attrs:{variant:"primaryText"},on:{click:e.cancelComment}},[e._v("Annuler")]),s("Button",{attrs:{variant:"primary"},on:{click:e.addComment}},[e._v("Valider")])],1)],1)])},Dv=[],jv={data(){return{commentError:null,commentErrors:{},newComment:""}},props:{user:{type:Object}},methods:{cancelComment(){this.newComment=""},addComment(){Io("shantytown_comment.create")&&(this.commentError=null,this.commentErrors={},ll(this.$route.params.id,{description:this.newComment}).then(e=>{this.$emit("submit",e.comments),this.newComment=""}).catch(e=>{this.commentError=e.user_message,this.commentErrors=e.fields||{}}))}}},qv=jv,Lv=Object(d["a"])(qv,Iv,Dv,!1,null,null,null),Fv=Lv.exports,Mv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"text-display-lg text-corail py-6"},[e._v(" "+e._s(e.comments.length)+" commentaires ")]),e._l(e.comments,(function(e){return s("CommentBlock",{key:e.id,attrs:{comment:e}})}))],2)},Nv=[],zv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"border-t border-G400 py-4"},[s("div",{staticClass:"text-G600 text-sm mb-1"},[e._v(" "+e._s(e.formatDate(e.comment.createdAt,"d M y à h:i"))+" ")]),s("div",{staticClass:"text-primary font-bold mb-1"},[s("Icon",{attrs:{icon:"user"}}),e._v(" "+e._s(e.comment.createdBy.firstName)+" "+e._s(e.comment.createdBy.lastName)+" - "+e._s(e.comment.createdBy.organization)+" ")],1),s("div",{staticClass:"ml-5"},[e._v(e._s(e.comment.description))])])},Bv=[],Rv={props:{comment:{type:Object}},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)}}},Vv=Rv,Uv=Object(d["a"])(Vv,zv,Bv,!1,null,null,null),Hv=Uv.exports,Gv={components:{CommentBlock:Hv},props:{comments:{type:Array}}},Wv=Gv,Yv=Object(d["a"])(Wv,Mv,Nv,!1,null,null,null),Jv=Yv.exports,Qv=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("SidePanel",{attrs:{isOpen:e.isOpen,closePanel:e.closePanel,closeClickOutside:!0}},[s("div",{staticClass:"  px-8 "},[s("div",{staticClass:"border-b-2 border-G200 py-4"},[s("div",{staticClass:"flex justify-end"},[s("Button",{attrs:{variant:"primaryText",icon:"times",size:"lg"},on:{click:e.closePanel}})],1),s("div",{staticClass:"flex items-center text-primary"},[s("Icon",{staticClass:"mr-2 ",attrs:{icon:"history"}}),s("div",{staticClass:"text-display-md text-primary"},[e._v(" Historique des modifications ")])],1)]),s("div",[s("div",{staticClass:"text-sm font-bold my-4"},[e._v(" "+e._s(e.town.changelog.length)+" modification"+e._s(e.town.changelog.length>1?"s":"")+" ")]),e._l(e.town.changelog,(function(t){return s("div",{key:t.id,staticClass:"py-4 border-b-2 border-G200"},[s("div",{staticClass:"text-sm text-G600"},[e._v(" "+e._s(e.formatDate(t.date,"d M y à h:i"))+" ")]),s("div",{staticClass:"text-primary"},[s("router-link",{attrs:{to:"/annuaire/"+t.author.organization.id}},[s("div",{staticClass:"flex items-center"},[s("font-awesome-icon",{staticClass:"w-8 text-md",attrs:{icon:"user"}}),s("div",{staticClass:"font-bold ml-2"},[e._v(" "+e._s(t.author.first_name)+" "+e._s(t.author.last_name)+" ")])],1)])],1),s("div",e._l(t.diff,(function(t){return s("div",{key:t.field,staticClass:"changelogContent my-2"},[s("div",{staticClass:"text-green"},[e._v(e._s(t.field))]),s("div",[s("span",{staticClass:"line-through"},[e._v(e._s(t.oldValue||"non renseigné"))]),s("span",[e._v(", "+e._s(t.newValue||"non renseigné")+" ")])])])})),0)])}))],2)])])},Zv=[],Kv={props:{town:{type:Object},isOpen:{type:Boolean},closePanel:{type:Function}},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)}}},Xv=Kv,ef=(s("fd66"),Object(d["a"])(Xv,Qv,Zv,!1,null,null,null)),tf=ef.exports,sf=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("SidePanel",{attrs:{isOpen:e.isOpen,closePanel:e.closePanel,closeClickOutside:!0}},[s("div",{staticClass:"scrollablePanel"},[s("div",{staticClass:"  px-8 "},[s("div",{staticClass:"border-b-2 border-G200 py-4"},[s("div",{staticClass:"flex justify-end"},[s("Button",{attrs:{variant:"primaryText",icon:"times",size:"lg"},on:{click:e.closePanel}})],1),s("div",{staticClass:"flex items-center text-primary"},[s("Icon",{staticClass:"mr-2 ",attrs:{icon:"comment"}}),s("div",{staticClass:"text-display-md text-primary"},[e._v(" Commentaire Covid-19 ")])],1)]),s("div",{staticClass:"text-G600 italic text-sm my-2"},[e._v(" Merci de préciser votre action, ses modalités, et le nombrede personnes avec des symptômes.Merci de respecter les règles de confidentialité. Ne pas citer l’identité des individus (Nom, âge, sexe, origine...) ")]),s("ValidationObserver",{ref:"form",scopedSlots:e._u([{key:"default",fn:function(t){var i=t.handleSubmit;return[s("form",{on:{submit:function(t){return t.preventDefault(),i(e.addCovidComment)}}},[s("div",{staticClass:"font-bold"},[e._v("Date de votre intervention")]),s("DatepickerV2",{attrs:{variant:"town",id:"closed_at",validationName:"Date","disabled-dates":{from:new Date},language:e.dateLanguage,"monday-first":!0,"full-month-name":!0,format:"dd MMMM yyyy",rules:"required"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}}),s("div",{staticClass:"font-bold"},[e._v("Préciser votre intervention")]),s("CheckableGroup",[s("Checkbox",{attrs:{variant:"town",checkValue:"equipe_maraude",label:"Équipe de maraude"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}}),s("Checkbox",{attrs:{variant:"town",checkValue:"equipe_sanitaire",label:"Équipe sanitaire"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}}),s("Checkbox",{attrs:{variant:"town",checkValue:"equipe_accompagnement",label:"Équipe d'accompagnement"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}}),s("Checkbox",{attrs:{variant:"town",checkValue:"distribution_alimentaire",label:"Distribution d'aide alimentaire"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}})],1),s("div",{staticClass:"font-bold"},[e._v("Signaler si nécessaire")]),s("CheckableGroup",[s("Checkbox",{attrs:{variant:"town",checkValue:"personnes_orientees",label:"Personne(s) orientée(s) vers un centre d'hébergement"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}}),s("Checkbox",{attrs:{variant:"town",checkValue:"personnes_avec_symptomes",label:"Personne(s) avec des symptômes Covid-19"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}}),s("Checkbox",{attrs:{variant:"town",checkValue:"besoin_action",label:"Besoin d'une action prioritaire"},model:{value:e.form.interventionType,callback:function(t){e.$set(e.form,"interventionType",t)},expression:"form.interventionType"}})],1),s("div",{staticClass:"text-display-sm"},[e._v("Ecrire un commentaire")]),s("TextArea",{attrs:{rows:"10",name:"newComment"},model:{value:e.form.newComment,callback:function(t){e.$set(e.form,"newComment",t)},expression:"form.newComment"}}),e._v(" "),s("div",{staticClass:"flex items-center justify-between"},[s("Button",{attrs:{variant:"primaryText",type:"button"},on:{click:e.cancelComment}},[e._v("Annuler")]),s("Button",{attrs:{variant:"primary"},on:{click:e.addCovidComment}},[e._v("Valider")])],1)],1)]}}])})],1),s("div",{staticClass:"bg-orange200 px-8 py-4 mt-4"},[s("div",{staticClass:"font-bold mb-4"},[e._v(" "+e._s(this.town.comments.covid.length)+" commentaires ")]),e._l(e.sortedComments,(function(e){return s("CommentBlock",{key:e.id,attrs:{comment:e}})}))],2)])])},af=[],nf={components:{CommentBlock:Hv,CheckableGroup:Us},props:{town:{type:Object},isOpen:{type:Boolean},closePanel:{type:Function}},data(){return{dateLanguage:Ws["fr"],form:{date:new Date,interventionType:[],newComment:""}}},computed:{sortedComments(){const e=[...this.town.comments.covid];return e.sort((e,t)=>e.createdAt-t.createdAt)}},methods:{formatDate(...e){return window.App.formatDate.apply(window,e)},cancelComment(){this.newComment=""},addCovidComment(){this.covidErrors=[],cl(this.$route.params.id,{date:this.form.date,description:this.form.newComment,equipe_maraude:this.form.interventionType.includes("equipe_maraude"),equipe_sanitaire:this.form.interventionType.includes("equipe_sanitaire"),equipe_accompagnement:this.form.interventionType.includes("equipe_accompagnement"),distribution_alimentaire:this.form.interventionType.includes("distribution_alimentaire"),personnes_orientees:this.form.interventionType.includes("personnes_orientees"),personnes_avec_symptomes:this.form.interventionType.includes("personnes_avec_symptomes"),besoin_action:this.form.interventionType.includes("besoin_action")}).then(e=>{this.$emit("updateTown",{...this.town,comments:{...this.town.comments,covid:e}}),this.form={newComment:"",interventionType:[]}}).catch(e=>{const t=e.fields||{};this.covidErrors=Object.keys(t).reduce((e,s)=>[...e,...t[s]],[])})}}},of=nf,rf=(s("1118"),Object(d["a"])(of,sf,af,!1,null,null,null)),lf=rf.exports,cf=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("Modal",{staticClass:"modalContainer",attrs:{isOpen:e.isOpen,closeModal:e.closeModal},scopedSlots:e._u([{key:"title",fn:function(){return[s("div",[e._v("Fermer le site")])]},proxy:!0},{key:"body",fn:function(){return[s("ValidationObserver",{ref:"form",scopedSlots:e._u([{key:"default",fn:function(t){var i=t.handleSubmit;return[s("form",{on:{submit:function(t){return t.preventDefault(),i(e.submitClose)}}},[s("div",{staticClass:"scrollableContainer"},[s("div",[s("div",{staticClass:"w-64"},[s("div",{staticClass:"font-bold"},[e._v(" Date de la fermeture du site ")]),s("DatepickerV2",{attrs:{variant:"town",id:"closed_at",validationName:"Date","disabled-dates":{from:new Date},language:e.dateLanguage,"monday-first":!0,"full-month-name":!0,format:"dd MMMM yyyy",rules:"required"},model:{value:e.form.closed_at,callback:function(t){e.$set(e.form,"closed_at",t)},expression:"form.closed_at"}})],1)]),s("div",[s("div",{staticClass:"font-bold"},[e._v(" Est-ce que ce site a été résorbé définitivement ? ")]),s("div",{staticClass:"italic text-G600 w-192 text-sm my-2"},[e._v(" C’est-à-dire sans réinstallation illicite et avec un accompagnement de la majorité des personnes vers des solutions pérennes ")]),s("CheckableGroup",{attrs:{direction:"row",id:"closed_with_solutions",rules:"required",validationName:"Est-ce que ce site a été résorbé définitivement ?"}},[s("Radio",{staticClass:"mr-1",attrs:{checkValue:!0,label:"Oui",variant:"townCard"},model:{value:e.form.closed_with_solutions,callback:function(t){e.$set(e.form,"closed_with_solutions",t)},expression:"form.closed_with_solutions"}}),s("Radio",{attrs:{checkValue:!1,label:"Non",variant:"townCard"},model:{value:e.form.closed_with_solutions,callback:function(t){e.$set(e.form,"closed_with_solutions",t)},expression:"form.closed_with_solutions"}})],1)],1),s("div",[s("div",{staticClass:"font-bold"},[e._v("Cause de la disparition")]),s("CheckableGroup",{attrs:{id:"status",direction:"vertical",rules:"required",validationName:"Cause de la disparition"}},e._l(e.statusValues,(function(t,i){return s("Radio",{key:i,attrs:{variant:"town",label:t.label,checkValue:t.value},model:{value:e.form.status,callback:function(t){e.$set(e.form,"status",t)},expression:"form.status"}})})),1)],1),s("div",[s("div",{staticClass:"font-bold"},[e._v(" Orientations des ménages : ")]),e._l(e.closingSolutions,(function(t,i){return s("div",{key:t.id},[s("Checkbox",{key:i,attrs:{variant:"town",label:t.label,checkValue:t.id,id:"solutions"},model:{value:e.checkedSolutions,callback:function(t){e.checkedSolutions=t},expression:"checkedSolutions"}}),s("div",{staticClass:"flex items-center ml-10"},[s("InlineTextInput",{staticClass:"mr-4",attrs:{label:"Ménages : ",type:"number",variant:"town"},model:{value:e.form.solutions[t.id].householdsAffected,callback:function(s){e.$set(e.form.solutions[t.id],"householdsAffected",s)},expression:"\n                                        form.solutions[item.id]\n                                            .householdsAffected\n                                    "}}),s("InlineTextInput",{attrs:{label:"Personnes : ",type:"number",variant:"town"},model:{value:e.form.solutions[t.id].peopleAffected,callback:function(s){e.$set(e.form.solutions[t.id],"peopleAffected",s)},expression:"\n                                        form.solutions[item.id]\n                                            .peopleAffected\n                                    "}})],1)],1)}))],2)]),s("div",{staticClass:"flex justify-end mt-8"},[s("Button",{staticClass:"mr-8",attrs:{variant:"primaryText",type:"button"},on:{click:e.closeModal}},[e._v("Annuler")]),s("Button",{attrs:{variant:"primary",type:"primary",loading:e.loading}},[e._v("Valider")])],1)])]}}])})]},proxy:!0}])})},df=[],uf={components:{CheckableGroup:Us,InlineTextInput:Le},props:{isOpen:{type:Boolean},town:{type:Object}},methods:{closeModal(){this.$emit("closeModal")},async submitClose(){this.loading=!0,this.error=null;try{await ol(this.town.id,{...this.form,solutions:Object.keys(this.form.solutions).filter(e=>this.form.solutions[e].checked).map(e=>({id:e,peopleAffected:this.form.solutions[e].peopleAffected?parseInt(this.form.solutions[e].peopleAffected,10):null,householdsAffected:this.form.solutions[e].householdsAffected?parseInt(this.form.solutions[e].householdsAffected,10):null}))})}catch(t){return this.loading=!1,this.error=t,void this.$refs.form.setErrors(t.fields)}zc({group:"notifications",type:"success",title:"Site correctement fermé",text:"Le site a bien été marqué comme fermé"});const e=await il(this.$route.params.id);this.$emit("updateTown",e),this.loading=!1,this.closeModal()},closePopin(){this.$emit("cancelCloseTown")}},data(){const{closing_solutions:e}=Ao();return{loading:!1,error:null,form:{closed_at:null,closed_with_solutions:null,status:null,solutions:this.town.closingSolutions?e.reduce((e,t)=>{const s=Object.assign(e,{}),i=this.town.closingSolutions.find(e=>e.id===t.id);return s[t.id]={checked:void 0!==i,peopleAffected:i&&i.peopleAffected,householdsAffected:i&&i.householdsAffected},s},{}):[]},closingSolutions:e,dateLanguage:Ws["fr"],checkedSolutions:[],statusValues:[{value:"closed_by_justice",label:"Exécution d'une décision de justice"},{value:"closed_by_admin",label:"Exécution d'une décision administrative"},{value:"other",label:"Autre"},{value:"unknown",label:"Raison inconnue"}]}},watch:{checkedSolutions:function(e){Object.keys(this.form.solutions).forEach(t=>{this.form.solutions[t].checked=e.includes(Number(t))})}}},pf=uf,mf=(s("cee3"),Object(d["a"])(pf,cf,df,!1,null,null,null)),hf=mf.exports,vf={components:{TownDetailsCloseModal:hf,TownDetailsHistorySidePanel:tf,TownDetailsNewComment:Fv,TownDetailsComments:Jv,PrivateLayout:Ip,PrivateContainer:Sp,TownDetailsHeader:Ih,TownDetailsLeftColumn:Uh,TownDetailsPanelCharacteristics:rv,TownDetailsPanelPeople:mv,TownDetailsPanelLivingConditions:Pv,TownDetailsPanelJudicial:Ov,TownDetailsCovidCommentsSidePanel:lf},data(){const{field_types:e,user:t}=Ao();return{historyOpen:!1,closeOpen:!1,covidOpen:!1,error:null,loading:!1,town:null,fieldTypes:e,user:t}},created(){this.fetchData()},methods:{openHistory(){this.historyOpen=!0},openCancel(){this.closeOpen=!0},openCovid(){this.covidOpen=!0},fetchData(){!0!==this.loading&&(this.loading=!0,this.error=null,il(this.$route.params.id).then(e=>{this.loading=!1,this.town=Ym(e,this.fieldTypes),this.resetEdit()}).catch(e=>{this.error=e.user_message,this.loading=!1}))}}},ff=vf,_f=(s("0a67"),Object(d["a"])(ff,Ph,Sh,!1,null,"5aec0303",null)),gf=_f.exports,bf=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),e.preloading&&!e.preloadError?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e.preloading&&e.preloadError?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.preloadError)+". "),s("a",{attrs:{href:"#"},on:{click:e.preload}},[e._v("Réessayer ?")])])]):s("div",[s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1)),s("p",[e._v("Plus d'informations sur les droits d'accès et les utilisateurs de la plateforme"),s("br"),s("router-link",{staticClass:"link",attrs:{to:"/typologie-des-acces"}},[s("font-awesome-icon",{attrs:{icon:"file-pdf"}}),e._v(" Guide des accès et de l'administrateur")],1),s("br"),s("router-link",{staticClass:"link",attrs:{to:"/charte-d-engagement"}},[s("font-awesome-icon",{attrs:{icon:"file-pdf"}}),e._v(" Charte d'engagement de l'utilisateur")],1)],1)],1)],1)])},yf=[],Cf={components:{NavBar:cr,Form:Hc},data(){const e={first_name:"",last_name:"",password:""},t={title:"Modifier vos données personnelles",description:"Vous pouvez compléter votre profil d'utilisateur et modifier votre mot de passe sur cette page.",steps:[{title:"",sections:[{title:"",inputs:{first_name:{label:"Votre prénom",mandatory:!0,type:"text"},last_name:{label:"Votre nom de famille",mandatory:!0,type:"text"},password:{label:"Mot de passe",description:"Laissez ce champ vide si vous souhaitez conserver votre mot de passe actuel.<br/><br/>Votre mot de passe doit comporter au minimum 12 caractères, une majuscule, une minuscule, et un caractère non alphabétique (exemples : '.' ';' ',' '_' '!' '?', ...)<br/>Nous vous recommandons de choisir <strong>une phrase intelligible en guise de mot de passe</strong> : plus simple à retenir qu'une suite de caractères aléatoires, et plus sécurisée.",mandatory:!1,type:"password"}}}],wording:{submit:"Modifier",error:"Les modifications n'ont pas été appliquées",success:"Les modifications ont bien été prises en compte"},submit:Vo}]};return{preloading:!0,preloadError:null,loading:!1,formData:e,formDefinition:t}},created(){this.preload()},methods:{preload(){this.preloadError=null,this.preloading=!0,this.fetchData().then(()=>{this.preloading=!1}).catch(e=>{this.preloadError=e.user_message})},fetchData(){return Ro().then(e=>{this.formData.first_name=e.first_name,this.formData.last_name=e.last_name,this.formData.password=""})},onComplete(){this.preload()}}},wf=Cf,xf=wf,kf=(s("9985"),Object(d["a"])(xf,bf,yf,!1,null,"dd1c1884",null)),Pf=kf.exports,Sf=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("h1",[e._v("Liste des utilisateurs")]),"loading"===e.state?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),"error"===e.state?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])]):e._e(),"loaded"===e.state?s("div",[s("header",{staticClass:"userList-header"},[s("router-link",{staticClass:"link",attrs:{to:"/typologie-des-acces"}},[s("font-awesome-icon",{attrs:{icon:"file-pdf"}}),e._v(" Guide des accès et de l'administrateur")],1),s("router-link",{staticClass:"link",attrs:{to:"/charte-d-engagement"}},[s("font-awesome-icon",{attrs:{icon:"file-pdf"}}),e._v(" Charte d'engagement de l'utilisateur")],1),s("router-link",{staticClass:"button",attrs:{to:"/nouvel-utilisateur"}},[e._v("Ajouter un utilisateur")])],1),s("Table",e._b({on:{"on-row-click":e.routeToUserValidation},scopedSlots:e._u([{key:"table-row",fn:function(t){return["status"===t.column.id?s("span",[s("font-awesome-icon",{staticClass:"user-statusIcon",class:"user-statusIcon--"+t.formattedRow[t.column.field].icon,attrs:{icon:t.formattedRow[t.column.field].icon}}),e._v(" "),s("span",{domProps:{innerHTML:e._s(t.formattedRow[t.column.field].label)}})],1):"role"===t.column.id?s("span",[s("span",{staticClass:"role"},[e._v(e._s(t.formattedRow[t.column.field]))])]):"validate"===t.column.id?s("span",[s("span",[s("font-awesome-icon",{staticClass:"user-validateIcon",attrs:{icon:"arrow-right"},on:{click:e.routeToUserValidation}})],1)]):s("span",{class:"userList-row--"+t.column.id},[e._v(e._s(t.formattedRow[t.column.field]))])]}}],null,!1,1614286866)},"Table",e.tableProperties,!1))],1):e._e()])])],1)])},$f=[],Tf=s("f617"),Af=(s("dac4"),function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"alert"},[s("div",{ref:"wrapper",staticClass:"wrapper"},[s("div",{staticClass:"alert-close"},[s("div",{staticClass:"alert-close-wrapper"},[s("img",{attrs:{src:"/img/cross.svg",alt:"",width:"20"},on:{click:e.close}})])]),e._t("default")],2)])}),Ef=[],Of={mounted(){document.addEventListener("click",this.checkOutsideClick)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{checkOutsideClick(e){0!==this.$refs.wrapper.offsetHeight&&(this.$refs.wrapper.contains(e.target)||this.close())},close(){this.$emit("close")}}},If=Of,Df=If,jf=(s("aaf3"),Object(d["a"])(Df,Af,Ef,!1,null,"70f3cb96",null)),qf=jf.exports,Lf={components:{NavBar:cr,Table:Tf["a"],Modal:qf},data(){const{token_expires_in:e}=Ao();return{tokenExpiresIn:e,users:[],error:null,state:null}},computed:{tableProperties(){return{columns:[{id:"lastName",label:"NOM",field:e=>e.last_name.toUpperCase()},{id:"firstName",label:"PRÉNOM",field:"first_name"},{id:"organization",label:"STRUCTURE",field:e=>null!==e.organization.type.abbreviation?`${e.organization.type.abbreviation} (${e.organization.name})`:null!==e.organization.abbreviation?`${e.organization.abbreviation} (${e.organization.name})`:e.organization.name},{id:"location",label:"TERRITOIRE",field:e=>{if("nation"===e.organization.location.type)return"National";const t=e.organization.location[e.organization.location.type];return t?"departement"===e.organization.location.type?`${t.name} (${t.code})`:t.name:""}},{id:"role",label:"TYPE D'ACCÈS",field:"role",width:"230px",thClass:"userList-column--role",tdClass:"userList-column--role"},{id:"status",label:"STATUT DU COMPTE",field:e=>"active"===e.status?"local_admin"===e.role_id?{icon:"user-shield",label:"<strong>Administrateur local</strong>"}:"national_admin"===e.role_id?{icon:"user-shield",label:"<strong>Administrateur national</strong>"}:{icon:"user-check",label:"<strong>Compte activé</strong> le "+App.formatDate(e.activated_on,"d M y")}:null!==e.last_activation_link_sent_on?Date.now()-1e3*e.activation_link_expires_on>=0?{icon:"unlink",label:"<strong>Lien expiré</strong> le "+App.formatDate(e.activation_link_expires_on,"d M y")}:{icon:"paper-plane",label:"<strong>Accès envoyé</strong> le "+App.formatDate(e.last_activation_link_sent_on,"d M y")}:{icon:"flag",label:"<strong>Demandé</strong> le "+App.formatDate(e.created_at,"d M y")}},{id:"validate",label:"",field:()=>!0}],rows:this.users,"row-style-class":e=>"active"!==e.status&&null===e.last_activation_link_sent_on?"userList-row userList-row--highlight":"userList-row","sort-options":{enabled:!0},"search-options":{enabled:!0,placeholder:"Rechercher par utilisateur, structure, territoire, ou type d'accès"}}}},created(){this.load()},methods:{load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,Uo().then(e=>{this.users=e.filter(({status:e})=>"inactive"!==e),this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},retryLoading(){this.load()},routeToUserValidation(e){const t=this.$router.resolve("/nouvel-utilisateur/"+e.row.id);mo(t.href)}}},Ff=Lf,Mf=Ff,Nf=(s("5e31"),Object(d["a"])(Mf,Sf,$f,!1,null,null,null)),zf=Nf.exports,Bf=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[e.isPopup?e._e():s("NavBar"),"loading"===e.state?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),"error"===e.state?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.loadingError)+". "),s("span",{on:{click:e.retryLoading}},[e._v("Réessayer ?")])])]):e._e(),"loaded"===e.state?s("div",[s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1):e._e()],1)])},Rf=[],Vf=(e,t)=>({data(){const s={},i={title:e.title,descriptionTitle:"",description:e.description,steps:[{wording:e.stepWording,sections:[{title:"Informations personnelles",inputs:{last_name:{label:"NOM",mandatory:!0,type:"text"},first_name:{label:"Prénom",mandatory:!0,type:"text"},email:{label:"Courriel",mandatory:!0,type:"text"}}},{title:e.organizationTitle,inputs:{organization_category:{label:e.organization,mandatory:!0,type:"radio",options:[]},organization_type:{label:"Précisez le type de structure",mandatory:!0,type:"select",options:[],condition({organization_category:e}){return"public_establishment"===e}},organization_public:{label:"Territoire de rattachement",mandatory:!0,type:"select",options:[],condition:({organization_category:e,organization_type:t})=>"public_establishment"===e&&void 0!==t},territorial_collectivity:{label:"Nom de la structure",mandatory:!0,type:"collectivity",condition({organization_category:e}){return"territorial_collectivity"===e}},association:{label:"Nom de la structure",mandatory:!0,type:"select",options:[],condition({organization_category:e}){return"association"===e}},newAssociationName:{label:"Précisez le nom complet",mandatory:!0,type:"text",condition({organization_category:e,association:t}){return"association"===e&&"Autre"===t}},newAssociationAbbreviation:{label:"Précisez l'acronyme, si besoin",mandatory:!1,type:"text",condition({organization_category:e,association:t}){return"association"===e&&"Autre"===t}},departement:{label:"Territoire de rattachement",mandatory:!0,type:"select",options:[],condition({organization_category:e}){return"association"===e}},organization_administration:{label:"Nom de la structure",mandatory:!0,type:"select",options:[],condition({organization_category:e}){return"administration"===e}},position:{label:e.position,mandatory:!0,type:"text",condition({organization_category:e}){return void 0!==e}}}}],submit:e=>t({...e,legal:e.legal&&1===e.legal.length&&!0===e.legal[0]})}]};return{state:null,loadingError:null,formData:s,formDefinition:i}},watch:{"formData.organization_type":function(){this.$refs.form.getInputById("organization_public").options=[],nd(this.formData.organization_type).then(({organizations:e})=>{this.$refs.form.getInputById("organization_public").options=e.map(e=>{const t=e.location_type;let s=e[t+"_name"];return"nation"===t?s="France":"departement"===t&&(s=`${e[t+"_code"]} - ${e[t+"_name"]}`),{value:e.id,label:s}}),this.formData.organization_public=void 0})}},methods:{load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.loadingError=null,Promise.all([sd(),id("public_establishment"),ad("administration"),ad("association"),Er()]).then(([{categories:t},{types:s},{organizations:i},{organizations:a},{departements:n}])=>{this.formDefinition.steps[0].sections[1].inputs.organization_category.options=t.map(({uid:e,name_singular:t})=>({value:e,label:t})),this.formDefinition.steps[0].sections[1].inputs.organization_type.options=s.filter(({numberOfOrganizations:e})=>e>0).filter(({name_singular:e})=>"Gendarmerie nationale"!==e).map(({id:e,name_singular:t,abbreviation:s})=>({value:e,label:s||t})),this.formDefinition.steps[0].sections[1].inputs.organization_administration.options=i.map(({id:e,name:t})=>({value:e,label:t}));const o=[];this.formDefinition.steps[0].sections[1].inputs.association.options=[{label:"Autres cas",options:[{value:"Autre",label:e.associationIsMissing}]},{label:"Associations connues",options:a.filter(e=>-1===o.indexOf(e.name)&&(o.push(e.name),!0)).map(({name:e,abbreviation:t})=>({value:e,label:null!==t?`${t} (${e})`:e}))}],this.formDefinition.steps[0].sections[1].inputs.departement.options=n.map(({code:e,name:t})=>({value:e,label:`${e} - ${t}`})),this.state="loaded"}).catch(({user_message:e})=>{this.loadingError=e,this.state="error"}))}}});const Uf=Vf({title:"Créer un utilisateur",organizationTitle:"Structure",organization:"Quelle est la structure de l'utilisateur ?",position:"Fonction de l'utilisateur",associationIsMissing:"L'association de l'utilisateur n'est pas dans cette liste",stepWording:{submit:"Continuer",error:"L'utilisateur n'a pas pu être créé",success:"L'utilisateur a bien été créé"}},Bo);var Hf={components:{NavBar:cr,Form:Hc},data(){const e=Uf.data();return e.isPopup=void 0!==this.$route.query.association_name,e.formDefinition.steps[0].sections.push({inputs:{legal:{label:"",mandatory:!1,type:"checkbox",options:[{value:!0,label:"Je certifie que ces données personnelles ont été saisies avec l'accord de leur propriétaire"}]}}}),void 0!==this.$route.query.association_name&&(e.formDefinition.steps[0].sections[1].inputs.organization_category.disabled=!0,e.formDefinition.steps[0].sections[1].inputs.association.disabled=!0,e.formDefinition.steps[0].sections[1].inputs.departement.disabled=!0),e},watch:Object.assign(Uf.watch,{state(){"loaded"===this.state&&void 0!==this.$route.query.association_name&&(this.formData.organization_category="association",this.formData.association=this.$route.query.association_name,this.formData.departement=this.$route.query.association_departement)}}),mounted(){this.load()},methods:Object.assign(Uf.methods,{retryLoading(){this.load()},onComplete(e){if(this.isPopup)return window.opener.postMessage(e,"*"),void window.close();this.$router.push("/nouvel-utilisateur/"+e.id)}})},Gf=Hf,Wf=Gf,Yf=(s("3415"),Object(d["a"])(Wf,Bf,Rf,!1,null,"17835908",null)),Jf=Yf.exports,Qf=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),"loading"===e.state?s("section",{staticClass:"section section-white",attrs:{id:"form"}},[e._m(0)]):e._e(),"error"===e.state?s("div",{staticClass:"notification error full-width"},[s("p",[s("font-awesome-icon",{attrs:{icon:"times"}}),e._v(" "),s("strong",[e._v("Une erreur est survenue")])],1),s("p",[s("span",{domProps:{innerHTML:e._s(e.error.replace(/\n/g,"<br/>"))}})]),s("p",[s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])]):e._e(),"loaded"===e.state?s("div",[s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1):e._e()],1)])},Zf=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])])}],Kf={components:{NavBar:cr,Form:Hc},data(){const e={email:""},t={title:"Activation de votre compte utilisateur",descriptionTitle:"",description:"Vous vous apprêtez à activer votre compte utilisateur, veuillez choisir votre mot de passe de connexion.",steps:[{title:"",sections:[{title:"",inputs:{email:{label:"Votre email",mandatory:!1,type:"text",disabled:!0},password:{label:"Définissez votre mot de passe",description:"Votre mot de passe doit comporter au minimum 12 caractères, une majuscule, une minuscule, et un caractère non alphabétique (exemples : '.' ';' ',' '_' '!' '?', ...)<br/>Nous vous recommandons de choisir <strong>une phrase intelligible en guise de mot de passe</strong> : plus simple à retenir qu'une suite de caractères aléatoires, et plus sécurisée.",mandatory:!0,type:"password"}}}],wording:{submit:"Activer mon compte",error:"Votre compte n'a pas pu être activé",success:"Vous pouvez désormais vous connecter à la plateforme"},submitPrefix:'En cliquant sur "Activer mon compte", j\'accepte les <a href="/app.html/#/conditions-d-utilisation">conditions générales d\'utilisation</a> et de partager mes données (nom, prénom, courriel, structure et lorsque renseigné, numéro de téléphone) aux utilisateurs de la plateforme via l’annuaire',submit:e=>Qo(this.user.id,Object.assign(e,{token:this.$route.params.token}))}]};return{state:null,error:null,user:null,formData:e,formDefinition:t}},created(){this.load()},methods:{load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,Yo(this.$route.params.token).then(e=>{this.user=e,this.formData.email=e.email,this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},retryLoading(){this.load()},onComplete(){this.$router.push("/")}}},Xf=Kf,e_=Xf,t_=(s("771a"),Object(d["a"])(e_,Qf,Zf,!1,null,"043c7c3f",null)),s_=t_.exports,i_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container container--userValidation"},["loading"===e.state?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),"error"===e.state?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])]):e._e(),"loaded"===e.state?s("section",{staticClass:"userValidation"},[e.user&&"active"!==e.user.status?s("h1",[e._v("Demande d'accès")]):e.user?s("h1",[e._v("Fiche utilisateur")]):e._e(),s("div",{staticClass:"userValidation-main"},[s("aside",{staticClass:"userInfo"},[s("section",{staticClass:"userInfo-section"},[s("hgroup",[s("h1",[e._v(e._s(e.user.last_name.toUpperCase())+" "+e._s(e.user.first_name))]),s("h3",[e._v("Structure")]),s("h2",[e._v(e._s(e.user.organization.name))])]),s("p",[e._v(e._s(e.user.position)),s("br"),s("span",{staticClass:"email"},[e._v(e._s(e.user.email))])])]),s("section",{staticClass:"userInfo-section"},[e.isExpired?s("p",{staticClass:"userHistory-item"},[s("span",[s("font-awesome-icon",{staticClass:"user-statusIcon",attrs:{icon:"unlink"}}),e._v(" "),s("strong",[e._v("Lien expiré")]),e._v(" le "+e._s(e.formatDate(e.user.activation_link_expires_on,"d M y")))],1),s("br"),e._v("Un lien d'activation est valable "+e._s(e.tokenExpiresIn)+" jours"),s("br")]):e._e(),e.user.last_activation_link_sent_on?s("p",{staticClass:"userHistory-item"},[s("span",[s("font-awesome-icon",{staticClass:"user-statusIcon",attrs:{icon:"paper-plane"}}),e._v(" "),s("strong",[e._v("Accès envoyé")]),e._v(" le "+e._s(e.formatDate(e.user.last_activation_link_sent_on,"d M y")))],1),s("br")]):e._e(),s("p",{staticClass:"userHistory-item"},[s("span",[s("font-awesome-icon",{staticClass:"user-statusIcon user-statusIcon--flag",attrs:{icon:"flag"}}),e._v(" "),s("strong",[e._v("Demandé")]),e._v(" le "+e._s(e.formatDate(e.user.created_at,"d M y")))],1)])]),s("section",{staticClass:"userInfo-section",domProps:{innerHTML:e._s((e.user.access_request_message||"").replace("\n","<br/>"))}})]),s("main",{staticClass:"userPermissions"},[s("hgroup",{staticClass:"userPermissions-header"},[s("h1",[e._v("Accès")]),s("h2",{staticClass:"role"},[e._v(e._s(e.user.role))])]),s("p",[e._v(e._s(e.permission.description)),s("br")]),s("p",[e._v("Ainsi, l'utilisateur peut :")]),e.hasPermissionsFor("national")?s("UserPermissions",{attrs:{title:"À l'échelle nationale",items:e.permission.national_permissions}}):e._e(),e.hasPermissionsFor("local")?s("UserPermissions",{attrs:{title:"Sur le territoire d'intervention",items:e.permission.local_permissions}}):e._e(),e.options.length>0?s("div",[s("h1",{staticClass:"userPermissions-sectionTitle"},[e._v("Options")]),e.user.organization.active?e._e():s("p",[e._v("Pour cette structure, je souhaite :")]),s("ul",{staticClass:"userOptionsList"},e._l(e.options,(function(t,i){return s("li",[s("input",{directives:[{name:"model",rawName:"v-model",value:e.checkedOptions[t.id],expression:"checkedOptions[option.id]"}],attrs:{type:"checkbox",id:"option-"+i,disabled:e.user.organization.active},domProps:{value:t.id,checked:Array.isArray(e.checkedOptions[t.id])?e._i(e.checkedOptions[t.id],t.id)>-1:e.checkedOptions[t.id]},on:{change:function(s){var i=e.checkedOptions[t.id],a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=t.id,r=e._i(i,o);a.checked?r<0&&e.$set(e.checkedOptions,t.id,i.concat([o])):r>-1&&e.$set(e.checkedOptions,t.id,i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.checkedOptions,t.id,n)}}}),s("label",{staticClass:"label-inline",attrs:{for:"option-"+i}},[e._v(e._s(t.label))])])})),0)]):e._e()],1)]),e.validation.error?s("div",{staticClass:"userValidation-error notification error"},[e._v(e._s(e.validation.error))]):e._e(),s("footer",{staticClass:"userValidationFooter"},["active"===e.user.status?s("p",{staticClass:"userValidationFooter-remove"},["loading"!==e.validation.state?s("span",{on:{click:e.remove}},[e._v("Supprimer l'accès")]):e._e()]):e._e(),"new"!==e.user.status||e.user.last_activation_link_sent_on?e._e():s("p",{staticClass:"userValidationFooter-deny"},["loading"!==e.validation.state?s("span",{on:{click:e.deny}},[e._v("Refuser l'accès")]):e._e()]),"new"===e.user.status?s("p",{staticClass:"userValidationFooter-allow"},[s("button",{staticClass:"button",attrs:{disabled:"loading"===e.validation.state,readonly:"loading"===e.validation.state},on:{click:e.validate}},["loading"===e.validation.state?s("img",{attrs:{src:"/img/spinner_light.svg",width:"20"}}):s("span",[e._v("Envoyer un accès")])]),s("br"),e._m(0)]):e._e()])]):e._e()])])],1)])},a_=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("span",[e._v("L'utilisateur va recevoir"),s("br"),e._v("un mail avec un lien d'activation")])}],n_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h1",{staticClass:"userPermissions-sectionTitle"},[e._v(e._s(e.title))]),s("ul",{staticClass:"userPermissionsList"},e._l(e.parsedItems,(function(t){var i;return s("li",{class:(i={"userPermissionsList-item":!0},i["userPermissionsList-item--"+t.type]=!0,i["userPermissionsList-item--subsection"]=!0===t.subsection,i)},[s("span",{domProps:{innerHTML:e._s(t.label.replace(/%(.+?)%/gi,"<em>$1</em>"))}}),t.comments?s("span",{staticClass:"userPermissionsList-comments"},[s("br"),e._v(e._s(t.comments))]):e._e()])})),0)])},o_=[];const r_={view:"eye",edit:"pencil-alt",deny:"times"};var l_={props:{title:{type:String,required:!0},items:{type:Array,required:!0}},computed:{parsedItems(){return this.items.reduce((e,t)=>(t.length>0&&Object.assign(t[0],{subsection:!0}),[...e,...t.map(this.resolveIcon)]),[])}},methods:{resolveIcon(e){return{...e,icon:r_[e.type]}}}},c_=l_,d_=c_,u_=(s("18f7"),Object(d["a"])(d_,n_,o_,!1,null,null,null)),p_=u_.exports;let m_;var h_={components:{NavBar:cr,Table:Tf["a"],UserPermissions:p_},data(){let e;return({permissions_description:m_,activation_token_expires_in:e}=Ao()),{user:null,error:null,state:null,loading:!1,validation:{state:null,error:null},checkedOptions:{},tokenExpiresIn:e/3600/24}},computed:{permission(){return this.user?m_[this.user.role_id]:null},options(){return null!==this.user&&this.permission?this.permission.options:[]},isExpired(){const e=Date.now();return null!==this.user&&"active"!==this.user.status&&null!==this.user.activation_link_expires_on&&e-1e3*this.user.activation_link_expires_on>0}},created(){this.load()},methods:{formatDate(...e){return App.formatDate.call(App,...e)},load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,Ho(this.$route.params.id).then(e=>{this.user=e,this.checkedOptions=this.options.reduce((t,s)=>Object.assign(t,{[s.id]:-1!==e.permission_options.indexOf(s.id)}),{}),this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},retryLoading(){this.load()},hasPermissionsFor(e){return this.permission&&this.permission[e+"_permissions"]&&this.permission[e+"_permissions"].length>0},validate(){"loading"!==this.validation.state&&(this.validation.state="loading",this.validation.error=null,Go(this.$route.params.id,{options:this.checkedOptions}).then(()=>{this.validation.state=null,zc({group:"notifications",type:"success",title:"Accès envoyé",text:"Un accès a été envoyé à l'utilisateur"}),this.$router.push("/liste-des-utilisateurs")}).catch(({user_message:e})=>{this.validation.state=null,this.validation.error=e}))},deny(){"loading"!==this.validation.state&&(this.validation.state="loading",this.validation.error=null,Wo(this.$route.params.id).then(()=>{this.validation.state=null,zc({group:"notifications",type:"success",title:"Accès refusé",text:"L'utilisateur a été supprimé de la base"}),this.$router.push("/liste-des-utilisateurs")}).catch(({user_message:e})=>{this.validation.state=null,this.validation.error=e}))},remove(){"loading"!==this.validation.state&&window.confirm("Êtes-vous sûr de vouloir supprimer cet accès ?")&&(this.validation.state="loading",this.validation.error=null,Xo(this.$route.params.id).then(()=>{this.validation.state=null,zc({group:"notifications",type:"success",title:"Accès supprimé",text:"L'utilisateur a été supprimé de la base"}),this.$router.push("/liste-des-utilisateurs")}).catch(({user_message:e})=>{this.validation.state=null,this.validation.error=e}))}}},v_=h_,f_=v_,__=(s("2207"),Object(d["a"])(f_,i_,a_,!1,null,null,null)),g_=__.exports,b_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("Form",e._b({on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1)])],1)])},y_=[],C_={components:{NavBar:cr,Form:Hc},data(){const{user:{id:e,email:t}}=Ao();return{formData:{email:t},formDefinition:{title:"Résorption Bidonvilles a été mise à jour",description:"La plateforme a été mise à jour en septembre 2019. A présent, il est possible pour les correspondants d'ouvrir des accès à un plus grand nombre d'acteurs.",steps:[{sections:[{title:"Pour compléter le futur annuaire, merci de renseigner les champs suivants",inputs:{email:{type:"text",mandatory:!1,label:"Votre email",disabled:!0},position:{type:"text",mandatory:!0,label:"Votre fonction"},phone:{type:"text",mandatory:!1,label:"Votre numéro de téléphone",specificProps:{maxlength:10}}}},{title:"Pour bénéficier de la mise à jour, merci de créer un nouveau mot de passe",inputs:{password:{type:"password",mandatory:!0,label:"Définissez votre nouveau mot de passe",description:"Votre mot de passe doit comporter au minimum 12 caractères, une majuscule, une minuscule, et un caractère non alphabétique (exemples : '.' ';' ',' '_' '!' '?', ...)<br/>Nous vous recommandons de choisir <strong>une phrase intelligible en guise de mot de passe</strong> : plus simple à retenir qu'une suite de caractères aléatoires, et plus sécurisée."}}}],wording:{submit:"Mettre à jour",error:"Votre compte n'a pas pu être mis à jour",success:"Votre compte a ben été mis à jour"},submit:t=>Ko(e,t)}]}}},methods:{onComplete(){$o().then(()=>{this.$router.push({path:"/"})}).catch(()=>{window.location.reload()})}}},w_=C_,x_=w_,k_=(s("e517"),Object(d["a"])(x_,b_,y_,!1,null,null,null)),P_=k_.exports,S_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white requestNewPassword"},[s("div",{staticClass:"container"},[s("Form",e._b({on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1)])],1)])},$_=[],T_={components:{NavBar:cr,Form:Hc},data(){return{formData:{},formDefinition:{title:"Renouvellement de mot de passe",description:"Si vous avez perdu votre mot de passe, vous pouvez demander à en définir un nouveau.",steps:[{sections:[{inputs:{email:{type:"text",label:"Votre courriel",description:"Saisissez ici le courriel associé au compte Résorption Bidonvilles pour lequel vous souhaitez renouveler le mot de passe",mandatory:!0}}}],wording:{submit:"Renouveller mon mot de passe",success:"Un mail vous a été adressé avec les instructions",error:"La demande de renouvellement a échoué"},submit:({email:e})=>er(e)}]}}},methods:{onComplete(){this.$router.push({path:"/"})}}},A_=T_,E_=A_,O_=(s("0ff0"),Object(d["a"])(E_,S_,$_,!1,null,null,null)),I_=O_.exports,D_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white",attrs:{id:"form"}},[s("div",{staticClass:"container"},["loading"===e.state?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),"error"===e.state?s("div",{staticClass:"notification error full-width"},[s("p",[s("font-awesome-icon",{attrs:{icon:"times"}}),e._v(" "),s("strong",[e._v("Une erreur est survenue")])],1),s("p",[s("span",{domProps:{innerHTML:e._s(e.error.replace(/\n/g,"<br/>"))}})]),s("p",[s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])]):e._e(),"loaded"===e.state?s("div",[s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1):e._e()])])],1)])},j_=[],q_={components:{NavBar:cr,Form:Hc},data(){const e={email:""},t={title:"Définition d'un nouveau mot de passe",description:"Le formulaire suivant vous permet de choisir un nouveau mot de passe",steps:[{title:"",sections:[{title:"",inputs:{email:{label:"Votre email",mandatory:!1,type:"text",disabled:!0},password:{label:"Définissez votre mot de passe",description:"Votre mot de passe doit comporter au minimum 12 caractères, une majuscule, une minuscule, et un caractère non alphabétique (exemples : '.' ';' ',' '_' '!' '?', ...)<br/>Nous vous recommandons de choisir <strong>une phrase intelligible en guise de mot de passe</strong> : plus simple à retenir qu'une suite de caractères aléatoires, et plus sécurisée.",mandatory:!0,type:"password"}}}],wording:{submit:"Changer de mot de passe",error:"Votre mot de passe n'a pas pu être changé",success:"Votre nouveau mot de passe a été changé"},submit:e=>Zo(this.user.id,Object.assign(e,{token:this.$route.params.token}))}]};return{state:null,error:null,user:null,formData:e,formDefinition:t}},created(){this.load()},methods:{load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,Jo(this.$route.params.token).then(e=>{this.user=e,this.formData.email=e.email,this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},retryLoading(){this.load()},onComplete(){this.$router.push("/")}}},L_=q_,F_=L_,M_=(s("f12c"),Object(d["a"])(F_,D_,j_,!1,null,null,null)),N_=M_.exports,z_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",["loaded"!==e.state?s("div",{staticClass:"container"},["loading"===e.state?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),"error"===e.state?s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("span",{on:{click:e.retryLoading}},[e._v("Réessayer ?")])])]):e._e()]):e._e(),"loaded"===e.state?s("div",[s("header",{staticClass:"pageHeader"},[s("div",{staticClass:"pageHeader-wrapper"},[s("section",{staticClass:"pageHeader-main"},[s("section",{staticClass:"pageHeader-info"},[s("h1",{staticClass:"pageHeader-title"},[e._v("Dispositifs - "+e._s(e.locationTitle))])]),s("aside",{staticClass:"pageHeader-buttons"},[e.hasPermission("plan.create")?s("router-link",{staticClass:"button",attrs:{to:"/nouveau-dispositif"}},[s("font-awesome-icon",{attrs:{icon:"pencil-alt"}}),s("span",[e._v("Déclarer un dispositif")])],1):e._e()],1)])])]),s("div",{staticClass:"container plansList-body"},[s("CollectivityInput",{staticClass:"planList-search",model:{value:e.location,callback:function(t){e.location=t},expression:"location"}}),s("Table",{attrs:{columns:e.columns,content:e.pageContent,emptyLabel:"Aucun dispositif sur ce territoire"},on:{click:e.routeToPlan},scopedSlots:e._u([{key:"name",fn:function(t){return[s("strong",[e._v(e._s(t.row.name))]),s("br"),t.row.expected_to_end_at?s("span",[e._v("du "+e._s(e.formatDate(t.row.started_at/1e3))),s("br"),e._v("au "+e._s(e.formatDate(t.row.expected_to_end_at/1e3))),s("br"),e._v(e._s(e.dateDiff(t.row.started_at,t.row.expected_to_end_at)))]):s("span",[e._v("depuis le "+e._s(e.formatDate(t.row.started_at/1e3)))]),s("br"),e._l(t.row.topics,(function(t){return s("p",[s("span",{staticClass:"rbTag"},[e._v(e._s(t.name))])])}))]}},{key:"departement",fn:function(t){return[e._v(e._s(t.row.departement.code))]}},{key:"location",fn:function(t){return["shantytowns"===t.row.location_type.id?s("span",e._l(t.row.shantytowns,(function(t){return s("span",[e._v("- "+e._s(t.usename)),s("br")])})),0):e._e(),"location"===t.row.location_type.id?s("span",[e._v(e._s(t.row.location.label))]):e._e(),"housing"===t.row.location_type.id?s("span",[e._v("Dans le logement")]):e._e(),"other"===t.row.location_type.id?s("span",[e._v(e._s(t.row.location_details))]):e._e()]}},{key:"government",fn:function(t){return[s("router-link",{staticClass:"user",attrs:{to:"/annuaire/"+t.row.government_contacts[0].organization.id}},[e._v(e._s(t.row.government_contacts[0].name)),s("br"),e._v(e._s(t.row.government_contacts[0].organization.name))])]}},{key:"operator",fn:function(t){return[s("router-link",{staticClass:"user",attrs:{to:"/annuaire/"+t.row.operator_contacts[0].organization.id}},[e._v(e._s(t.row.operator_contacts[0].name)),s("br"),e._v(e._s(t.row.operator_contacts[0].organization.name))])]}}],null,!1,1173401747)})],1)]):e._e()])],1)])},B_=[];function R_(){return bo("/plans")}async function V_(e){return bo("/plans/"+e)}async function U_(e){return yo("/plans",e)}async function H_(e,t){return yo("/plans/"+e,t)}async function G_(e,t){return yo(`/plans/${e}/states`,t)}async function W_(e,t){return wo("/plans/"+e,{operation:"close",data:t})}var Y_={components:{NavBar:cr,Table:Sl,CollectivityInput:Dl},data(){const{user:e}=Ao(),t=Oo("plan.list"),s="nation"===t.geographic_level,i={locationTitle:null,defaultLocation:null,location:null};let a=e.organization.location.type;"epci"!==a&&"city"!==a||(a="departement");const n={id:"nation"===a?null:e.organization.location[a].code,label:"nation"===a?"France":e.organization.location[a].name,category:a,data:{code:"nation"===a?null:e.organization.location[a].code,type:a}};return!0!==s||"nation"===a?(i.defaultLocation={...n},i.location=null):(i.defaultLocation={id:null,label:"France",category:"Pays",data:{code:null,type:"nation"}},i.location={...n}),"nation"===i.defaultLocation.data.type?i.locationTitle="National":i.locationTitle=i.defaultLocation.label,Object.assign(i,{plans:[],error:null,state:null})},computed:{currentLocation(){return this.location||this.defaultLocation},columns(){return[{id:"name",label:"Nom du dispositif"},{id:"departement",label:"Dpt"},{id:"location",label:"Lieu"},{id:"government",label:"Service de l'état"},{id:"operator",label:"Opérateur"}]},pageContent(){return this.plans.filter(({closed_at:e})=>null===e).filter(e=>{if("nation"===this.currentLocation.data.type)return!0;const t=e[this.currentLocation.data.type];return t&&t.code===""+this.currentLocation.data.code})}},created(){this.load()},methods:{dateDiff(...e){return App.dateDiff(...e)},formatDate(...e){return window.App.formatDate(...e)},load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,R_().then(e=>{this.plans=e,this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},retryLoading(){this.load()},routeToPlan({id:e}){const t=this.$router.resolve("/dispositif/"+e);mo(t.href)},hasPermission(...e){return Io(...e)}}},J_=Y_,Q_=J_,Z_=(s("1a64"),Object(d["a"])(Q_,z_,B_,!1,null,"ca8ce470",null)),K_=Z_.exports,X_=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("NavBar"),"loading"===e.loading.status?s("section",{staticClass:"section section-white"},[e._m(0)]):e._e(),"failed"===e.loading.status?s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.loading.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.load}},[e._v("Réessayer ?")])])])])]):e._e(),"completed"===e.loading.status?s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1)):e._e()],1)},eg=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])])}];function tg(e){return bo(`/regions/${e}/departements`)}function sg(e){return bo(`/epci/${e}/departements`)}var ig={components:{NavBar:cr,Form:Hc},data(){const{user:e,topics:t}=Ao(),s={user:e,formData:{association:[]},loading:{status:null,error:null}},i=this,a=this.$refs,n={type:"hidden",label:"Personne référente dans la structure",description:"Aucune personne de cette structure n'est encore enregistrée sur la plateforme résorption bidonville.",mandatory:!0,condition({association:e}){return void 0!==e&&e.length>0&&0===a.form.getInputById("contact").options.length&&!1===i.loadingAssociationContacts}};return s.formDefinition={title:"Déclarer un dispositif",descriptionTitle:"Qu'est-ce qu'un dispositif ?",description:"C’est une action mise en place et financée en partie ou en totalité par un acteur public. Sa finalité est la résorption des bidonvilles.<br/><strong>Qui doit le déclarer ?</strong> Le service de l'Etat à l'initiative du dispositif doit le déclarer. L'acteur de terrain sera en charge de renseigner les informations relatives à l'action menée.",steps:[{title:"Dispositf",wording:{error:"La déclaration du dispositif a échoué",submit:"Déclarer le dispositif"},sections:[{title:"Intervention",icon:"list",inputs:{name:{type:"text",label:"Nom du dispositif",mandatory:!0},departement:{type:"select",label:"Département d'intervention",mandatory:!0},startedAt:{type:"date",label:"Date de début",mandatory:!0},expectedToEndAt:{type:"date",label:"Date de fin prévue (facultatif)",mandatory:!1},in_and_out:{type:"radio",label:"Ce dispositif implique-t-il un système d'entrées et de sorties des personnes ?",mandatory:!0,options:[{value:1,label:"Oui"},{value:0,label:"Non"}]},topics:{type:"checkbox",label:"Champs d'intervention",description:"Les thématiques sélectionnées définissent l'action que vous menez et les indicateurs de suivi associés.",mandatory:!0,options:t.map(({uid:e,name:t})=>({value:e,label:t}))},goals:{type:"textarea",label:"Objectifs",mandatory:!0,specificProps:{placeholder:"Précisez les objectifs, les enjeux, le contexte du dispositif\n\nPar exemple : résorber le bidonville, scolariser 80% des enfants identités en bidonvilles..."}}}},{title:"Lieu",icon:"map-pin",inputs:{locationType:{type:"radio",label:"L'action se déroule dans le cadre suivant",mandatory:!0,options:[{value:"shantytowns",label:"sur site(s) : bidonville ou squat"},{value:"location",label:"sur terrain d'insertion"},{value:"housing",label:"dans le logement"},{value:"other",label:"dans plusieurs lieux (hébergement, permanence, rue...)"}]},locationShantytowns:{type:"townList",label:"Sites concernés",description:`Merci de sélectionner les sites concernés par le dispositif.<br/>Si vous ne trouvez pas un site, vous pouvez <a href="${this.$router.resolve("/nouveau-site").href}" clas="link">déclarer un nouveau site</a>.`,mandatory:!0,condition({locationType:e}){return"shantytowns"===e}},locationAddress:{type:"addressWithLocation",label:"Adresse du terrain d'insertion",mandatory:!0,condition({locationType:e}){return"location"===e}},locationDetails:{type:"text",label:"Préciser",mandatory:!0,condition({locationType:e}){return"other"===e}}}},{title:"Contacts",inputs:{government:{type:"autocompleter",label:"Personne au service de l'état en charge du pilotage",mandatory:!0,specificProps:{autocompleter:e=>{const t=rd("public_establishment"),s=t.then(({users:t})=>t.filter(({first_name:t,last_name:s})=>[t,s].some(t=>e.split(" ").every(e=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))).map(({id:e,first_name:t,last_name:s})=>({id:e,label:`${t} ${s.toUpperCase()}`})));return s.abort=t.abort,s},showCategory:!1,allowMultiple:!1,float:!0}},association:{type:"autocompleter",label:"Opérateur ou service en charge de l'intervention",mandatory:!0,specificProps:{autocompleter:e=>{const t=ad("association"),s=t.then(({organizations:t})=>t.filter(({name:t,abbreviation:s})=>e.split(" ").every(e=>-1!==t.toLowerCase().indexOf(e.toLowerCase()))||null!==s&&s.toLowerCase().indexOf(e.toLowerCase())>=0).map(e=>({id:e.id,label:e.name,category:`${e.departement_code} - ${e.departement_name}`,data:{name:e.name,departement:e.departement_code}})));return s.abort=t.abort,s},showCategory:!0,allowMultiple:!1,float:!0}},contact:{type:"select",label:"Personne référente dans la structure",mandatory:!0,options:[],condition({association:e}){return void 0!==e&&e.length>0&&this.options.length>0}},contact_missing:n}},{title:"Financements",inputs:{finances:{type:"planFunding",label:"Financements",mandatory:!1}}}],submit:U_}]},Io("user.create")&&(window.createUser=this.createUser,n.description+='<br/><a class="link" onclick="createUser()">Vous pouvez créer un compte utilisateur en cliquant ici.</span>'),"public_establishment"===e.organization.category.uid&&(s.formData.government=[{id:e.id,label:`${e.first_name} ${e.last_name.toUpperCase()}`}]),s},watch:{"formData.association":function(){this.loadingAssociationContacts=!0,this.$refs.form.getInputById("contact").options=[],0!==this.formData.association.length&&od(this.formData.association[0].id).then(({users:e})=>{this.$refs.form.getInputById("contact").options=e.map(({id:e,first_name:t,last_name:s})=>({value:e,label:`${t} ${s.toUpperCase()}`})),this.loadingAssociationContacts=!1})}},mounted(){this.load(),window.addEventListener("message",({data:e})=>{this.$refs.form.getInputById("contact").options=[{value:e.id,label:`${e.first_name} ${e.last_name.toUpperCase()}`}],this.formData.contact=e.id,this.loadingAssociationContacts=!1,zc({group:"notifications",type:"success",title:"Utilisateur créé",text:"La personne référente est désormais sélectionnée"})},!1)},methods:{getDepartementsForCurrentUser(){const e={city:1,epci:2,departement:3,region:4,nation:5},t=this.user.permissions.plan.create.geographic_level,s=this.user.organization.location.type;let i;switch(i="local"===t||e[s]>e[t]?s:t,i){case"nation":{const{departements:e}=Ao();return Promise.resolve(e)}case"region":return tg(this.user.organization.location.region.code).then(({departements:e})=>e);default:return Promise.resolve([this.user.organization.location.departement])}},load(){"loading"!==this.loading.status&&"completed"!==this.loading.status&&(this.loading.status="loading",this.loading.error=null,this.getDepartementsForCurrentUser().then(e=>{this.loading.status="completed",this.$nextTick(()=>{const t=this.$refs.form.getInputById("departement");t.options=e.map(({code:e,name:t})=>({label:`${e} - ${t}`,value:e}))})}).catch(e=>{this.loading.status="failed",this.loading.error=e}))},createUser(){const{name:e,departement:t}=this.formData.association[0].data,{href:s}=this.$router.resolve("/nouvel-utilisateur");window.open(`${s}?association_name=${encodeURIComponent(e)}&association_departement=${t}`,"newUser","menubar=no, status=no")},onComplete(e,[{id:t}]){zc({group:"notifications",type:"success",title:"Dispositif correctement déclaré",text:"Le dispositif a bien été ajouté en base de données"}),this.$router.push("/dispositif/"+t)}}},ag=ig,ng=ag,og=(s("83c6"),Object(d["a"])(ng,X_,eg,!1,null,null,null)),rg=og.exports,lg=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),"hidden"!==e.closingAlertStatus?s("div",{staticClass:"alert"},[s("div",{ref:"wrapper",staticClass:"alert-wrapper"},[s("header",{staticClass:"alert-header"},[s("hgroup",[s("h1",{staticClass:"alert-title"},[e._v("Confirmez-vous la fermeture du dispositif "+e._s(e.plan.name)+" ?")])]),s("div",{staticClass:"alert-actionButtons"},[s("button",{staticClass:"button secondary",attrs:{disabled:"pending"===e.closingStatus},on:{click:function(t){return e.setClosingAlertStatus("hidden")}}},[e._v("Annuler")]),"step1"===e.closingAlertStatus?s("button",{staticClass:"button",on:{click:e.checkClosing}},[e._v("Suite")]):e._e(),"step2"===e.closingAlertStatus?s("button",{staticClass:"button",attrs:{disabled:"pending"===e.closingStatus},on:{click:e.close}},[e._v("Valider")]):e._e()])]),s("section",{staticClass:"alert-body"},["step1"===e.closingAlertStatus?s("div",[s("p",[e._v("Avant de fermer définitivement le dispositif, assurez-vous que les indicateurs de suivi renseignés par l'opérateur sont à jour."),null!==e.plan.last_update?s("span",[e._v(" Pour information, la dernière mise à jour des indicateurs a eu lieu le "+e._s(e.formatDate(e.plan.last_update/1e3,"d/m/y"))+".")]):e._e(),s("br"),e._v("Merci de renseigner les dépenses exécutées de l'année en cours et des années précédentes si nécessaire")]),s("PlanFunding",{attrs:{inputMode:"closing",minYear:e.minYear},model:{value:e.closingData.finances,callback:function(t){e.$set(e.closingData,"finances",t)},expression:"closingData.finances"}})],1):s("div",[s("p",[s("Input",{attrs:{id:"closedAt",mandatory:!0,type:"date",label:"Date de fermeture du dispositif",description:"La date de fermeture du dispositif doit être postérieure - ou égale - à la dernière date de mise à jour des indicateurs.",disabled:"pending"===e.closingStatus},model:{value:e.closingData.closedAt,callback:function(t){e.$set(e.closingData,"closedAt",t)},expression:"closingData.closedAt"}})],1),s("p",[s("Input",{attrs:{id:"comment",mandatory:!0,type:"textarea",label:"Commentaire",description:e.closingCommentDescription,disabled:"pending"===e.closingStatus},model:{value:e.closingData.comment,callback:function(t){e.$set(e.closingData,"comment",t)},expression:"closingData.comment"}})],1)]),e.closingErrors.length>0?s("div",{staticClass:"notification error"},[e._v("Une erreur est survenue")]):e._e(),e.closingErrors.length>0?s("p",{staticClass:"error"},[s("ul",e._l(e.closingErrors,(function(t){return s("li",[e._v(e._s(t))])})),0)]):e._e()])])]):e._e(),s("section",{staticClass:"section-white"},["loaded"!==e.status?s("div",{staticClass:"container"},[e.status&&"loading"!==e.status?"loadingError"===e.status?s("div",[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("span",{on:{click:e.load}},[e._v("Réessayer ?")])])])]):e._e():s("div",[e._m(0)])]):e._e(),"loaded"===e.status?s("div",[s("header",{staticClass:"pageHeader"},[s("div",{staticClass:"pageHeader-wrapper"},[s("section",{staticClass:"pageHeader-main"},[s("section",{staticClass:"pageHeader-info"},[s("h1",{staticClass:"pageHeader-title"},[e._v(e._s(e.plan.name))])]),s("aside",{staticClass:"pageHeader-buttons"},[e.plan&&e.plan.canUpdate?s("router-link",{staticClass:"button",attrs:{to:"/modifier-dispositif/"+e.plan.id}},[s("font-awesome-icon",{attrs:{icon:"pencil-alt"}}),s("span",[e._v("Mettre à jour")])],1):e._e(),e.plan&&e.plan.canUpdateMarks?s("router-link",{staticClass:"button",attrs:{to:"/dispositif/"+e.plan.id+"/indicateurs"}},[s("font-awesome-icon",{attrs:{icon:"pencil-alt"}}),s("span",[e._v("Indicateurs")])],1):e._e(),e.plan&&null===e.plan.closed_at&&e.plan.canClose?s("a",{staticClass:"button",on:{click:function(t){return e.setClosingAlertStatus("step1")}}},[s("span",[e._v("Fermer le dispositif")])]):e._e()],1)])])]),s("section",{staticClass:"container"},[s("SlideNote",{attrs:{title:"Qu'est-ce qu'un dispositif ?"}},[s("template",{slot:"content"},[s("p",[e._v("C’est une action mise en place et financée en partie ou en totalité par un acteur public. Sa finalité est la résorption des bidonvilles."),s("br"),s("strong",[e._v("Qui doit le déclarer ?")]),e._v(" Le service de l'Etat à l'initiative du dispositif doit le déclarer. L'acteur de terrain sera en charge de renseigner les informations relatives à l'action menée.")]),s("p",[s("strong",[e._v("À quoi sert le suivi ?")]),s("br"),e._v("La mise à jour des données de suivi permettent d’observer la progression des démarches des habitants par rapport à une situation initiale et les résultats des actions."),s("br"),e._v("Toutes ces données peuvent êtres utilisées pour la communication auprès des partenaires.")])])],2),s("section",{staticClass:"dataSection"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"list"}})],1),e._v(" Intervention ")])]),s("article",{staticClass:"block"},[s("div",{staticClass:"dataSection-line"},[s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Date de début")]),s("br"),e._v(e._s(e.formatDate(e.plan.started_at/1e3,"d M y")))]),e.plan.expected_to_end_at?s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Date de fin prévue")]),s("br"),e._v(e._s(e.formatDate(e.plan.expected_to_end_at/1e3,"d M y"))),s("br"),s("strong",[e._v("Durée prévue : "+e._s(e.dateDiff(e.plan.started_at,e.plan.expected_to_end_at)))])]):e._e(),e.plan.closed_at?s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Date de fin")]),s("br"),e._v(e._s(e.formatDate(e.plan.closed_at/1e3,"d M y"))),s("br"),s("strong",[e._v("Durée : "+e._s(e.dateDiff(e.plan.started_at,e.plan.closed_at)))])]):e._e()]),s("p",{staticClass:"data-label"},[e._v("Champs d'intervention")]),e._l(e.plan.topics,(function(t){return s("p",[s("span",{staticClass:"rbTag rbTag--warning"},[e._v(e._s(t.name))]),s("br")])})),s("div",{staticClass:"dataSection-line"},[s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Objectifs")]),s("br"),s("span",{domProps:{innerHTML:e._s(e.escapeHtml(e.plan.goals).replace(/\n/g,"<br/>"))}})])]),e.plan.final_comment?s("div",{staticClass:"dataSection-line"},[s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Commentaire")]),s("br"),s("span",{domProps:{innerHTML:e._s(e.escapeHtml(e.plan.final_comment).replace(/\n/g,"<br/>"))}})])]):e._e()],2)]),s("section",{staticClass:"dataSection"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"map-pin"}})],1),e._v(" Lieu ")])]),s("article",{staticClass:"block"},[s("div",{staticClass:"dataSection-line"},[s("p",[s("span",{staticClass:"data-label"},[e._v(e._s(e.plan.location_type.label))]),s("br"),"shantytowns"===e.plan.location_type.id?s("span",e._l(e.plan.shantytowns,(function(t){return s("p",[s("router-link",{staticClass:"locationPoint",attrs:{to:"/site/"+t.id}},[e._v(e._s(t.usename))])],1)})),0):e._e(),"location"===e.plan.location_type.id?s("span",{staticClass:"locationPoint"},[e._v(e._s(e.plan.location.label))]):e._e(),"other"===e.plan.location_type.id?s("span",[e._v(e._s(e.plan.location_details))]):e._e()])]),"location"===e.plan.location_type.id?s("Map",{attrs:{"display-searchbar":!1,towns:[e.address],"default-view":e.center}}):e._e()],1)]),s("section",{staticClass:"dataSection"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"address-book"}})],1),e._v(" Contacts ")])]),s("article",{staticClass:"block"},[s("div",{staticClass:"dataSection-line"},[s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Service de l'état")]),s("br"),s("router-link",{staticClass:"user",attrs:{to:"/annuaire/"+e.plan.government_contacts[0].organization.id}},[e._v(e._s(e.plan.government_contacts[0].first_name)+" "+e._s(e.plan.government_contacts[0].last_name.toUpperCase())),s("br"),e._v(e._s(e.plan.government_contacts[0].organization.name))])],1)]),s("div",{staticClass:"dataSection-line"},[s("p",{staticClass:"data"},[s("span",{staticClass:"data-label"},[e._v("Opérateur ou service en charge")]),s("br"),s("router-link",{staticClass:"user",attrs:{to:"/annuaire/"+e.plan.operator_contacts[0].organization.id}},[e._v(e._s(e.plan.operator_contacts[0].first_name)+" "+e._s(e.plan.operator_contacts[0].last_name.toUpperCase())),s("br"),e._v(e._s(e.plan.operator_contacts[0].organization.name))])],1)])])]),e.plan&&e.plan.finances&&e.plan.finances.length>0?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"euro-sign"}})],1),e._v(" Financements ")])]),s("header",{staticClass:"planFunding-header"},[s("font-awesome-icon",{staticClass:"planFunding-yearSwitch",class:{"planFunding-yearSwitch--disabled":!0===e.reachedMinFinanceIndex},attrs:{icon:"caret-square-left"},on:{click:e.showPreviousYear}}),s("span",[e._v(e._s(e.plan.finances[e.currentFinanceIndex].year)+" ")]),s("font-awesome-icon",{staticClass:"planFunding-yearSwitch",class:{"planFunding-yearSwitch--disabled":!0===e.reachedMaxFinanceIndex},attrs:{icon:"caret-square-right"},on:{click:e.showNextYear}})],1),s("table",{staticClass:"table block"},[e._m(1),s("tbody",[e._l(e.plan.finances[e.currentFinanceIndex].data,(function(t){return s("tr",[s("td",[e._v(e._s(t.type.name))]),s("td",[e._v(e._s(t.amount)+" €"),s("br"),e._v("soit "+e._s(Math.round(t.amount/e.financeTotal()*100))+"%")]),s("td",[e._v(e._s(t.details))]),t.realAmount?s("td",[e._v(e._s(t.realAmount)+" €")]):e.reachedMaxFinanceIndex?s("td",[e._v("À remplir entre janvier et mars")]):s("td",[e._v("Non renseignées")])])})),s("tr",[s("td"),s("td",{attrs:{colspan:"3"}},[s("strong",[e._v("TOTAL : "+e._s(e.financeTotal())+"€")])])])],2)])]):e._e(),e.plan.states.length>0?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"users"}})],1),e._v(" Équipe ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th"),e._l(e.plan.states,(function(t){return s("th",[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",e._l(e.availableEtpTypes,(function(t){return s("tr",[s("th",[e._v(e._s(t.name))]),e._l(e.plan.states,(function(i){return s("td",[e._v(e._s((i.etp.find((function(e){var s=e.type.uid;return s===t.uid}))||{total:0}).total))])}))],2)})),0)])]):e._e(),e.audience?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"arrow-right"}})],1),e._v(" Public ")])]),s("table",{staticClass:"table block"},[e._m(2),s("tbody",[s("tr",[e._m(3),s("td",[e._v(e._s(e.audience.in.families))]),s("td",[e._v(e._s(e.audience.in.total))]),s("td",[e._v(e._s(e.audience.in.women))]),s("td",[e._v(e._s(e.audience.in.minors))])]),s("tr",[e._m(4),s("td",[e._v(e._s(e.audience.out_positive.families))]),s("td",[e._v(e._s(e.audience.out_positive.total))]),s("td",[e._v(e._s(e.audience.out_positive.women))]),s("td",[e._v(e._s(e.audience.out_positive.minors))])]),s("tr",[e._m(5),s("td",[e._v(e._s(e.audience.out_excluded.families))]),s("td",[e._v(e._s(e.audience.out_excluded.total))]),s("td",[e._v(e._s(e.audience.out_excluded.women))]),s("td",[e._v(e._s(e.audience.out_excluded.minors))])]),s("tr",[e._m(6),s("td",[e._v(e._s(e.audience.out_abandoned.families))]),s("td",[e._v(e._s(e.audience.out_abandoned.total))]),s("td",[e._v(e._s(e.audience.out_abandoned.women))]),s("td",[e._v(e._s(e.audience.out_abandoned.minors))])])])])]):e._e(),e.plan.states.length>0?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"id-card"}})],1),e._v(" Droit commun et ressources ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th",{staticClass:"table-col"},[e._v("Nombre de personnes ayant")]),e._l(e.plan.states,(function(t){return s("th",{staticClass:"table-col"},[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",[s("tr",[s("td",[e._v("une domiciliation")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.droit_commun.domiciliation?"NC":t.droit_commun.domiciliation))])}))],2),s("tr",[s("td",[e._v("des droits CAF ouverts")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.droit_commun.droits_caf?"NC":t.droit_commun.droits_caf))])}))],2),s("tr",[s("td",[e._v("un emploi stable / ressources suffisantes")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.droit_commun.emploi_stable?"NC":t.droit_commun.emploi_stable))])}))],2)])])]):e._e(),e.plan.states.length>0&&e.plan.topics.find((function(e){var t=e.uid;return"health"===t}))?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"user-md"}})],1),e._v(" Santé ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th",{staticClass:"table-col"}),e._l(e.plan.states,(function(t){return s("th",{staticClass:"table-col"},[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",[s("tr",[s("th",{attrs:{colspan:e.plan.states.length+1}},[s("strong",[e._v("Nombre de personnes avec...")])])]),s("tr",[s("td",[e._v("une couverture AME valide")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.sante.ame_valide?"NC":t.sante.ame_valide))])}))],2),s("tr",[s("td",[e._v("une couverture PUMA valide")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.sante.puma_valide?"NC":t.sante.puma_valide))])}))],2),s("tr",[s("td",[e._v("une demande AME en cours")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.sante.ame_en_cours?"NC":t.sante.ame_en_cours))])}))],2),s("tr",[s("td",[e._v("une demande PUMA en cours")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.sante.puma_en_cours?"NC":t.sante.puma_en_cours))])}))],2),s("tr",[s("th",{attrs:{colspan:e.plan.states.length+1}},[s("strong",[e._v("Nombre de personnes ayant fait l'objet d'au moins...")])])]),s("tr",[s("td",[e._v("une orientation vers une structure de santé")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.sante.orientation?"NC":t.sante.orientation))])}))],2),s("tr",[s("td",[e._v("un accompagnement physique vers une structure de santé")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.sante.accompagnement?"NC":t.sante.accompagnement))])}))],2)])])]):e._e(),e.plan.states.length>0&&e.plan.topics.find((function(e){var t=e.uid;return"school"===t}))?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"user-md"}})],1),e._v(" Éducation et scolarisation ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th",{staticClass:"table-col"}),e._l(e.plan.states,(function(t){return s("th",{staticClass:"table-col"},[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",[s("tr",[s("td",[e._v("Mineurs en âge d'être scolarisés")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.education.scolarisables?"NC":t.education.scolarisables))])}))],2),s("tr",[s("td",[e._v("Maternelle")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.education.maternelles?"NC":t.education.maternelles))])}))],2),s("tr",[s("td",[e._v("Primaire")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.education.elementaires?"NC":t.education.elementaires))])}))],2),s("tr",[s("td",[e._v("Collège")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.education.colleges?"NC":t.education.colleges))])}))],2),s("tr",[s("td",[e._v("Lycée - formation professionnelle")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.education.lycees?"NC":t.education.lycees))])}))],2)])])]):e._e(),e.plan.states.length>0&&e.plan.topics.find((function(e){var t=e.uid;return"work"===t}))?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"briefcase"}})],1),e._v(" Formation et emploi ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th",{staticClass:"table-col"}),e._l(e.plan.states,(function(t){return s("th",{staticClass:"table-col"},[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",[s("tr",[s("th",{attrs:{colspan:e.plan.states.length+1}},[s("strong",[e._v("Nombre de personnes inscrites ou suivies par...")])])]),s("tr",[s("td",[e._v("Pôle emploi")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.pole_emploi?"NC":t.formation.pole_emploi))])}))],2),s("tr",[e._m(7),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.pole_emploi_femmes?"NC":t.formation.pole_emploi_femmes))])}))],2),s("tr",[s("td",[e._v("Mission locale")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.mission_locale?"NC":t.formation.mission_locale))])}))],2),s("tr",[e._m(8),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.mission_locale_femmes?"NC":t.formation.mission_locale_femmes))])}))],2),s("tr",[s("th",{attrs:{colspan:e.plan.states.length+1}},[s("strong",[e._v("Nombre de personnes ayant")])])]),s("tr",[s("td",[e._v("Un contrat")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.contrats?"NC":t.formation.contrats))])}))],2),s("tr",[e._m(9),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.contrats_femmes?"NC":t.formation.contrats_femmes))])}))],2),s("tr",[s("td",[e._v("Une formation")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.formations?"NC":t.formation.formations))])}))],2),s("tr",[e._m(10),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.formations_femmes?"NC":t.formation.formations_femmes))])}))],2),s("tr",[s("td",[e._v("Un statut autoentrepreneur")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.autoentrepreneurs?"NC":t.formation.autoentrepreneurs))])}))],2),s("tr",[e._m(11),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.autoentrepreneurs_femmes?"NC":t.formation.autoentrepreneurs_femmes))])}))],2),s("tr",[s("td",[e._v("l'ARE")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.are?"NC":t.formation.are))])}))],2),s("tr",[e._m(12),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.formation.are_femmes?"NC":t.formation.are_femmes))])}))],2)])])]):e._e(),e.plan.states.length>0&&e.plan.topics.find((function(e){var t=e.uid;return"housing"===t}))?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"home"}})],1),e._v(" Logement ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th",{staticClass:"table-col"}),e._l(e.plan.states,(function(t){return s("th",{staticClass:"table-col"},[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",[e._l(e.housingFields,(function(t){return[s("tr",[s("th",{attrs:{colspan:e.plan.states.length+1}},[s("strong",[e._v(e._s(t.label))])])]),s("tr",[s("td",[e._v("Nombre de personnes")]),e._l(e.plan.states,(function(i){return s("td",[e._v(e._s(null===i.logement[t.name].people?"NC":i.logement[t.name].people))])}))],2),s("tr",[s("td",[e._v("Nombre de ménages")]),e._l(e.plan.states,(function(i){return s("td",[e._v(e._s(null===i.logement[t.name].families?"NC":i.logement[t.name].families))])}))],2)]}))],2)])]):e._e(),e.plan.states.length>0&&e.plan.topics.find((function(e){var t=e.uid;return"safety"===t}))?s("section",{staticClass:"dataSection rb-table"},[s("header",{staticClass:"dataSection-header"},[s("h1",{staticClass:"dataSection-title"},[s("span",{staticClass:"dataSection-icon"},[s("font-awesome-icon",{attrs:{icon:"seedling"}})],1),e._v(" Stabilisation et sécurisation du site ")])]),s("table",{staticClass:"table block"},[s("thead",[s("tr",[s("th",{staticClass:"table-col"}),e._l(e.plan.states,(function(t){return s("th",{staticClass:"table-col"},[e._v(e._s(e.formatDate(new Date(t.date).getTime()/1e3,"d M")))])}))],2)]),s("tbody",[s("tr",[s("td",[e._v("Nombre d'accès réguliers à l'eau potable")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.securisation.points_eau?"NC":t.securisation.points_eau))])}))],2),s("tr",[s("td",[e._v("Nombre de sanitaires")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.securisation.wc?"NC":t.securisation.wc))])}))],2),s("tr",[s("td",[e._v("Nombre d'accès réguliers à l'électricité")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.securisation.electricite?"NC":t.securisation.electricite))])}))],2),s("tr",[s("td",[e._v("Nombre de bennes disponibles pour le ramassage des déchets du site")]),e._l(e.plan.states,(function(t){return s("td",[e._v(e._s(null===t.securisation.nombre_bennes?"NC":t.securisation.nombre_bennes))])}))],2)])])]):e._e(),0===e.plan.states.length&&e.plan.canUpdateMarks?s("div",{staticClass:"note"},[s("div",{staticClass:"note-body"},[s("p",[s("strong",[e._v("Aucun indicateur de suivi renseigné par l'opérateur")]),s("br"),s("router-link",{staticClass:"button",attrs:{to:"/dispositif/"+e.plan.id+"/indicateurs"}},[s("font-awesome-icon",{attrs:{icon:"pencil-alt"}}),s("span",[e._v("Modifier")])],1)],1)])]):e._e()],1)]):e._e()])],1)])},cg=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"table-col"},[e._v("Type de financements")]),s("th",{staticClass:"table-col"},[e._v("Montants"),s("br"),e._v("prévus")]),s("th",{staticClass:"table-col"},[e._v("Précision")]),s("th",{staticClass:"table-col"},[e._v("Dépenses"),s("br"),e._v("exécutées")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("thead",[s("tr",[s("th",{staticClass:"table-col"}),s("th",{staticClass:"table-col"},[e._v("Ménages")]),s("th",{staticClass:"table-col"},[e._v("Personnes")]),s("th",{staticClass:"table-col"},[e._v("dont femmes")]),s("th",{staticClass:"table-col"},[e._v("dont mineurs")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Entrées")]),e._v(" dans le dispositif")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Sorties positivement")]),s("br"),e._v("fin accompagnement social et/ou"),s("br"),e._v("prise en charge dans un autre dispositif")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Exclusion")]),e._v(" du dispositif")])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("strong",[e._v("Abandon / départ volontaire")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("em",[e._v("(dont femmes)")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("em",[e._v("(dont femmes)")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("em",[e._v("(dont femmes)")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("em",[e._v("(dont femmes)")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("em",[e._v("(dont femmes)")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("td",[s("em",[e._v("(dont femmes)")])])}],dg={components:{NavBar:cr,SlideNote:Mc,Map:Cu,PlanFunding:Kl,Input:Oc},data(){const{etp_types:e}=Ao();return{status:null,error:null,plan:null,etpTypes:e,currentFinanceIndex:0,closingAlertStatus:"hidden",closingErrors:[],closingStatus:null,closingData:{closedAt:new Date,finances:[],comment:""},housingFields:[{name:"siao",label:"Demandes SIAO"},{name:"logement_social",label:"Demandes de logement social"},{name:"dalo",label:"Demandes DALO"},{name:"accompagnes",label:"Accès à un logement accompagné / adapté"},{name:"non_accompagnes",label:"Accès à un logement sans accompagnement"},{name:"heberges",label:"Hébergements"}]}},created(){this.load()},computed:{closingCommentDescription(){if(!this.audience)return"";const e={...this.audience.in};return["out_positive","out_abandoned","out_excluded"].forEach(t=>{e.total-=this.audience[t].total,e.families-=this.audience[t].families,e.women-=this.audience[t].women,e.minors-=this.audience[t].minors}),0===e.total&&0===e.families&&0===e.women&&0===e.minors?"Précisez les raisons de la fermeture du dispositif":`À la fermeture du dispositif, ${e.families} ménage${e.families>1?"s":""} (soit ${e.total} personne${e.total>1?"s":""}) sont identifiés dans le dispositif. Merci de préciser les solutions mobilisées pour ces personnes et les raisons de la fermeture du dispositif.<br /><br />Merci de respecter les règles de confidentialité.Ne pas citer l'identité des individus (Nom, âge, sexe, origine...)`},reachedMaxFinanceIndex(){return!this.plan||!this.plan.finances||0===this.plan.finances.length||0===this.currentFinanceIndex},reachedMinFinanceIndex(){return!this.plan||!this.plan.finances||0===this.plan.finances.length||this.currentFinanceIndex>=this.plan.finances.length-1},minYear(){return this.plan&&this.plan.finances&&0!==this.plan.finances.length?this.plan.finances.reduce((e,{year:t})=>null!==e?Math.min(e,t):t,null):null},availableEtpTypes(){return this.etpTypes.filter(({uid:e})=>this.plan.states.some(({etp:t})=>t.some(({type:{uid:t}})=>e===t)))},address(){return this.plan.location?{latitude:this.plan.location.latitude,longitude:this.plan.location.longitude,address:this.plan.location.label}:null},center(){return this.plan.location?{center:[this.plan.location.latitude,this.plan.location.longitude],zoom:15}:null},lastState(){return this.plan&&0!==this.plan.states.length?this.plan.states.slice(-1)[0]:null},audience(){if(!this.plan||0===this.plan.states.length)return null;function e(e,t){return{total:e.total+t.total,families:e.families+t.families,women:e.women+t.women,minors:e.minors+t.minors}}return this.plan.states.reduce((t,{audience:s})=>(s.in&&(t.in=e(t.in,s.in)),s.out_positive&&(t.out_positive=e(t.out_positive,s.out_positive)),s.out_abandoned&&(t.out_abandoned=e(t.out_abandoned,s.out_abandoned)),s.out_excluded&&(t.out_excluded=e(t.out_excluded,s.out_excluded)),t),{in:{total:0,families:0,women:0,minors:0},out_positive:{total:0,families:0,women:0,minors:0},out_abandoned:{total:0,families:0,women:0,minors:0},out_excluded:{total:0,families:0,women:0,minors:0}})}},methods:{hasPermission:Io,financeTotal(){return this.plan&&this.plan.finances?this.plan.finances[this.currentFinanceIndex].data.reduce((e,{amount:t})=>e+parseFloat(t),0):0},load(){-1===["loading","loaded"].indexOf(this.status)&&(this.status="loading",this.error=null,V_(this.$route.params.id).then(e=>{this.plan=e,this.closingData.finances=this.plan.finances.map(e=>({...e,data:e.data.map(e=>({...e,type:e.type.uid}))})),this.status="loaded"}).catch(({user_message:e})=>{this.error=e,this.status="loadingError"}))},escapeHtml(...e){return App.escapeHtml(...e)},dateDiff(...e){return App.dateDiff(...e)},formatDate(...e){return App.formatDate(...e)},showPreviousYear(){this.reachedMinFinanceIndex||(this.currentFinanceIndex+=1)},showNextYear(){this.reachedMaxFinanceIndex||(this.currentFinanceIndex-=1)},setClosingAlertStatus(e){this.closingErrors=[],this.closingAlertStatus=e},checkClosing(){const e=[];for(let t=(new Date).getFullYear();t>=Math.max(2019,this.minYear);t-=1){const s=this.closingData.finances.find(({year:e})=>e===t);s&&0!==s.data.length&&!s.data.some(({realAmount:e})=>void 0===e||null===e)||e.push(t)}e.length>0?this.closingErrors=e.map(e=>`Les dépenses exécutées pour l'année ${e} ne sont pas renseignées, il n'est pas possible de fermer le dispositif.`):this.setClosingAlertStatus("step2")},close(){"pending"!==this.closingStatus&&(this.closingStatus="pending",W_(this.$route.params.id,this.closingData).then(()=>{this.closingStatus="success",zc({group:"notifications",type:"success",title:"Dispositif fermé",text:"Le dispositif a bien été fermé"}),this.$router.push("/liste-des-dispositifs")}).catch(({fields:e})=>{this.closingStatus="error",this.closingErrors=Object.keys(e).reduce((t,s)=>[...t,...e[s]],[])}))}}},ug=dg,pg=ug,mg=(s("e438"),Object(d["a"])(pg,lg,cg,!1,null,"23a8c2ae",null)),hg=mg.exports,vg=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("NavBar"),s("section",{staticClass:"section-white"},["loaded"!==e.status?s("div",{staticClass:"container"},[e.status&&"loading"!==e.status?"loadingError"===e.status?s("div",[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("span",{on:{click:e.load}},[e._v("Réessayer ?")])])])]):e._e():s("div",[e._m(0)])]):e._e(),"loaded"===e.status?s("div",[s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1):e._e()])],1)},fg=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])}],_g={components:{NavBar:cr,Form:Hc},data(){const{user:e,topics:t}=Ao(),s={status:null,error:null,formData:{association:[]}};return s.formDefinition={title:"Modifier un dispositif",descriptionTitle:"Pourquoi modifier la fiche du dispositif ?",description:"Vous pouvez modifier ou mettre à jour les informations générales relatives au projet que vous pilotez.<br/>\n            <br/>\n            Deux informations pourront en particulier être mises à jour régulièrement :<br/>\n            - les financements<br/>\n            - les contacts référents<br/>\n            <br/>\n            A noter que les indicateurs de suivi du dispositif sont modifiés directement par la structure ou l’association en charge de l’intervention. Par exemple, le nombre de personnes dans le dispositif ou le nombre de ménages ayant accédé à un logement seront directement renseignés par ces derniers.",steps:[{title:"Dispositif",wording:{error:"La modification du dispositif a échoué",submit:"Modifier le dispositif"},sections:[{title:"Intervention",icon:"list",inputs:{name:{type:"text",label:"Nom du dispositif",mandatory:!0},departement:{type:"text",label:"Département d'intervention",mandatory:!0,disabled:!0},startedAt:{type:"date",label:"Date de début",mandatory:!0},expectedToEndAt:{type:"date",label:"Date de fin prévue (facultatif)",mandatory:!1},in_and_out:{type:"radio",label:"Ce dispositif implique-t-il un système d'entrées et de sorties des personnes ?",mandatory:!0,disabled:!0,options:[{value:1,label:"Oui"},{value:0,label:"Non"}]},topics:{type:"checkbox",label:"Champs d'intervention",description:"Les thématiques sélectionnées définissent l'action que vous menez et les indicateurs de suivi associés.",mandatory:!0,disabled:!0,options:t.map(({uid:e,name:t})=>({value:e,label:t}))},goals:{type:"textarea",label:"Objectifs",mandatory:!0,specificProps:{placeholder:"Précisez les objectifs, les enjeux, le contexte du dispositif\n\nPar exemple : résorber le bidonville, scolariser 80% des enfants identités en bidonvilles..."}}}},{title:"Lieu",icon:"map-pin",inputs:{locationType:{type:"radio",label:"L'action se déroule dans le cadre suivant",mandatory:!0,disabled:!0,options:[{value:"shantytowns",label:"sur site(s) : bidonville ou squat"},{value:"location",label:"sur terrain d'insertion"},{value:"housing",label:"dans le logement"},{value:"other",label:"dans plusieurs lieux (hébergement, permanence, rue...)"}]},locationShantytowns:{type:"townList",label:"Sites concernés",mandatory:!0,disabled:!0,condition({locationType:e}){return"shantytowns"===e}},locationAddress:{type:"addressWithLocation",label:"Adresse du terrain d'insertion",mandatory:!0,disabled:!0,condition({locationType:e}){return"location"===e}},locationDetails:{type:"text",label:"Préciser",mandatory:!0,disabled:!0,condition({locationType:e}){return"other"===e}}}},{title:"Contacts",inputs:{government:{type:"autocompleter",label:"Personne au service de l'état en charge du pilotage",mandatory:!0,specificProps:{autocompleter:e=>{const t=rd("public_establishment"),s=t.then(({users:t})=>t.filter(({first_name:t,last_name:s})=>[t,s].some(t=>e.split(" ").every(e=>-1!==t.toLowerCase().indexOf(e.toLowerCase())))).map(({id:e,first_name:t,last_name:s})=>({id:e,label:`${t} ${s.toUpperCase()}`})));return s.abort=t.abort,s},showCategory:!1,allowMultiple:!1,float:!0}}}},{title:"Financements",inputs:{finances:{label:"Financements",type:"planFunding",mandatory:!1}}}],submit:H_}]},"public_establishment"===e.organization.category.uid&&(s.formData.state=[{id:e.id,label:`${e.first_name} ${e.last_name.toUpperCase()}`}]),s},watch:{"formData.association":function(){this.$refs.form&&(this.loadingAssociationContacts=!0,this.$refs.form.getInputById("contact").options=[],0!==this.formData.association.length&&od(this.formData.association[0].id).then(({users:e})=>{this.$refs.form.getInputById("contact").options=e.map(({id:e,first_name:t,last_name:s})=>({value:e,label:`${t} ${s.toUpperCase()}`})),this.loadingAssociationContacts=!1}))}},created(){this.load()},methods:{load(){-1===["loading","loaded"].indexOf(this.status)&&(this.status="loading",this.error=null,V_(this.$route.params.id).then(e=>{this.formDefinition.title="Modifier un dispositif - "+e.name,this.formData.name=e.name,this.formData.departement=`${e.departement.code} - ${e.departement.name}`,this.formData.startedAt=e.started_at,this.formData.expectedToEndAt=e.expected_to_end_at,this.formData.in_and_out=e.in_and_out?1:0,this.formData.topics=e.topics.map(({uid:e})=>e),this.formData.goals=e.goals,this.formData.locationType=e.location_type.id,this.formData.locationShantytowns=e.shantytowns&&e.shantytowns.length>0?e.shantytowns.map(({id:e})=>e):void 0,this.formData.locationAddress=e.location?{address:{label:e.location.address},location:{coordinates:[e.location.latitude,e.location.longitude],zoom:15}}:void 0,this.formData.locationDetails=e.location_details,this.formData.government=[{id:e.government_contacts[0].id,label:`${e.government_contacts[0].first_name} ${e.government_contacts[0].last_name.toUpperCase()}`}],this.formData.association=[{id:e.operator_contacts[0].organization.id,label:e.operator_contacts[0].organization.name}],this.formData.contact=e.operator_contacts[0].id,this.formData.finances=e.finances.map(({year:e,data:t})=>({year:e,data:t.map(({type:{uid:e},amount:t,details:s,realAmount:i})=>({type:e,amount:t,details:s,realAmount:i}))})),this.plan=e,this.status="loaded"}).catch(e=>{this.error=e.user_message,this.status="loadingError"}))},onComplete(){zc({group:"notifications",type:"success",title:"Dispositif modifié",text:"Le dispositif a bien été mis à jour"}),this.$router.push("/dispositif/"+this.$route.params.id)}}},gg=_g,bg=gg,yg=(s("b82e"),Object(d["a"])(bg,vg,fg,!1,null,null,null)),Cg=yg.exports,wg=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("NavBar"),s("section",{staticClass:"section-white"},["loaded"!==e.status?s("div",{staticClass:"container"},[e.status&&"loading"!==e.status?"loadingError"===e.status?s("div",[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("span",{on:{click:e.load}},[e._v("Réessayer ?")])])])]):e._e():s("div",[e._m(0)])]):e._e(),"loaded"===e.status?s("div",[s("Form",e._b({ref:"form",on:{complete:e.onComplete},model:{value:e.formData,callback:function(t){e.formData=t},expression:"formData"}},"Form",e.formDefinition,!1))],1):e._e()])],1)},xg=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])}],kg={components:{NavBar:cr,Form:Hc},data(){const e={status:null,error:null,formData:{}};return e.formDefinition={title:"",descriptionTitle:"À quoi sert le suivi ?",description:"Les indicateurs de suivi permettent d’<strong>observer l'évolution de l'accès au droit commun et l'insertion</strong> du groupe de personnes accompagnées. Ces informations facilitent le pilotage local et national.",steps:[{title:"Dispositf",wording:{error:"La déclaration du dispositif a échoué",submit:"Valider"},sections:[{inputs:{date:{type:"date",label:"Date d'actualisation des données",mandatory:!0}}},{title:"Public",icon:"arrow-right",inputs:{audience:{type:"audience",label:"Public",mandatory:!0,specificProps:{},condition({date:e}){return!!e}}}},{title:"Équipe",icon:"users",inputs:{etp:{type:"etp",label:"Nombre d’ETP dédiés par fonction",mandatory:!0,condition({date:e}){return!!e}}}},{title:"Droit commun et ressources",description:"Nombre de personnes avec...",icon:"id-card",inputs:{domiciliation:{type:"number",label:"une domiciliation",mandatory:!1,condition({date:e}){return!!e}},droits_caf:{type:"number",label:"des droits CAF ouverts",mandatory:!1,condition({date:e}){return!!e}},emploi_stable:{type:"number",label:"un emploi stable / ressources suffisantes",mandatory:!1,condition({date:e}){return!!e}}}}],submit:e=>{const t={...e,...e.housing};return delete t.housing,G_(this.$route.params.id,t)}}]},e.varyingSections={health:[{title:"Santé",description:"Nombre de personnes avec...",icon:"user-md",inputs:{ame_valide:{type:"number",label:"une couverture AME valide",mandatory:!1,condition({date:e}){return!!e}},puma_valide:{type:"number",label:"une couverture PUMA valide",mandatory:!1,condition({date:e}){return!!e}},ame_en_cours:{type:"number",label:"une demande AME en cours",mandatory:!1,condition({date:e}){return!!e}},puma_en_cours:{type:"number",label:"une demande PUMA en cours",mandatory:!1,condition({date:e}){return!!e}}}},{title:"",description:"Nombre de personnes ayant fait l'objet d'au moins",icon:"user-md",inputs:{orientation:{type:"number",label:"une orientation vers une structure de santé",mandatory:!1,condition({date:e}){return!!e}},accompagnement:{type:"number",label:"un accompagnement physique vers une structure de santé",mandatory:!1,condition({date:e}){return!!e}}}}],school:[{title:"Éducation et scolarisation",icon:"book-reader",inputs:{scolarisables:{type:"number",label:"Parmi les mineurs, combien sont en âge d'être scolarisés ?",mandatory:!1,condition({date:e}){return!!e}},maternelles:{type:"number",label:"Enfants inscrits en maternelle",mandatory:!1,condition({date:e}){return!!e}},elementaires:{type:"number",label:"Enfants inscrits en élémentaire",mandatory:!1,condition({date:e}){return!!e}},colleges:{type:"number",label:"Enfants inscrits au collège",mandatory:!1,condition({date:e}){return!!e}},lycees:{type:"number",label:"Enfants inscrits au lycée - formation professionnelle",mandatory:!1,condition({date:e}){return!!e}},difficultes:{type:"checkbox",label:"Difficultés éventuelles rencontrées :",mandatory:!1,condition({date:e}){return!!e},options:[{value:"cantine",label:"Cantine"},{value:"place_up2a",label:"Manque de place en UP2A"},{value:"transport",label:"Transport"}]}}}],work:[{title:"Formation et emploi",icon:"briefcase",description:"Nombre de personnes inscrites ou suivies par",inputs:{pole_emploi:{type:"number",label:"Pôle emploi",mandatory:!1,condition({date:e}){return!!e}},pole_emploi_femmes:{type:"number",label:"(dont femmes)",mandatory:!1,condition({date:e}){return!!e}},mission_locale:{type:"number",label:"Mission locale",mandatory:!1,condition({date:e}){return!!e}},mission_locale_femmes:{type:"number",label:"(dont femmes)",mandatory:!1,condition({date:e}){return!!e}}}},{icon:"briefcase",description:"Nombre de personnes ayant",inputs:{contrats:{type:"number",label:"un contrat",mandatory:!1,condition({date:e}){return!!e}},contrats_femmes:{type:"number",label:"(dont femmes)",mandatory:!1,condition({date:e}){return!!e}},formations:{type:"number",label:"une formation",mandatory:!1,condition({date:e}){return!!e}},formations_femmes:{type:"number",label:"(dont femmes)",mandatory:!1,condition({date:e}){return!!e}},autoentrepreneurs:{type:"number",label:"un statut autoentrepreneur",mandatory:!1,condition({date:e}){return!!e}},autoentrepreneurs_femmes:{type:"number",label:"(dont femmes)",mandatory:!1,condition({date:e}){return!!e}},are:{type:"number",label:"l'ARE",mandatory:!1,condition({date:e}){return!!e}},are_femmes:{type:"number",label:"(dont femmes)",mandatory:!1,condition({date:e}){return!!e}}}}],housing:[{title:"Logement",icon:"home",inputs:{housing:{type:"planHousing",label:"",mandatory:!1,condition({date:e}){return!!e}}}}],safety:[{title:"Stabilisation et sécurisation du site",icon:"seedling",inputs:{points_eau:{type:"number",label:"Nombre d'accès réguliers à l'eau potable",mandatory:!1,condition({date:e}){return!!e}},wc:{type:"number",label:"Nombre de sanitaires",mandatory:!1,condition({date:e}){return!!e}},electricite:{type:"number",label:"Nombre d'accès réguliers à l'électricité",mandatory:!1,condition({date:e}){return!!e}},nombre_bennes:{type:"number",label:"Nombre de bennes disponibles pour le ramassage des déchets du site",mandatory:!1,condition({date:e}){return!!e}}}}]},e},created(){this.load()},methods:{hasPermission:Io,load(){-1===["loading","loaded"].indexOf(this.status)&&(this.status="loading",this.error=null,V_(this.$route.params.id).then(e=>{e.topics.forEach(({uid:e})=>{this.varyingSections[e]&&this.varyingSections[e].forEach(e=>{this.formDefinition.steps[0].sections.push(e)})});const t=this.formDefinition.steps[0].sections.find(({inputs:e})=>void 0!==e.audience);let s=null;if(0===e.states.length)t.title="Qui sont les publics ayant intégré le dispositif ?",t.description="Vous renseignez les indicateurs de suivi pour la première fois. Veuillez porter une attention particulière aux données que vous renseignez ci-dessous : les mises à jour ultérieures seront conditionnées par cette première déclaration.",t.inputs.audience.specificProps.inOnly=!0;else{[s]=e.states.slice(-1);const i=App.formatDate(s.date/1e3,"d/m/y");!0!==e.in_and_out?(t.title=`Quelles ont été les sorties du dispositif depuis la date du ${i} ?`,t.description="Seules les sorties du dispositif sont suivies, car le pilote de l’action au sein des services de l’Etat a renseigné qu’il n’existe pas de système d’entrées et de sorties du dispositif : le dispositif concerne un seul groupe de personne, ayant débuté le projet à la même période.<br/>\n                            Attention : le remplissage de ce tableau a un impact sur le nombre de personnes identifiées dans ce dispositif. Merci de le renseigner avec attention",t.inputs.audience.specificProps.outOnly=!0):(t.title=`Quelles ont été les entrées et sorties du dispositif depuis la date du ${i} ?`,t.description="Les entrées et sorties du dispositif sont suivies, car le pilote de l’action au sein des services de l’Etat a renseigné qu’il existe un système d’entrées et de sorties.<br/>\n                            Attention : le remplissage de ce tableau a un impact sur le nombre de personnes identifiées dans ce dispositif. Merci de le renseigner avec attention"),t.description+=`<br/><br/>\n                        Au ${i}, date de la dernière mise à jour des informations, sont intégrés dans le dispositif :\n                        ${e.audience.families} ménages, ${e.audience.total} personnes dont ${e.audience.women} femmes et ${e.audience.minors} mineurs\n                        `}s&&(this.formData={difficultes:["cantine","place_up2a","transport"].filter(e=>s.education&&(s.education["difficulte_"+e]||s.education["difficculte_"+e])),etp:s.etp.map(({total:e,type:{uid:t}})=>({total:e,type:t}))}),this.formDefinition.title=e.name,this.plan=e,this.status="loaded"}).catch(e=>{this.error=e.user_message,this.status="loadingError"}))},onComplete(){zc({group:"notifications",type:"success",title:"Indicateurs correctement enregistrés",text:"Le dispositif a bien été mis à jour"}),this.$router.push("/dispositif/"+this.$route.params.id)}}},Pg=kg,Sg=Pg,$g=(s("0045"),Object(d["a"])(Sg,wg,xg,!1,null,"8f52fc1c",null)),Tg=$g.exports,Ag=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section--white"},[s("div",{staticClass:"container"},["loaded"===e.status?s("div",e._l(e.sections,(function(t){return s("section",{staticClass:"formSection"},[s("header",{staticClass:"formSection-header"},[s("h1",{staticClass:"formSection-title"},[e._v(e._s(t.title))]),s("p",[e._v("Total : "+e._s(e.computeTotal(t.id)))])]),s("div",{staticClass:"panel"},[s("table",{staticClass:"table"},[s("thead",[s("tr",[s("th",[e._v("Département")]),s("th",[e._v(e._s(t.title))])])]),s("tbody",e._l(e.stats.numberOfShantytownOperations[t.id],(function(t){return s("tr",[s("td",[e._v("("+e._s(t.code)+") - "+e._s(t.name))]),s("td",[e._v(e._s(t.total))])])})),0)])])])})),0):e._e(),"loading"===e.status?s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])]):e._e(),"loading"!==e.status&&"loaded"!==e.status?s("div",{staticClass:"notification full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.load}},[e._v("Réessayer ?")])])]):e._e()])])],1)])},Eg=[];function Og(){return bo("/stats")}var Ig={components:{NavBar:cr},data(){return{status:null,error:null,stats:null,sections:[{id:"creations",title:"Nombre de sites créés"},{id:"updates",title:"Nombre de sites modifiés"},{id:"closings",title:"Nombre de sites fermés"}]}},mounted(){this.load()},methods:{load(){"loaded"!==this.status&&"loading"!==this.status&&(this.status="loading",this.error=null,Og().then(({statistics:e})=>{this.stats=e,this.status="loaded"}).catch(({user_message:e})=>{this.status="error",this.error=e}))},computeTotal(e){return this.stats.numberOfShantytownOperations[e].reduce((e,{total:t})=>e+parseInt(t,10),0)}}},Dg=Ig,jg=Dg,qg=(s("12a5"),Object(d["a"])(jg,Ag,Eg,!1,null,null,null)),Lg=qg.exports,Fg=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white",attrs:{id:"form"}},[s("div",{staticClass:"container"},[s("h1",[e._v("Mentions légales")]),s("h3",[e._v("Editeurs")]),s("p",[s("router-link",{attrs:{to:"/"}},[e._v("Résorption bidonvilles")]),e._v(" est édité par la Fabrique numérique du ministère de la transition écologique et solidaire et du ministère de la cohésion des territoires et des relations avec les collectivités territoriales, sise 1 place Carpeaux, 92800 Puteaux, avec l’appui de l’incubateur de services numériques (beta.gouv.fr) de la direction interministérielle du numérique et du système d’information et de communication de l’État (DINSIC).")],1),s("h3",[e._v("Nous joindre")]),e._m(0),s("h3",[e._v("Directeurs de la publication")]),e._m(1),s("h3",[e._v("Prestataire d’hébergement")]),s("p",[e._v("Le site "),s("router-link",{attrs:{to:"/"}},[e._v("resorption-bidonvilles.beta.gouv.fr")]),e._v(" est hébergé par la société OVH"),s("br"),e._v("Code APE 6202A"),s("br"),e._v("N° TVA : FR 22 424 761 419"),s("br"),e._v("Inscrite au RCS Roubaix – Tourcoing 424 761 419 00045")],1),s("p",[e._v("Siège social : 2 rue Kellermann, 59100 Roubaix, France")])])])],1)])},Mg=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("ul",[s("li",[e._v("Par téléphone : +33 (0) 1 40 81 33 60")]),s("li",[e._v("Par mail : "),s("a",{staticClass:"mail",attrs:{href:"#","data-name":"contact","data-domain":"resorption-bidonvilles.beta.gouv","data-tld":"fr",onclick:"window.location.href = 'mailto:' + this.dataset.name + '@' + this.dataset.domain + '.' + this.dataset.tld; return false;"}})])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("ul",[s("li",[e._v("Délégué interministériel à l’hébergement et l’accès au logement")]),s("li",[e._v("La Grande Arche - 92055 La Défense Cedex")])])])}],Ng={components:{NavBar:cr}},zg=Ng,Bg=zg,Rg=(s("30ce"),Object(d["a"])(Bg,Fg,Mg,!1,null,"ed8e96dc",null)),Vg=Rg.exports,Ug=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("Skeleton",{attrs:{loader:e.loader},on:{loaded:e.onLoaded},scopedSlots:e._u([{key:"title",fn:function(){return[s("h1",{staticClass:"page-title"},[e._v("Annuaire")]),s("p",{staticClass:"page-subtitle"},[e._v("Cette liste n’est pas exhaustive et regroupe à ce stade les utilisateurs de la plateforme à l’échelle nationale.")])]},proxy:!0},{key:"content",fn:function(){return[null!==e.focusedOrganization?s("Organization",{attrs:{organization:e.focusedOrganization},on:{close:e.resetFocusedOrganization}}):e._e(),s("div",{staticClass:"directory-search"},[s("OrganizationInput",{attrs:{specificProps:{placeholder:"Acteur, structure, ou territoire"}},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e.localIsNational?e._e():s("div",{staticClass:"switch"},[s("button",{class:{active:"local"===e.level},on:{click:function(t){return e.setLevel("local")}}},[e._v("Acteurs de mon territoire")]),s("button",{class:{active:"local"!==e.level},on:{click:function(t){return e.setLevel("national")}}},[e._v("Tous les acteurs")])]),s("Table",{staticClass:"directory",attrs:{columns:e.columns,content:e.pageContent,emptyLabel:"Aucun contact répertorié pour les filtres sélectionnés"},on:{click:e.focus}},[s("template",{slot:"aside"},[s("p",{staticClass:"directory-figures"},[e._v(e._s(e.filteredOrganizations.length)+" structure"+e._s(e.filteredOrganizations.length>1?"s":"")+" - "+e._s(e.usersTotal)+" contact"+e._s(e.usersTotal>1?"s":""))])])],2),s("div",{staticClass:"directory-tableAside"},[s("p",[e._v("Vous recherchez un contact public ? "),s("a",{attrs:{href:"https://lannuaire.service-public.fr"}},[e._v("https://lannuaire.service-public.fr")])])])]},proxy:!0}])})],1)},Hg=[],Gg=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"page page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("header",{staticClass:"page-header"},[s("hgroup",{staticClass:"page-titleContainer"},[e._t("title")],2),"loaded"===e.loading.status?s("div",{staticClass:"page-buttons"},[e._t("buttons")],2):e._e()]),"loading"===e.loading.status&&e.loading.isSlow?s("div",{staticClass:"notification notification--loading full-width"},[e._m(0),e._m(1)]):e._e(),"failed"===e.loading.status?s("div",{staticClass:"notification notification--failure error full-width"},[s("p",{staticClass:"notification-icon"},[s("font-awesome-icon",{attrs:{icon:"times",size:"2x"}})],1),s("p",{staticClass:"notification-content"},[s("span",{staticClass:"notification-title"},[e._v("Le chargement des données a échoué")]),s("br"),s("span",{staticClass:"notification-description"},[e._v(e._s(e.loading.error))])])]):e._e(),"loaded"===e.loading.status?e._t("content",null,{data:e.data}):e._e()],2)])],1)},Wg=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",{staticClass:"notification-icon"},[s("img",{attrs:{src:"/img/spinner_dark.svg"}})])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",{staticClass:"notification-content"},[s("span",{staticClass:"notification-title"},[e._v("Chargement des données en cours")])])}];const Yg=1500;var Jg={components:{NavBar:cr},props:{loader:{type:Function,required:!1}},data(){return{data:null,loading:{status:null,error:null,isSlow:!1,slowTimeout:null}}},mounted(){void 0!==this.loader?this.load():this.loading.status="loaded"},methods:{load(){"loading"!==this.loading.status&&"loaded"!==this.loading.status&&(this.loading.isSlow=!1,this.loading.status="loading",this.loading.error=null,this.loading.slowTimeout=setTimeout(()=>{this.loading.isSlow=!0},Yg),this.loader().then(e=>{this.$emit("loaded",e),this.data=e,this.loading.status="loaded"}).catch(e=>{this.loading.status="failed",this.loading.error=e&&e.user_message||"Une erreur inconnue est survenue"}).then(()=>{clearTimeout(this.loading.slowTimeout),this.loading.slowTimeout=null}))}}},Qg=Jg,Zg=Qg,Kg=Object(d["a"])(Zg,Gg,Wg,!1,null,null,null),Xg=Kg.exports,eb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popin"},[s("div",{ref:"wrapper",staticClass:"popin-wrapper"},[s("div",[s("p",{staticClass:"popin-close"},[s("span",{staticClass:"link",on:{click:e.close}},[s("font-awesome-icon",{attrs:{icon:"times",size:"2x"}})],1)]),s("section",{staticClass:"organization-body"},[s("h1",{staticClass:"primary"},[e._v("Structure")]),s("p",[e._v(e._s(e.organization.name))]),s("h1",{staticClass:"primary"},[e._v("Territoire")]),s("p",[e._v(e._s(e.organization.locationName))]),s("h1",{staticClass:"primary"},[e._v("Rôle")]),s("p",{staticStyle:{margin:"5px 0 35px 0"}},[s("span",{staticClass:"role"},[e._v(e._s(e.organization.role))])]),s("h1",[e._v(e._s(e.organization.users.length)+" contact"+e._s(e.organization.users.length>1?"s":""))]),s("div",{staticClass:"organization-users"},e._l(e.organization.users,(function(t){return s("div",{staticClass:"userCard"},[s("h1",[e._v(e._s(t.first_name)+" "+e._s(t.last_name.toUpperCase()))]),s("h2",[e._v("Fonction")]),s("h3",{class:{"userCard-position--empty":!t.position}},[e._v(e._s(t.position||"NC"))]),s("ul",{staticClass:"userCard-infoList"},[s("li",{staticClass:"userCard-info--email"},[s("a",{attrs:{href:"mailto:"+t.email}},[e._v(e._s(t.email))])]),t.phone?s("li",{staticClass:"userCard-info--phone"},[e._v(e._s(t.phone))]):e._e()])])})),0)])])])])},tb=[],sb={props:{organization:{type:Object,required:!0}},mounted(){setTimeout(()=>{document.addEventListener("click",this.checkOutsideClick)},500)},destroyed(){document.removeEventListener("click",this.checkOutsideClick)},methods:{checkOutsideClick(e){this.$refs.wrapper.contains(e.target)||this.close()},close(){this.$emit("close")}}},ib=sb,ab=ib,nb=(s("f090"),Object(d["a"])(ab,eb,tb,!1,null,"eb1c327e",null)),ob=nb.exports;function rb(e){return yo("/statistics/directory-views",{organization:e})}var lb={components:{Skeleton:Xg,Table:Sl,Organization:ob,OrganizationInput:uc},data(){return{organizations:[],columns:[{id:"organization",label:"Structure"},{id:"location",label:"Territoire"},{id:"role",label:"Rôle"},{id:"contacts",label:"",icon:"arrow-right"}],local:Ao().user.organization.location,level:"local",search:null}},computed:{localIsNational(){return"nation"===this.local.type},parsedOrganizations(){let e=[];return e=this.localIsNational||"national"===this.level?this.organizations:this.organizations.filter(e=>{const t=this.local[this.local.type],s=e.location[this.local.type];return t&&s&&t.code===s.code}),e.map(e=>{let t,s;if(t=null!==e.type.abbreviation?`${e.type.abbreviation} (${e.name})`:null!==e.abbreviation?`${e.abbreviation} (${e.name})`:e.name,"nation"===e.location.type)s="National";else{const t=e.location[e.location.type];s=t?"departement"===e.location.type?`${t.name} (${t.code})`:t.name:""}return{id:e.id,organization:t,location:s,role:`<span class="role">${e.role}</span>`,contacts:e.users.length>0?`<span class="link">${e.users.length} contact${e.users.length>1?"s":""}</span>`:"",raw:{id:e.id,name:t,location:e.location,locationName:s,role:e.role,users:e.users}}})},filteredOrganizations(){if(null===this.search)return this.parsedOrganizations;let e;switch(this.search.data.type.id){case"user":e=({id:e})=>e===this.search.data.organization;break;case"location":e=({raw:{location:e}})=>e[this.search.data.location_type]&&e[this.search.data.location_type].code===this.search.data.id;break;case"organization":e=({id:e})=>e===this.search.data.id;break;default:e=()=>!1}return this.parsedOrganizations.filter(e)},focusedOrganization(){if(!this.$route.params.id)return null;const e=this.parsedOrganizations.find(({id:e})=>e===parseInt(this.$route.params.id,10));return void 0===e?null:e.raw},pageContent(){return this.filteredOrganizations.slice(this.pageBeginning-1,this.pageEnd)},usersTotal(){return this.filteredOrganizations.reduce((e,t)=>e+t.raw.users.length,0)}},watch:{focusedOrganization(){null!==this.focusedOrganization&&rb(this.focusedOrganization.id)}},methods:{loader:tr,onLoaded({organizations:e}){this.organizations=e},setLevel(e){this.level!==e&&(this.level=e)},focus({raw:e}){this.$router.push("/annuaire/"+e.id)},resetFocusedOrganization(){this.$router.push("/annuaire")}}},cb=lb,db=cb,ub=(s("e744"),Object(d["a"])(db,Ug,Hg,!1,null,null,null)),pb=ub.exports,mb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),"loading"===e.state?s("section",{staticClass:"section section-white"},[e._m(0)]):e._e(),"error"===e.state?s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])])])]):e._e(),"loaded"===e.state?s("section",{staticClass:"section section-white"},[null!==e.toBeDeleted?s("CommentDeletion",{attrs:{comment:e.toBeDeleted},on:{close:e.closePopin,deleted:e.onCommentDeleted}}):e._e(),s("div",{staticClass:"container"},[s("header",[e._m(1),s("SlideNote",{staticClass:"userActivity-rule",attrs:{title:"Règles de modération d'un commentaire"}},[s("template",{slot:"content"},[s("h1",[e._v("En tant qu'administrateur, vous êtes en charge de la modération des commentaires.")]),s("p",[e._v("Vous pouvez supprimer un commentaire ou demander à son auteur de le modifier s'il ne respecte pas les règles suivantes : "),s("ul",[s("li",[e._v("être neutre et factuel ;")]),s("li",[e._v("ne pas collecter des données personnelles (nom, condamnation judiciaire...) de personnes ou groupes, porter une attention particulière aux personnes habitant ou issues d'un bidonville ;")]),s("li",[e._v("ne doit pas être subjectif, insultant ou inapproprié.")])])]),s("p",[e._v("Pour plus d'informations :"),s("br"),s("router-link",{staticClass:"link",attrs:{to:"/typologie-des-acces"}},[s("font-awesome-icon",{attrs:{icon:"file-pdf"}}),e._v(" Guide des accès et de l'administrateur")],1),s("br"),s("router-link",{staticClass:"link",attrs:{to:"/charte-d-engagement"}},[s("font-awesome-icon",{attrs:{icon:"file-pdf"}}),e._v(" Charte d'engagement de l'utilisateur")],1)],1)])],2),s("div",{staticClass:"switch"},[s("button",{class:{active:"all"===e.filter},on:{click:function(t){return e.show("all")}}},[e._v("Tout")]),s("button",{class:{active:"shantytown"===e.filter},on:{click:function(t){return e.show("shantytown")}}},[e._v("Modifications")]),s("button",{class:{active:"comment"===e.filter},on:{click:function(t){return e.show("comment")}}},[e._v("Commentaires")])])],1),s("Table",{staticClass:"userActivity",attrs:{columns:e.columns,content:e.parsedActivities,emptyLabel:"Aucune activité trouvée pour les filtres sélectionnés"},on:{click:e.onRowClick},scopedSlots:e._u([{key:"date",fn:function(t){return[s("strong",[e._v(e._s(t.row.date))]),s("br"),e._v("à "+e._s(t.row.time))]}},{key:"author",fn:function(t){return[s("font-awesome-icon",{staticClass:"link",attrs:{icon:"user"}}),e._v(" "),s("router-link",{staticClass:"link",attrs:{"data-group":"link",to:"/annuaire/"+t.row.author.organization}},[e._v(e._s(t.row.author.name))])]}},{key:"activity",fn:function(t){return[s("span",{staticClass:"userActivity-action"},[s("font-awesome-icon",{attrs:{icon:t.row.icon}}),e._v(" "+e._s(t.row.action)+" site : "+e._s(t.row.address)+" ")],1),void 0!==t.row.content?s("div",{staticClass:"userActivity-content",domProps:{innerHTML:e._s(t.row.content)}}):e._e(),void 0!==t.row.comment?s("div",{staticClass:"userActivity-remove"},[s("span",{staticClass:"link",on:{click:function(s){return e.confirmCommentDeletion(t.row,s)}}},[s("font-awesome-icon",{attrs:{icon:"trash-alt"}}),e._v(" Supprimer")],1)]):e._e(),e._l(t.row.diff,(function(i){return t.row.diff?s("p",{staticClass:"changelog"},[s("span",{staticClass:"changelog-name"},[e._v(e._s(i.field)+" :")]),s("br"),s("span",{staticClass:"changelog-oldValue",class:{"changelog-value--unknown":!i.oldValue}},[e._v(e._s(i.oldValue||"non renseigné"))]),e._v(", "),s("span",{staticClass:"changelog-newValue",class:{"changelog-value--unknown":!i.newValue}},[e._v(e._s(i.newValue||"non renseigné"))])]):e._e()}))]}}],null,!1,2101574153)})],1)],1):e._e()],1)])},hb=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("hgroup",[s("h3",[e._v("Historique des activités")])])])}];function vb(e={}){let t="";return Object.keys(e).length>0&&(t="filters=",t+=Object.keys(e).map(t=>`${t}:${encodeURIComponent(e[t])}`).join(",")),bo("/user-activities?"+t)}var fb={components:{NavBar:cr,Table:Sl,CommentDeletion:gh,SlideNote:Mc},data(){return{activities:[],error:null,state:null,toBeDeleted:null,filter:"all"}},computed:{columns(){return[{id:"date",label:"Date"},{id:"author",label:"Auteur"},{id:"activity",label:"Activités",..."shantytown"===this.filter?{filters:[{label:"Déclaration",value:"creation"},{label:"Modification",value:"update"},{label:"Fermeture",value:"closing"}],filterFn:(e,t)=>-1!==t.map(({value:e})=>e).indexOf(e.rawAction)}:{}}]},filteredActivities(){return"all"===this.filter?this.activities:this.activities.filter(({entity:e})=>e===this.filter)},parsedActivities(){return this.filteredActivities.map((e,t)=>{const s={index:t,rawAction:e.action,rawDate:e.date,rawShantytown:e.shantytown,date:App.formatDate(e.date,"d/m/y"),time:App.formatDate(e.date,"h:i"),author:e.author,icon:"comment"===e.entity?"comment":"pencil-alt",shantytown:e.shantytown.id,address:`${e.shantytown.usename}, ${e.shantytown.city}`},i={creation:"Déclaration du",update:"Modification du",closing:"Fermeture du"};return"comment"===e.entity?(s.action="Commentaire sur le",s.content=e.content,s.comment=e.comment_id):(s.action=i[e.action],s.diff=e.diff),s})}},created(){this.load()},methods:{load(){-1!==[null,"error"].indexOf(this.state)&&(this.state="loading",this.error=null,vb().then(e=>{this.activities=e,this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))},retryLoading(){this.load()},formatDate(...e){return window.App.formatDate.apply(window,e)},onRowClick(e){this.$router.push("/site/"+e.shantytown)},confirmCommentDeletion(e,t){return this.toBeDeleted={index:e.index,id:e.comment,shantytown:e.rawShantytown,author:e.author,date:e.rawDate,content:e.content},t.stopPropagation(),!1},closePopin(){this.toBeDeleted=null},onCommentDeleted(){this.activities.splice(this.toBeDeleted.index,1),this.toBeDeleted=null,zc({group:"notifications",type:"success",title:"Commentaire supprimé",text:"L'auteur du commentaire en a été notifié par email"})},show(e){this.filter=e}}},_b=fb,gb=_b,bb=(s("3a02"),Object(d["a"])(gb,mb,hb,!1,null,null,null)),yb=bb.exports,Cb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("PublicLayout",{attrs:{stickyHeader:!1}},[s("PublicContainer",{staticClass:"py-16"},[s("div",[s("h1",{staticClass:"text-display-xl"},[e._v("Statistiques")]),s("div",[e._v(" Depuis l'ouverture nationale de la plateforme en juin 2019 ")])]),s("StatsSection",{staticClass:"mt-16",attrs:{title:"Utilisateurs"}},[s("StatsBlock",{attrs:{title:e.numberOfDepartements,icon:"flag",subtitle:"départements de France métropolitaine",info:"Soit tous les départements concernés par le phénomène de squats ou bidonvilles."}}),s("StatsBlock",{attrs:{title:e.numberOfCollaboratorAndAssociationUsers,icon:"users",subtitle:"utilisateurs institutionnels et associatifs",info:e.numberOfPublicEstablishments+" services de l'État, "+e.numberOfTerritorialCollectivities+" collectivités territoriales, "+e.numberOfAssociations+" associations"}}),s("StatsBlock",{attrs:{title:e.numberOfNewUsers.total,icon:"user-plus",subtitle:"nouveaux utilisateurs en "+e.numberOfNewUsers.month.toLowerCase()}})],1),null!==e.numberOfNewUsersPerMonth?s("div",[s("h2",{staticClass:"text-display-lg text-secondary mt-16"},[e._v(" Nombre d' utilisateurs depuis "+e._s(e.numberOfNewUsersPerMonth[0].month.toLowerCase())+" ")]),s("TrendChart",{staticClass:"stats-chart",attrs:{datasets:e.usersEvolutionDatasets,labels:e.usersEvolutionLabels,grid:{verticalLines:!0,horizontalLines:!0},max:e.usersEvolutionMax,min:0}})],1):e._e(),s("StatsSection",{staticClass:"mt-16",attrs:{title:"Usage"}},[s("StatsBlock",{attrs:{title:e.numberOfExports,icon:"file-download",subtitle:"extractions de données réalisées",info:"Les exports Excel permettent aux acteurs locaux d'utiliser et d'analyser les données afin de suivre, communiquer et optimiser les actions de résorption depuis le 15/11/2019."}}),s("StatsBlock",{attrs:{title:e.numberOfComments,icon:"comment",subtitle:"commentaires créés",info:"Au delà du suivi des chiffrés, les commentaires permettent de suivre et de partager des informations qualitative utiles dans une action multi-partenariale."}}),s("StatsBlock",{attrs:{title:e.numberOfDirectoryViews,icon:"address-book",subtitle:"fiches contact consultées",info:"L'annuaire permet d'accéder aux coordonnées de tous les utilisateurs de la plateforme. Son utilisation participe à la mise en réseau partenaires locaux ou des pairs depuis le 15/11/2019"}})],1),s("StatsSection",{staticClass:"mt-16",attrs:{title:"Fréquence de mise à jour"},scopedSlots:e._u([{key:"info",fn:function(){return[s("span",{staticClass:"text-secondary"},[s("font-awesome-icon",{attrs:{icon:"sync"}})],1),e._v(" La mise à jour régulière des données garantissent des informations justes à tous les acteurs.")]},proxy:!0},{key:"default",fn:function(){return[s("StatsBlock",{attrs:{title:e.meanTimeBeforeCreationDeclaration,subtitle:"jours entre l'installation d'un bidonville ou squat et sa déclaration",info:"En moyenne, depuis le 01/09/2019."}}),s("StatsBlock",{attrs:{title:e.meanTimeBeforeClosingDeclaration,subtitle:"jours entre la fermeture du site et sa déclaration",info:"En moyenne, depuis le 01/09/2019."}}),s("StatsBlock",{attrs:{title:e.numberOfShantytownOperations,subtitle:"bidonvilles ou squats mis à jour",info:"Toutes opérations confondues : création, modification, fermeture"}})]},proxy:!0}])})],1)],1)},wb=[],xb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"text-display-lg"},[e._v(" "+e._s(e.title)+" "),s("span",{staticClass:"text-secondary"},[e.icon?s("font-awesome-icon",{attrs:{icon:e.icon}}):e._e()],1)]),s("div",{staticClass:"text-display-sm"},[e._v(e._s(e.subtitle))]),s("div",{staticClass:"text-sm"},[e._v(e._s(e.info))])])},kb=[],Pb={props:{title:{type:[String,Number],required:!0},subtitle:{type:String,required:!0},info:{type:String,required:!1},icon:{type:String,required:!1}}},Sb=Pb,$b=Object(d["a"])(Sb,xb,kb,!1,null,null,null),Tb=$b.exports,Ab=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",{staticClass:"text-display-lg text-secondary"},[e._v(e._s(e.title))]),e._t("info"),s("div",{staticClass:"grid grid-cols-1 md:grid-cols-3 gap-16 mt-8"},[e._t("default")],2)],2)},Eb=[],Ob={props:{title:{required:!0,type:String}}},Ib=Ob,Db=Object(d["a"])(Ib,Ab,Eb,!1,null,null,null),jb=Db.exports,qb={components:{PublicLayout:ba,PublicContainer:Vi,StatsSection:jb,StatsBlock:Tb},data(){return{state:null,error:null,stats:null}},created(){this.load()},computed:{numberOfDepartements(){return this.stats?this.stats.numberOfDepartements:"..."},numberOfCollaboratorAndAssociationUsers(){return this.stats?this.stats.numberOfCollaboratorAndAssociationUsers:"..."},numberOfTerritorialCollectivities(){return this.stats?this.stats.numberOfCollaboratorAndAssociationOrganizations.territorial_collectivity||0:"..."},numberOfAssociations(){return this.stats?this.stats.numberOfCollaboratorAndAssociationOrganizations.association||0:"..."},numberOfPublicEstablishments(){return this.stats?this.stats.numberOfCollaboratorAndAssociationOrganizations.public_establishment||0:"..."},numberOfExports(){return this.stats?this.stats.numberOfExports:"..."},numberOfComments(){return this.stats?this.stats.numberOfComments:"..."},numberOfDirectoryViews(){return this.stats?this.stats.numberOfDirectoryViews:"..."},numberOfNewUsersPerMonth(){return this.stats&&this.stats.numberOfNewUsersPerMonth||null},usersEvolutionDatasets(){if(null===this.numberOfNewUsersPerMonth)return[];const e=this.numberOfNewUsersPerMonth.reduce((e,{total:t},s)=>0===s?[parseInt(t,10)]:[...e,parseInt(t,10)+e[e.length-1]],[]);return[{data:e,smooth:!0,fill:!0}]},usersEvolutionMax(){if(null===this.numberOfNewUsersPerMonth)return 0;const e=this.numberOfNewUsersPerMonth.reduce((e,{total:t})=>Math.max(e,t),0);return 10*Math.ceil(e/10)},usersEvolutionLabels(){return null===this.numberOfNewUsersPerMonth?{xLabels:[],yLabels:10}:{xLabels:this.numberOfNewUsersPerMonth.map(({month:e})=>e),yLabels:this.usersEvolutionMax/10+1,yLabelsTextFormatter:e=>e.toFixed(1)}},numberOfNewUsers(){return this.stats&&this.stats.numberOfNewUsersPerMonth?this.stats.numberOfNewUsersPerMonth.slice(-1)[0]:{total:"...",month:"..."}},meanTimeBeforeCreationDeclaration(){return this.stats?Math.round(this.stats.meanTimeBeforeCreationDeclaration.average)||"?":"..."},meanTimeBeforeClosingDeclaration(){return this.stats?Math.round(this.stats.meanTimeBeforeClosingDeclaration.average)||"?":"..."},numberOfShantytownOperations(){return this.stats?this.stats.numberOfShantytownOperations:"..."}},methods:{load(){"loading"!==this.state&&(this.state="loading",this.error=null,Og().then(({statistics:e})=>{this.stats=e,this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"}))}}},Lb=qb,Fb=Object(d["a"])(Lb,Cb,wb,!1,null,null,null),Mb=Fb.exports,Nb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),"loading"===e.state?s("section",{staticClass:"section section-white"},[e._m(0)]):e._e(),"error"===e.state?s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("div",{staticClass:"notification error full-width"},[s("span",[e._v(e._s(e.error)+". "),s("a",{attrs:{href:"#"},on:{click:e.retryLoading}},[e._v("Réessayer ?")])])])])]):e._e(),"loaded"===e.state?s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("header",[s("div",[e._m(1),s("p",[e._v("L'ensemble des commentaires sur votre territoire (département ou région)")]),e.canSubmitHighComment?s("SlideNote",{attrs:{title:"Écrire un commentaire 'Territoire'",opened:!0,icon:"comment"}},[s("template",{slot:"content"},[s("p",[e._v('Les commentaires "territoires" permettent de partager des informations sur le pilotage, la coordination et l\'organisation retenus au niveau local.')]),s("p",[s("span",[s("strong",[e._v("Territoire(s) concerné(s) par votre commentaire :")])]),s("br"),s("ul",{staticClass:"input--checkbox"},e._l(e.allowedDepartements,(function(t,i){return s("li",{staticClass:"input--checkbox-option"},[s("label",{attrs:{for:"input"+e._uid+"-"+i}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.highCovidComment.data.departements,expression:"highCovidComment.data.departements"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"input"+e._uid+"-"+i,name:"input"+e._uid,disabled:e.highCovidComment.pending||e.allowedDepartements.length<=1},domProps:{value:t.code,checked:Array.isArray(e.highCovidComment.data.departements)?e._i(e.highCovidComment.data.departements,t.code)>-1:e.highCovidComment.data.departements},on:{change:function(s){var i=e.highCovidComment.data.departements,a=s.target,n=!!a.checked;if(Array.isArray(i)){var o=t.code,r=e._i(i,o);a.checked?r<0&&e.$set(e.highCovidComment.data,"departements",i.concat([o])):r>-1&&e.$set(e.highCovidComment.data,"departements",i.slice(0,r).concat(i.slice(r+1)))}else e.$set(e.highCovidComment.data,"departements",n)}}}),e._v(" "+e._s(t.code+" - "+t.name)+" ")])])})),0)]),s("p",[s("span",[s("strong",[e._v("Votre commentaire :")])]),s("br"),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.highCovidComment.data.description,expression:"highCovidComment.data.description"}],staticClass:"input input--textarea",attrs:{disabled:e.highCovidComment.pending,readonly:e.highCovidComment.pending},domProps:{value:e.highCovidComment.data.description},on:{input:function(t){t.target.composing||e.$set(e.highCovidComment.data,"description",t.target.value)}}})]),null!==e.highCovidComment.error?s("p",{staticClass:"error"},[s("span",{staticClass:"error"},[e._v(e._s(e.highCovidComment.error.message))])]):e._e(),s("p",[s("button",{staticClass:"form-stepButton button",attrs:{disabled:e.highCovidComment.pending},on:{click:e.submitHighCovidComment}},[e.highCovidComment.pending?s("img",{attrs:{src:"/img/spinner_light.svg",width:"20"}}):s("span",[e._v("Envoyer")])])])])],2):e._e()],1),s("div",{staticClass:"switch"},[s("button",{class:{active:"all"===e.filter},on:{click:function(t){return e.setFilter("all")}}},[e._v("Tous")]),s("button",{class:{active:"regular"===e.filter},on:{click:function(t){return e.setFilter("regular")}}},[e._v('Commentaires "Sites"')]),s("button",{class:{active:"high"===e.filter},on:{click:function(t){return e.setFilter("high")}}},[e._v('Commentaires "Territoire"')])])]),s("Table",{staticClass:"userActivity",attrs:{columns:e.columns,content:e.parsedActivities,emptyLabel:"Aucune activité trouvée pour les filtres sélectionnés"},on:{click:e.onRowClick},scopedSlots:e._u([{key:"date",fn:function(t){return[s("strong",[e._v(e._s(t.row.date))]),s("br"),e._v("à "+e._s(t.row.time))]}},{key:"author",fn:function(t){return[s("font-awesome-icon",{staticClass:"link",attrs:{icon:"user"}}),e._v(" "),s("router-link",{staticClass:"link",attrs:{"data-group":"link",to:"/annuaire/"+t.row.author.organization}},[e._v(e._s(t.row.author.name))])]}},{key:"activity",fn:function(t){return[t.row.covid?s("span",{staticClass:"userActivity-action"},[s("font-awesome-icon",{attrs:{icon:t.row.icon}}),e._v(" "+e._s(t.row.action)+" site : "+e._s(t.row.address)+" ")],1):s("span",{staticClass:"userActivity-action"},[s("font-awesome-icon",{attrs:{icon:t.row.icon}}),e._v(" Commentaire sur le territoire : "+e._s(t.row.highCovid.departements.map((function(e){var t=e.code;return t})).join(", "))+" ")],1),s("div",{staticClass:"userActivity-content"},[t.row.covid?s("p",e._l(e.covidTags,(function(i){return!0===t.row.covid[i.prop]?s("span",{class:"rbTag rbTag--"+i.type},[e._v(e._s(i.label))]):e._e()})),0):e._e(),t.row.covid?s("p",[e._v("Date de l'intervention : "+e._s(e.formatDate(t.row.covid.date)))]):e._e(),s("p",{domProps:{innerHTML:e._s(t.row.content)}})])]}}],null,!1,240379794)})],1)]):e._e()],1)])},zb=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("div",{staticClass:"notification full-width"},[s("img",{staticClass:"spinner",attrs:{src:"/img/spinner_dark.svg",width:"20"}}),s("span",[e._v("Chargement des données en cours...")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("hgroup",[s("h3",[e._v("Covid-19")])])}];function Bb(e){return yo("/high-covid-comments",e)}var Rb={components:{NavBar:cr,Table:Sl,SlideNote:Mc},data(){const{user:e}=Ao();return{user:e,filter:"all",activities:[],allowedDepartements:[],highCovidComment:{pending:!1,error:null,data:{description:"",departements:[]}},error:null,state:null,covidTags:[{prop:"equipe_maraude",label:"Équipe de maraude",type:"warning"},{prop:"equipe_sanitaire",label:"Équipe sanitaire",type:"warning"},{prop:"equipe_accompagnement",label:"Équipe d'accompagnement",type:"warning"},{prop:"distribution_alimentaire",label:"Distribution d'aide alimentaire",type:"warning"},{prop:"personnes_orientees",label:"Personne(s) orientée(s) vers un centre d'hébergement spécialisé (desserrement)",type:"error"},{prop:"personnes_avec_symptomes",label:"Personne(s) avec des symptômes Covid-19",type:"error"},{prop:"besoin_action",label:"Besoin d'une action prioritaire",type:"error"}]}},computed:{columns(){return[{id:"date",label:"Date"},{id:"author",label:"Auteur"},{id:"activity",label:"Activités"}]},filteredActivities(){return"all"===this.filter?this.activities:this.activities.filter(e=>"regular"===this.filter?null!==e.covid:null!==e.highCovid)},parsedActivities(){return this.filteredActivities.map((e,t)=>({index:t,rawAction:e.action,rawDate:e.date,rawShantytown:e.shantytown,date:App.formatDate(e.date,"d/m/y"),time:App.formatDate(e.date,"h:i"),author:e.author,icon:"comment"===e.entity?"comment":"pencil-alt",shantytown:e.shantytown.id,address:`${e.shantytown.usename}, ${e.shantytown.city}`,action:"Commentaire sur le",content:e.content,comment:e.comment_id,covid:e.covid,highCovid:e.highCovid}))},canSubmitHighComment(){return"nation"!==this.user.organization.location.type&&"nation"!==Oo("covid_comment.list").geographic_level}},created(){this.load()},methods:{load(){if(-1===[null,"error"].indexOf(this.state))return;let e;switch(this.state="loading",this.error=null,this.user.organization.location.type){default:case"nation":e=Promise.resolve({departements:[]});break;case"region":e=tg(this.user.organization.location.region.code);break;case"epci":e=sg(this.user.organization.location.epci.code);break;case"departement":case"city":e=Promise.resolve({departements:[this.user.organization.location.departement]})}Promise.all([vb({covid:"1"}),e]).then(([e,{departements:t}])=>{this.activities=e,this.allowedDepartements=t,this.highCovidComment.data.departements=t.map(({code:e})=>e),this.state="loaded"}).catch(({user_message:e})=>{this.error=e,this.state="error"})},retryLoading(){this.load()},formatDate(...e){return window.App.formatDate.apply(window,e)},onRowClick(e){e.shantytown&&this.$router.push("/site/"+e.shantytown)},setFilter(e){this.filter=e},submitHighCovidComment(){this.highCovidComment.pending||(this.highCovidComment.pending=!0,this.highCovidComment.error=null,Bb(this.highCovidComment.data).then(()=>{this.highCovidComment.pending=!1,this.state=null,this.load()}).catch(({user_message:e,fields:t})=>{this.highCovidComment.pending=!1,this.highCovidComment.error={message:e,fields:t}}))}}},Vb=Rb,Ub=Vb,Hb=(s("a897"),Object(d["a"])(Ub,Nb,zb,!1,null,null,null)),Gb=Hb.exports,Wb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[s("Changelog",{attrs:{log:e.changelog,error:e.error},on:{done:e.markChangelogAsRead}})],1)])],1)},Yb=[],Jb=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"popin"},[s("div",{ref:"wrapper",staticClass:"popin-wrapper"},[s("div",[s("h1",{staticClass:"changelog-title"},[e._v("Des nouveautés sont disponibles sur la plateforme")]),s("h2",{staticClass:"changelog-date"},[e._v(e._s(e.log.date))]),s("section",{staticClass:"changelog-body"},[s("div",{staticClass:"carousel"},[s("div",{ref:"carousel",staticClass:"carousel-container"},e._l(e.log.items,(function(e){return s("img",{attrs:{src:e.image,alt:e.title}})})),0),s("div",{staticClass:"carousel-bullets"},e._l(e.log.items,(function(t,i){return s("span",{staticClass:"carousel-bullet",class:{"carousel-bullet--active":i===e.currentItemIndex}})})),0)]),s("div",{staticClass:"changelog-content"},[s("header",[s("p",{staticClass:"changelog-page"},[s("span",[e._v(e._s(e.currentItemIndex+1))]),e._v(" / "+e._s(e.log.items.length))]),s("h1",{staticClass:"changelog-itemTitle"},[e._v(e._s(e.currentItem.title))])]),s("div",{domProps:{innerHTML:e._s(e.currentItem.description)}})])]),s("footer",{staticClass:"changelog-footer"},[s("p",[s("span",{staticClass:"link",on:{click:e.previous}},[e._v(e._s(e.currentItemIndex>0?"Précédent":""))])]),s("p",[null!==e.dataError?s("span",{staticClass:"error"},[e._v(e._s(e.dataError))]):e._e(),s("br"),s("button",{staticClass:"button",on:{click:e.next}},[e._v(e._s(e.nextLabel))])])])])])])},Qb=[],Zb={props:{log:{type:Object,required:!0},error:{type:String,required:!1,default:null}},data(){return{dataError:this.error?this.error:null,currentItemIndex:0}},watch:{error(){this.dataError=this.error?this.error:null}},computed:{nextLabel(){return this.currentItemIndex===this.log.items.length-1?"Accéder à la plateforme":"Suite"},currentItem(){return this.log.items[this.currentItemIndex]}},methods:{previous(){this.dataError=null,0!==this.currentItemIndex&&(this.currentItemIndex-=1,this.syncCarousel())},next(){this.dataError=null,this.currentItemIndex!==this.log.items.length-1?(this.currentItemIndex+=1,this.syncCarousel()):this.$emit("done")},syncCarousel(){const e=this.$refs.carousel.firstChild;e.style.marginLeft=-1*e.offsetWidth*this.currentItemIndex+"px"}}},Kb=Zb,Xb=Kb,ey=(s("7f76"),Object(d["a"])(Xb,Jb,Qb,!1,null,"5435c2dc",null)),ty=ey.exports,sy={data(){const{changelog:e}=Ao();return{error:null,changelog:e}},components:{NavBar:cr,Changelog:ty},methods:{markChangelogAsRead(){Do(this.changelog.app_version).then(()=>{$o().then(()=>{this.$router.push("/")}).catch(({user_message:e})=>{this.error=e})}).catch(({user_message:e})=>{this.error=e})}}},iy=sy,ay=iy,ny=Object(d["a"])(ay,Wb,Yb,!1,null,null,null),oy=ny.exports,ry=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"v1"},[s("div",{staticClass:"page--withMargin"},[s("NavBar"),s("section",{staticClass:"section section-white"},[s("div",{staticClass:"container"},[e._m(0),s("p",[s("strong",[e._v("Avant d'accéder à la plateforme, merci de lire et de valider la "),s("a",{attrs:{href:e.charte.fichier}},[e._v("charte d'engagement")])]),e._v(". Le respect des règles de confidentialité des informations est primordial vis à vis des habitants et de l'action publique.")]),e._m(1),e._m(2),s("p",[e._v("Le non respect de ces règles peut entraîner des avertissements ou la suppression de votre accès à la plateforme numérique.")]),s("p",[s("label",{attrs:{for:"charte"}},[s("input",{directives:[{name:"model",rawName:"v-model",value:e.data,expression:"data"}],staticClass:"input input--checkbox",attrs:{type:"checkbox",id:"charte",value:"1",disabled:"pending"===e.form.status},domProps:{checked:Array.isArray(e.data)?e._i(e.data,"1")>-1:e.data},on:{change:function(t){var s=e.data,i=t.target,a=!!i.checked;if(Array.isArray(s)){var n="1",o=e._i(s,n);i.checked?o<0&&(e.data=s.concat([n])):o>-1&&(e.data=s.slice(0,o).concat(s.slice(o+1)))}else e.data=a}}}),e._v(" Je m’engage à respecter les règles et obligations de la "),s("a",{attrs:{href:e.charte.fichier}},[e._v("charte d’engagement")]),e._v(" auprès des services de l’État, dans le cadre de l’accès à la plateforme Résorption bidonvilles. ")])]),"error"===e.form.status?s("p",{staticClass:"error"},[s("span",{staticClass:"error"},[e._v("Une erreur est survenue :")]),s("br"),s("span",{staticClass:"error"},[e._v(e._s(e.form.error))])]):e._e(),s("p",[s("button",{staticClass:"button",attrs:{disabled:"pending"===e.form.status||!0!==e.data},on:{click:e.submit}},["pending"!==e.form.status?s("span",[e._v("Accéder à la plateforme")]):s("img",{attrs:{src:"/img/spinner_light.svg",width:"20"}})])])])])],1)])},ly=[function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("header",[s("h1",[e._v("Signature de la charte d'engagement")])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("strong",[e._v("Selon la charte d'engagement, l'utilisateur s'engage à :")]),s("ul",[s("li",[e._v("utiliser des paramètres de connexion (identifiants et mots de passe) personnels et confidentiels.")]),s("li",[e._v("exploiter les informations présentes sur la plateforme exclusivement à des fins professionnelles, pour les besoins propres et internes de son organisation.")])])])},function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("p",[s("strong",[e._v("Ainsi, l'utilisateur s'interdit de :")]),s("ul",[s("li",[e._v("transmettre les identifiants et mots de passe à un tiers.")]),s("li",[e._v("communiquer les informations présentes sur la plateforme sous aucune forme (orale, écrite, copie) à un tiers.")])])])}],cy={components:{NavBar:cr},data(){const{user:{id:e},version_charte_engagement:t}=Ao();return{user:e,charte:t,data:!1,form:{status:null,error:null}}},methods:{submit(){"pending"!==this.form.status&&(this.form.status="pending",this.form.error=null,ir(this.user,this.charte.version).then(()=>{Eo("user.charte_engagement_a_jour",!0),this.$router.push("/")}).catch(({user_message:e})=>{this.form.status="error",this.form.error=e}))}}},dy=cy,uy=dy,py=(s("e451"),Object(d["a"])(uy,ry,ly,!1,null,"62aa3c67",null)),my=py.exports;let hy=null;function vy(e,t,s,i){for(let a=0;a<e.length;a+=1){const{checker:n,target:o,saveEntryPoint:r}=e[a];if(!0!==n(t,s))return!1!==r&&(hy=t),void i(o)}i()}function fy(e){const{permissions:t}=e.meta;return!t||t.every(e=>Io(e))}function _y(){const{user:{position:e}}=Ao();return""!==e}function gy(){const{changelog:e}=Ao();return null===e}const by={anonymous:vy.bind(void 0,[{checker:()=>!Mo(),target:"/",saveEntryPoint:!1}]),loggedIn:vy.bind(void 0,[{checker:Mo,target:"/connexion"}]),loaded:vy.bind(void 0,[{checker:Mo,target:"/connexion"},{checker:So,target:"/launcher"},{checker:fy,target:"/",saveEntrypoint:!1}]),loadedAndUpgraded:vy.bind(void 0,[{checker:Mo,target:"/connexion"},{checker:So,target:"/launcher"},{checker:fy,target:"/",saveEntrypoint:!1},{checker:jo,target:"/signature-charte-engagement"},{checker:_y,target:"/mise-a-niveau"}]),loadedAndUpToDate:vy.bind(void 0,[{checker:Mo,target:"/connexion"},{checker:So,target:"/launcher"},{checker:fy,target:"/",saveEntrypoint:!1},{checker:jo,target:"/signature-charte-engagement"},{checker:_y,target:"/mise-a-niveau"},{checker:gy,target:"/nouvelle-version"}])};function yy(){return!0!==Mo()?No()?"/connexion":"/landing":!0!==So()?"/launcher":"/cartographie"}const Cy=new n["a"]({scrollBehavior:(e,t,s)=>e.hash?{selector:e.hash}:s||{x:0,y:0},routes:[{path:"/",redirect:yy,meta:{analyticsIgnore:!0}},{path:"/landing",component:oo,beforeEnter:by.anonymous},{path:"/statistiques-publiques",component:Mb,beforeEnter:by.anonymous},{path:"/connexion",component:Qc,beforeEnter:by.anonymous},{path:"/contact",component:Nd,beforeEnter:by.anonymous},{path:"/launcher",component:sp,beforeEnter:by.loggedIn},{path:"/nouvelle-version",component:oy,beforeEnter:by.loadedAndUpgraded},{path:"/deconnexion",beforeEnter:(e,t,s)=>{Fo(i["default"].prototype.$piwik),s("/")},meta:{analyticsIgnore:!0}},{meta:{group:"townList"},path:"/cartographie",component:Ju,beforeEnter:by.loadedAndUpToDate},{meta:{group:"townList"},path:"/liste-des-sites",component:bp,beforeEnter:by.loadedAndUpToDate},{meta:{group:"townList"},path:"/liste-des-sites-2",component:sh,beforeEnter:by.loadedAndUpToDate},{meta:{group:"townCreation",permissions:["shantytown.create"]},path:"/nouveau-site",component:ch,beforeEnter:by.loadedAndUpToDate},{meta:{group:"townList"},path:"/site/:id",component:kh,beforeEnter:by.loadedAndUpToDate},{meta:{group:"townList"},path:"/site-new/:id",component:gf,beforeEnter:by.loadedAndUpToDate},{path:"/feedback",beforeEnter(e,t,s){window.location.href="mailto:contact@resorption-bidonvilles.beta.gouv.fr",s(!1)}},{path:"/conditions-d-utilisation",beforeEnter(e,t,s){window.open("/doc/CGU_Resorption_Bidonvilles.pdf"),s(!1)}},{path:"/typologie-des-acces",beforeEnter(e,t,s){window.open("/doc/guide_de_l_administrateur.pdf"),s(!1)}},{path:"/charte-d-engagement",beforeEnter(e,t,s){const{version_charte_engagement:{fichier:i}}=Ao();window.open(i,"_blank"),s(!1)}},{path:"/mentions-legales",component:Vg},{meta:{group:"account"},path:"/mon-compte",component:Pf,beforeEnter:by.loadedAndUpToDate},{meta:{group:"users",permissions:["user.list"]},path:"/liste-des-utilisateurs",component:zf,beforeEnter:by.loadedAndUpToDate},{meta:{group:"userCreation",permissions:["user.create"]},path:"/nouvel-utilisateur",component:Jf,beforeEnter:by.loadedAndUpToDate},{path:"/signature-charte-engagement",component:my,beforeEnter:vy.bind(void 0,[{checker:Mo,target:"/connexion"},{checker:So,target:"/launcher"},{checker:fy,target:"/",saveEntrypoint:!1},{checker(){return!jo()},target:"/"}])},{meta:{group:"users",permissions:["user.activate"]},path:"/nouvel-utilisateur/:id",component:g_,beforeEnter:by.loadedAndUpToDate},{meta:{group:"users"},path:"/mise-a-niveau",component:P_,beforeEnter:by.loaded},{meta:{group:"users"},path:"/nouveau-mot-de-passe",component:I_,beforeEnter:by.anonymous},{meta:{group:"users"},path:"/renouveler-mot-de-passe/:token",component:N_,beforeEnter:by.anonymous},{meta:{group:"account"},path:"/activer-mon-compte/:token",component:s_,beforeEnter:by.anonymous},{meta:{group:"plans",permissions:["plan.list"]},path:"/liste-des-dispositifs",component:K_,beforeEnter:by.loadedAndUpToDate},{meta:{group:"plans",permissions:["plan.create"]},path:"/nouveau-dispositif",component:rg,beforeEnter:by.loadedAndUpToDate},{meta:{group:"plans",permissions:["plan.update"]},path:"/modifier-dispositif/:id",component:Cg,beforeEnter:by.loadedAndUpToDate},{meta:{group:"plans",permissions:["plan.read"]},path:"/dispositif/:id",component:hg,beforeEnter:by.loadedAndUpToDate},{meta:{group:"plans",permissions:["plan.updateMarks"]},path:"/dispositif/:id/indicateurs",component:Tg,beforeEnter:by.loadedAndUpToDate},{meta:{group:"admin",permissions:["stats.read"]},path:"/statistiques",component:Lg,beforeEnter:by.loadedAndUpToDate},{meta:{group:"admin",permissions:["shantytown_comment.moderate"]},path:"/historique-des-activites",component:yb,beforeEnter:by.loadedAndUpToDate},{meta:{group:"covid"},path:"/covid-19",component:Gb,beforeEnter:by.loadedAndUpToDate},{meta:{group:"directory"},path:"/annuaire/:id?",component:pb,beforeEnter:by.loadedAndUpToDate}]});function wy(){if(null===hy)return"/";const e=hy;return hy=null,e}const xy=["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"];window.App=Object.freeze({escapeHtml(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},dateDiff(e,t){const s=new Date(e),i=new Date(t);let a;if(a=12*(i.getFullYear()-s.getFullYear()),a-=s.getMonth()+1,a+=i.getMonth(),a=a<=0?0:a,0===a){const e=Math.abs(s.getTime()-i.getTime())/864e5;return`${e} jour${e>1?"s":""}`}if(a<12)return a+" mois";if(12===a)return"1 an";const n=Math.floor(a/12),o=a%12;let r=`${n} an${n>1?"s":""}`;return o>0&&(r+=` ${o} mois`),r},formatDate(e,t="d/m/y"){const s=new Date(1e3*e);return t.replace("d",("0"+s.getDate()).slice(-2)).replace("m",("0"+(s.getMonth()+1)).slice(-2)).replace("y",s.getFullYear()).replace("h",("0"+s.getHours()).slice(-2)).replace("i",("0"+s.getMinutes()).slice(-2)).replace("M",xy[s.getMonth()])}}),i["default"].component("font-awesome-icon",r["a"]),i["default"].use(o["a"]),i["default"].use(n["a"]),i["default"].use(a["a"]),i["default"].use(bi,{host:"https://stats.data.gouv.fr",siteId:86,trackerFileName:"piwik",router:Cy,enableLinkTracking:!0,requireConsent:!1,trackInitialView:!0,debug:!0}),vi(i["default"]);const ky=new a["a"]({locale:"fr",messages:D});i["default"].createElement=e=>new i["default"](e),i["default"].createElement({el:"#app",router:Cy,store:Zm,i18n:ky,render:e=>e(m)})},"7c9e":function(e,t,s){},"7d21":function(e,t,s){},"7f76":function(e,t,s){"use strict";var i=s("6d7c"),a=s.n(i);a.a},"7fa8":function(e,t,s){},8072:function(e,t,s){},8324:function(e,t,s){"use strict";var i=s("0514"),a=s.n(i);a.a},"83c6":function(e,t,s){"use strict";var i=s("42da"),a=s.n(i);a.a},8503:function(e,t,s){e.exports=s.p+"img/resorption-bidonvilles-2.8711730a.jpg"},"85ae":function(e,t,s){e.exports=s.p+"img/before.1c53f4ec.jpg"},"85f4":function(e,t,s){},8683:function(e,t,s){},8922:function(e,t,s){},8950:function(e,t,s){"use strict";var i=s("6382"),a=s.n(i);a.a},8973:function(e,t,s){e.exports=s.p+"img/resorption-bidonvilles-dessin.40bfb99e.png"},"8aa6":function(e,t,s){"use strict";var i=s("1a28"),a=s.n(i);a.a},"8b2f":function(e,t,s){e.exports=s.p+"img/resorption-bidonvilles-5.e5839f75.jpg"},"912c":function(e,t,s){},9355:function(e,t,s){},"93aa":function(e,t,s){"use strict";var i=s("a67f"),a=s.n(i);a.a},"983b":function(e){e.exports=JSON.parse('{"title":"Neighbour, citizen, shantytown dweller... Any news? A question ? An alert?","contactUs":"Contact us","email":"Your email","firstname":"First name","lastname":"Last name","requestType":"You want to...","help":"receive support","report":"report","requestHelp":"request help","requestInfo":"request info","requestAccess":"request access","isActor":"Are you involved in shantytown resorption","actorExample":"For example: a State service, an association operator, a local authority, etc.","yes":"Yes","no":"No","whichEstablishment":"Which establishment?","public":"State service, public institution or public organisation","territorialCollectivity":"Territorial collectivity","association":"Association","administration":"Central administration","message":"Your message","legal":"I give my consent to the processing of my personal data.","send":"Send","cancel":"Cancel","error":"Your request contains errors:","share":"Share this page"}')},9934:function(e,t,s){e.exports=s.p+"img/people.9be8d82e.svg"},9985:function(e,t,s){"use strict";var i=s("b3ad"),a=s.n(i);a.a},"9cc2":function(e,t,s){},"9cfe":function(e,t,s){},"9d64":function(e,t,s){e.exports=s.p+"img/RO.3c42c422.svg"},"9ddb":function(e){e.exports=JSON.parse('{"title":"Vecin, cetățean, rezident pe un platz... O informaţie? O întrebare? O alertă?","contactUs":"Contactaţi-ne","email":"E-mailul dumneavoastră","firstname":"Prenume","lastname":"Nume","requestType":"Doriţi","help":"Să ajutaţi","report":"Să semnalaţi","requestHelp":"Să cereţi ajutor","requestInfo":"Să cereţi informații","requestAccess":"Sa solicitați accesul la platformă","isActor":"Sunteţi actor în dizolvarea platzurilor ?","actorExample":"De exemplu: un serviciu de stat, un operator de asociaţie, o colectivitate locală..","yes":"Da","no":"Nu","whichEstablishment":"Care este structura dumneavostră ","public":"Serviciu de stat, instituție sau organism public","territorialCollectivity":"Colectivitate teritorială","association":"Asociaţie","administration":"Administraţie centrală","message":"Mesajul dumneavoastră","legal":"Certific faptul că aceste date cu caracter personal au fost introduse cu consimțământul meu.","send":"Trimite","cancel":"Anulează","error":"Solicitarea dvs. conține erori:","share":"Împărtășeste acestă pagină"}')},"9efc":function(e,t,s){},"9f1c":function(e,t,s){},a28d:function(e,t,s){},a39e:function(e,t,s){},a605:function(e,t,s){},a67f:function(e,t,s){},a863:function(e,t,s){},a897:function(e,t,s){"use strict";var i=s("63fe"),a=s.n(i);a.a},a8bd:function(e,t,s){"use strict";var i=s("de3a"),a=s.n(i);a.a},aac4:function(e,t,s){},aaf3:function(e,t,s){"use strict";var i=s("7d21"),a=s.n(i);a.a},ab52:function(e,t,s){e.exports=s.p+"img/before.79688d04.jpg"},ac65:function(e,t,s){e.exports=s.p+"img/BG.d7746f61.svg"},ad9e:function(e,t,s){"use strict";var i=s("9efc"),a=s.n(i);a.a},af0d:function(e,t,s){},af21:function(e){e.exports=JSON.parse('{"contact":"Contactez l\'équipe du projet","statistics":"Statistiques","legal":"Mention légales","userAccessGuide":"Guide des accès et de l\'administrateur","userAgreement":"Charte d\'engagement de l\'utilisateur"}')},af3d:function(e){e.exports=JSON.parse('{"header":{"connect":"Sign in","contact":"Contact us"},"hero":{"title":"Taking action for slum clearance","subtitle":"Ask a question or request an access"},"firstSection":{"features":{"position":"Useful information on slums at a glance","actions":"The projects carried out available at any time","exchange":"Facilitating dialogue between parties involved"},"before":"Before","after":"After","context":{"title":"Résorption-bidonvilles,","subtitle":"A platform to boost the resorption of shantytowns","text":"A tool for information, sharing and steering, the platform offers a high-performance and effective solution for slum clearance. It enables the collaboration of all local stakeholders involved in the slum clearance policy."},"feedback":{"1":{"text":"It\'s great because you have the info online, you\'re not faced with an excel spreadsheet with codes you don\'t understand.","author":"Prefecture Seine-Saint-Denis"},"2":{"text":"The platform made the information more reliable because, before the Excel table was not shared. The more collaborative tools we have, the better it is.","author":"City of Poitiers"},"3":{"text":"I was able to direct the family of a person I was accompanying to a solidarity house from the location of their slum.","author":"Haute-Garonne Association"}}},"firstBanner":{"text":"Involved Stakeholders in slum clearance, please share and highlight your projects","cta":"Request access"},"secondSection":{"title":"Reaching slum clearance,","subtitle":"a national objective","data":{"1":{"line1":"More than","line2":"300 slums","line3":"in mainland France"},"2":{"line1":"More than","line2":"16 000 people","line3":"including 5,000 minors"},"3":{"line1":"Mostly","line2":"Europeans","line3":"Romanian and Bulgarian citizens"}},"firstParagraph":"A slum is an area that usually lacks basic services (water, electricity, waste management) and is illegally occupied by several families.","secondParagraph":{"bold":"The government sets a clear objective of shanty town resorption by moving away from an evacuation-centred approach to a global approach.","normal":"combining social inclusion, respect for public order and prevention of resettlement. In all the territories concerned, effective, humane and pragmatic multi-partner actions must be implemented.","link":"More about the shantytown resorption policy"},"video":{"text":"Understanding shantytown clearance in 2 minutes"}},"secondBanner":{"text":"Neighbour, citizen, shantytown dweller... Any news? A question ? An alert?","cta":"Contact us"},"thirdSection":{"title":"Actions in figures","firstParagraph":{"bold":"In 2019, more than 30 slum clearance projects have been carried out by 35 NGOs","normal":"They have been financed 75% by the State, 15% by local authorities and 10% by private or European funds. Families living in slums have been supported in order to access to health, housing, employment, education and sanitation."},"bilan":{"1":{"text":"8,600 beneficiaries of the actions"},"3":{"text":"1,000 people re-housed"},"4":{"text":"1,350 children in school"},"5":{"text":"2,040 beneficiaries","info":"of health support"},"6":{"text":"615 employment contracts signed"}},"cta":"Download the latest report","secondParagraph":{"title":"A project led by the interministerial delegation for access to housing (DIHAL)","body":{"text1":"The digital platform Résorption-bidonvilles, launched in 2018 by the","link1":"DIHAL","text2":"plays a role in transforming public action","text3":"The platform continues to be developed in close collaboration with its users.","text4":"To learn more about the beginning of the project, please visit ","link2":"the official website about Start-up d\'Etat"},"items":{"1":{"link":"General interest entrepreneur","text":"of the Future Investment Program in 2019"},"2":{"link":"European Commission\'s \\"rights, citizenship and equality\\" program","text":"in 2020"},"3":{"link":"State Start-up Acceleration Fund 3","text":"of DINUM in April 2020"},"4":{"link":"French policy transformation fund","text":"of DITP in October 2020"},"title":"The project was the winner of several calls for proposals:"}}},"contactForm":{"email":"Your email","cta":"Contact us"}}')},afa5:function(e,t,s){},b371:function(e,t,s){},b3ad:function(e,t,s){},b64b:function(e,t,s){},b750:function(e,t,s){e.exports=s.p+"img/before.dd41639d.jpg"},b7bb:function(e,t,s){},b82e:function(e,t,s){"use strict";var i=s("e67e"),a=s.n(i);a.a},b9d6:function(e,t,s){},bafd:function(e,t,s){},bb00:function(e,t,s){e.exports=s.p+"img/after.c33a3716.jpg"},bb25:function(e,t,s){"use strict";var i=s("b7bb"),a=s.n(i);a.a},bd68:function(e,t,s){},bdf1:function(e,t,s){"use strict";var i=s("74c2"),a=s.n(i);a.a},be9a:function(e,t,s){},c1ab:function(e,t,s){"use strict";var i=s("49bc"),a=s.n(i);a.a},c368:function(e,t,s){},c789:function(e,t,s){"use strict";var i=s("7b35"),a=s.n(i);a.a},c8c7:function(e,t,s){e.exports=s.p+"img/after.4e3125cf.jpg"},cb23:function(e,t,s){"use strict";var i=s("f925"),a=s.n(i);a.a},cbe6:function(e,t,s){e.exports=s.p+"img/after.e9992ef7.jpg"},ccab:function(e,t,s){e.exports=s.p+"img/police_siren.ffa34c81.svg"},ccb6:function(e,t,s){"use strict";var i=s("ec39"),a=s.n(i);a.a},cda2:function(e){e.exports=JSON.parse('{"header":{"connect":"Вход","contact":"Свържете се с нас"},"hero":{"title":"Действия за закриване на бидонвили","subtitle":"Задайте въпрос или поискайте достъп"},"firstSection":{"features":{"position":"Полезна информация за обектите само с един поглед","actions":"Достъп по всяко време до най-важните дейности","exchange":"Улеснена връзка между участниците"},"context":{"title":"Закриване на бидонвили","subtitle":"Платформа за ускоряване на закриването на бидонвилите","text":"Инструмент за информация, споделяне и управление, платформата предлага работещо и ефикасно решение за закриване на бидонвили. Тя спомага за създаванетона на истинска динамика на сътрудничество между ангажираните участници по места за изпълнение на поставената цел."},"before":"Преди","after":"След ","feedback":{"1":{"text":"Отлично е, защото имате онлайн достъп до информацията, не сте пред екселска таблица с формули, които не разбирате.","author":"Префектура на департамента Сен-Сан-Дени"},"2":{"text":"Платформата предоставя достоверна информация, а екселската таблицата не беше колаборативна. Колкото повече инструменти за съвместна работа, толкова по-добре.","author":"Град Поатие"},"3":{"text":"Успях да насоча семейството на човек, на когото помагам, към социален център според местонаходжението на техния бидонвил","author":"Сдружение от департамента От-Гарон"}}},"firstBanner":{"text":"Дейци в политиката за закриването на бидонвилите, споделете и разпространете информация за вашата дейност","cta":"Искам достъп"},"secondSection":{"title":"Пълното закриване на бидонвилите","subtitle":"национална цел","data":{"1":{"line1":"Над","line2":"300 бидонвила","line3":"в континентална Франция"},"2":{"line1":"Над","line2":"16 000 души","line3":"от които 5 000 непълнолетни"},"3":{"line1":"Предимно","line2":"български и румънски ","line3":"граждани"}},"firstParagraph":"Бидонвилът е изоставен промишлен терен или постройка, обикновено без комунални услуги (вода, ток, събиране на отпадъци), в който са се настанили незаконно няколко семейства.","secondParagraph":{"bold":"През 2018 правителството определи ясна цел за преодоляване на бидонвилите като премине от подхода, сведен nдо евакуация на жителите, към глобален подход,","normal":"съчетаващ социалната интеграция, спазването на обществения ред и предотвратяване на нови бидонвили. Във всички засегнати теротирии трябва да бъдат въведени ефикасни, хуманни и прагматични действия с много партньори.","link":"Научете повече за политиката на закриване на бидонвилите"},"video":{"text":"Разберете закриването на бидонвилите в 2 минути"}},"secondBanner":{"text":"Съсед, гражданин, обитател на бидонвил...Информация? Въпрос? Сигнал?","cta":"Свържете се с нас"},"thirdSection":{"title":"Дейностите в цифри","firstParagraph":{"bold":"Над 30 дейности са извършени през 2019 година от над 35 оператори.","normal":"Те са финансирани 75% от държавата, 15% от местните власти и 10% от частни или европейски източници. Професионални екипи помагат на семействата в бидонвилите, незаконно обитаваните сгради или жилищата във всяко отношение: здраве, жилище, работа, образование, стабилизиране и обезопасяване на обекта."},"bilan":{"1":{"text":"8 600 бенефициенти от проектни дейности"},"3":{"text":"1 000 души с нов дом "},"4":{"text":"1 350 деца, посещаващи училище"},"5":{"text":"2 040 бенефициенти","info":"на здравна подкрепа"},"6":{"text":"615 сключени трудови договори"}},"cta":"Свалете последния доклад","secondParagraph":{"title":"Един проект на Междуведмствената делегация за настаняване и достъп до жилище","body":{"text1":"Цифровата платформа Закриване-бидонвили, стартирана през 2018 година от","link1":"МДНДЖ","text2":"е част от целта за трансформация на дейността на публичната администрация","text3":"Развитието на платформата продължава в тясно сътрудничество с нейните потребители.","text4":"Искате да научите повече за генезиса на проекта? Отидете на съответната страница на","link2":"официалния уебсайт на държавните стартъпи"},"items":{"1":{"link":"Предприемач в обществен интерес на Програмата за инвестиране ","text":"в бъдещето през 2019 година"},"2":{"link":"Програмата „Права, гражданство и равенство“ на Европейската комисия","text":"през първия триместър на 2020 година"},"3":{"link":"Фонд за ускоряване на държавни стартъпи 3","text":"на Междуведомствената дирекция за цифровизация през април 2020 година"},"4":{"link":"Френски фонд за трансформация на политики","text":"от DITP през октомври 2020"},"title":"Проектът е победител в множество отворени покани за проекти:"}}},"contactForm":{"email":"Вашият имейл","cta":"Свържете се с нас"}}')},cee3:function(e,t,s){"use strict";var i=s("47b0"),a=s.n(i);a.a},cfd5:function(e,t,s){e.exports=s.p+"img/map-ro.2a33bfb7.jpg"},d416:function(e,t,s){"use strict";var i=s("0fea"),a=s.n(i);a.a},d507:function(e,t,s){},d67e:function(e,t,s){e.exports=s.p+"img/map-fr.28fc1fb5.jpg"},d694:function(e,t,s){"use strict";var i=s("a863"),a=s.n(i);a.a},d89d:function(e,t,s){e.exports=s.p+"img/pin.ee8bc509.svg"},da0f:function(e,t,s){e.exports=s.p+"img/resorption-bidonvilles-3.1ab7f8ed.jpg"},dce0:function(e,t,s){e.exports=s.p+"img/resorption-bidonvilles-1.f2473868.jpg"},dd94:function(e,t,s){e.exports=s.p+"img/before.6c78217d.jpg"},dd98:function(e,t,s){},de3a:function(e,t,s){},e010:function(e,t,s){},e072:function(e,t,s){"use strict";var i=s("e93e"),a=s.n(i);a.a},e119:function(e,t,s){"use strict";var i=s("dd98"),a=s.n(i);a.a},e17b:function(e,t,s){},e1d3:function(e,t,s){"use strict";var i=s("27a3"),a=s.n(i);a.a},e438:function(e,t,s){"use strict";var i=s("01b4"),a=s.n(i);a.a},e451:function(e,t,s){"use strict";var i=s("b9d6"),a=s.n(i);a.a},e517:function(e,t,s){"use strict";var i=s("afa5"),a=s.n(i);a.a},e61f:function(e,t,s){e.exports=s.p+"img/logo-commission-europenne.69cc0d29.png"},e67e:function(e,t,s){},e744:function(e,t,s){"use strict";var i=s("af0d"),a=s.n(i);a.a},e93e:function(e,t,s){},e9cc:function(e,t,s){},ec39:function(e,t,s){},edfe:function(e,t,s){"use strict";var i=s("e010"),a=s.n(i);a.a},efa2:function(e,t,s){"use strict";var i=s("8683"),a=s.n(i);a.a},f090:function(e,t,s){"use strict";var i=s("b371"),a=s.n(i);a.a},f12c:function(e,t,s){"use strict";var i=s("a28d"),a=s.n(i);a.a},f276:function(e,t,s){"use strict";var i=s("d507"),a=s.n(i);a.a},f6ce:function(e,t,s){"use strict";var i=s("a39e"),a=s.n(i);a.a},f909:function(e,t,s){"use strict";var i=s("2b2e"),a=s.n(i);a.a},f925:function(e,t,s){},fd3d:function(e){e.exports=JSON.parse('{"header":{"connect":"Pentru a vă conecta","contact":"Contactați-ne"},"hero":{"title":"Acționăm pentru resorbția de bidonville","subtitle":"Puneți o întrebare sau solicitați accesul"},"firstSection":{"features":{"position":"Găsiți informații utile foarterapid pe site","actions":"Esențialul acțiunilor disponibil în orice moment","exchange":"Schimb de informatie rapidă intre participanţi"},"context":{"title":"Resorbția de bidonville,","subtitle":"O platformă pentru a accelera resorbția de bidonville","text":"Un instrument de informare, partajare și ghidare , platforma oferă o soluție puternică și eficientă pentru resorbția de bidonville. Acesta permite crearea unei dinamici reale de colaborare, într-un teritoriu si între actorii dedicați obiectivului de resorbția de bidonville."},"before":"Înainte","after":"După","feedback":{"1":{"text":"Este foarte bine pentru că aveți informațiile online, nu vă confruntați cu un tabel Excel cu coduri pe care nu le înțelegeți.","author":"Prefectura Seine-Saint-Denis"},"2":{"text":"Platforma a făcut informațiile mai accesibile, deoarece tabelul Excelnu era partajat. Cu cât avem mai multeinstrumente de colaborare, cu atât mai bine.","author":"Orașul Poitiers"},"3":{"text":"Am fost în măsură să direcționez familia unei persoane pe care o acomapaniez la o casă de solidaritate de la locația lor situata într-un bidonville.","author":"Asociația din Haute-Garonne"}}},"firstBanner":{"text":"Actori ai resorbției de bidonville, partajați și faceţi cunoscute acțiunile voastre","cta":"Solicitaţi accesul"},"secondSection":{"title":"Dizolvarea platzurilor,","subtitle":"un obiectiv național","data":{"1":{"line1":"Peste","line2":"300 de platzur","line3":"în Franța metropolitană"},"2":{"line1":"Peste","line2":"16 000 de persoane","line3":"inclusiv 5.000 de minori"},"3":{"line1":"Majoritatea","line2":"europeni","line3":"români și bulgari"}},"firstParagraph":"Un bidonville este un teren, un maidan sau o clădire construită care în general e lipsită de servicii de bază (apă, electricitate, gestionarea deșeurilor) și ocupată ilegal de mai multe familii. Un bidonville mai est denumit si „plaț” în limbaj familiar.","secondParagraph":{"bold":"In 2018, Guvernul și-a stabilit un obiectiv clar pentru resorbția de bidonville, depășind abordarea centrată pe evacuare, într-o abordare cuprinzătoare care combină integrarea socială, respectarea ordinii publice și prevenirea reinstralarii.","normal":"În toateteritoriile în cauză, trebuie instituite acțiuni eficiente, umane și pragmatice multi-parteneriale.","link":"Aflați mai multe despre politica de resorbției de bidonville"},"video":{"text":"Înțelegerea resorbției de bidonville în 2 minute"}},"secondBanner":{"text":"Vecin, cetățean, rezident într-un bidonville... O informaţie? O întrebare? O alertă?","cta":"Contactaţi-ne"},"thirdSection":{"title":"Acţiunile desfăşurate in cifre","firstParagraph":{"bold":"Peste 30 de acțiuni desfășurate în 2019 de catre 35 de operatori.","normal":"Acestea sunt 75% finanțate de stat, 15% de autoritățile locale și 10% din fonduri private sau europene. Echipe de profesioniști însoțesc familiile în bidonville, cladirile dezafectate sau în locuință cuprinzând toate aspectele: sănătate, locuința, ocuparea forței de muncă, educație, stabilizare și securitatea locului."},"bilan":{"1":{"text":"8 600 de beneficiari ai acestor actiuni"},"3":{"text":"1 000 de persoane relocate"},"4":{"text":"1 350 elevi"},"5":{"text":"2 040 de beneficiari","info":"de sprijin medical"},"6":{"text":"615 contracte de muncă semnate"}},"cta":"Încarcaţi ultimul bilanţ","secondParagraph":{"title":"Un proiect realizat de Delegația Interministerială privind cazarea și accesul la locuințe","body":{"text1":"Platforma digitală „resorbția de bidonville”, lansată în 2018 de","link1":"Dihal","text2":"face parte dintr-un obiectiv de transformare a acțiunii publice.","text3":"Evoluțiile platformei continuă în strânsă colaborare cu utilizatorii săi.","text4":"Doriți să aflați mai multe despre crearea proiectului? Accesați fişa proiectulu","link2":"pe site-ul oficial:  Start-Up de stat"},"items":{"1":{"link":"Antreprenor de interes general","text":"al Programului de investiții de viitor in2019"},"2":{"link":"rogramul Comisiei Europene \\"drepturi, cetățenie și egalitate\\"","text":"în primul trimestru al anului 2020"},"3":{"link":"Fonduri de Accelerare pentru Start-up de stat 3","text":"de la DINUM în aprilie 2020"},"4":{"link":"Fondul de transformare a politicii franceze","text":"de la DITP în octombrie 2020"},"title":"Proiectul a fost câștigătorul mai multor cereri de proiecte :"}}},"contactForm":{"email":"E-mailul dumneavoastră","cta":"Contactaţi-ne"}}')},fd66:function(e,t,s){"use strict";var i=s("60ec"),a=s.n(i);a.a},ff59:function(e,t,s){}});
//# sourceMappingURL=index.e90fa00d.js.map